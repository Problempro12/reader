!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="d5a6e476-5560-4615-aa26-3038915f0b5f",e._sentryDebugIdIdentifier="sentry-dbid-d5a6e476-5560-4615-aa26-3038915f0b5f")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4270,3557],{54353:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/me/[[...slug]]",function(){return n(47057)}])},95568:function(e,t,n){"use strict";n.d(t,{a:function(){return h}});var i=n(31549),o=n(44194),a=n(51865),s=n.n(a),r=n(61794),l=n(39319),_=n(98877),c=n(76996),d=n(26249),u=n(59838);let m=n(25868).uc.feature("DeviceConfirmError");var p=n(23704),f=n.n(p);let h=e=>{var t;let{title:n,description:a,className:s,onConnectClick:p=u.ZT,onConnectSuccess:h=u.ZT}=e,v=(0,_.useIsUserAuthenticated)(),g=(0,d.useRouter)(),j=(0,r.TL)(),[N,{isLoading:y,reset:k,error:E}]=r.Hr.useDeviceConfirmMutation(),S=null===(t=g.query)||void 0===t?void 0:t.code,{control:P,handleSubmit:w}=(0,c.cI)({defaultValues:{code:S||""}}),T=(0,o.useMemo)(()=>{var e;return E&&(null==E?void 0:null===(e=E.data)||void 0===e?void 0:e.status)!==403},[E]),C=()=>{let{query:e}=g,t={...e};delete t.code,g.replace({pathname:g.pathname,query:t},void 0,{shallow:!0})};return(0,o.useEffect)(()=>{if(S){N({user_code:S}).unwrap().then(()=>{h()}).catch(e=>{var t,n;if((null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.status)===403){j(r.hi.global.header.auth.setAuthPopupVisibility(!0));return}(null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.status)!==401&&m("BackendInteractionError","Device confirm error",{originalError:e}).emit()});return}return()=>{k()}},[S]),(0,i.jsxs)("form",{className:s,onSubmit:e=>{if(null==e||e.preventDefault(),k(),C(),p(),!v){j(r.hi.global.header.auth.setAuthPopupVisibility(!0));return}w(e=>{let{code:t}=e;N({user_code:t}).unwrap().then(()=>{h()}).catch(e=>{var t,n;(null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.status)!==401&&(null==e?void 0:null===(n=e.data)||void 0===n?void 0:n.status)!==403&&m("BackendInteractionError","Device confirm error",{originalError:e}).emit()})})()},children:[(0,i.jsx)(x,{children:n}),a&&(0,i.jsx)(b,{children:a}),(0,i.jsxs)(b,{children:[(0,i.jsx)("input",{type:"text",name:"code",className:f().hidden,tabIndex:-1}),(0,i.jsx)(_.ControlledInput,{name:"code",control:P,rules:{required:"Поле не может быть пустым",minLength:{value:-1,message:""}},errorMessage:T?"Неверный код":null,placeholder:"Код",autoFocus:!0,onChangeValue:()=>{k()}})]}),(0,i.jsx)(b,{children:(0,i.jsx)(l.z,{loading:y,mode:"secondary",size:"medium",fullWidth:!0,disabled:y,text:"Подключить",type:"submit"})})]})};function b(e){let{children:t,className:n}=e;return(0,i.jsx)("div",{className:s()(f().field,n),children:t})}function x(e){let{children:t}=e;return(0,i.jsx)("h2",{className:f().header,children:t})}},84764:function(e,t,n){"use strict";n.d(t,{N:function(){return b}});var i=n(31549),o=n(44194),a=n(51865),s=n.n(a),r=n(76996),l=n(48592),_=n(1653),c=n(39319),d=n(59978),u=n(61794),m=n(9524),p=n(59838),f=n(37055),h=n.n(f);let b=e=>{let{isSuccess:t,isLoading:n,backendErrorMessage:a,onSubmit:f,inputPlaceholder:b,buttonClassName:x,formClassName:v,alertClassName:g,redirectUrl:j,isButtonEnabledOnlyDirtyForm:N,onPromocodeActivated:y}=e,{t:k}=(0,l.$G)(),E=(0,o.useRef)(null),S=(0,u.TL)(),P=(0,u.CG)(e=>!!e.foundationUser.id),[w,T]=(0,o.useState)(""),{formState:C,control:I,handleSubmit:A,reset:R,clearErrors:O,setError:D}=(0,r.cI)({defaultValues:{promocode:w}}),L=(0,r.qo)({control:I,name:"promocode"}),B=()=>{null==y||y(L),j&&window.location.replace(j)};(0,o.useEffect)(()=>{if(P){a&&!j?D("promocode",{message:a}):O();return}C.isSubmitSuccessful&&L&&a&&((0,p.fe)({promocode:L.trim()}),S(u.hi.global.interfaceRequests.setLoginPopupError({isOpen:!0,urlParams:{},onHide:R})))},[a,P,j]),(0,o.useEffect)(()=>{t&&!a&&B()},[t,a]),(0,o.useEffect)(()=>{!L&&E.current&&(E.current.clearValue(),O())},[L]),(0,o.useEffect)(()=>{let e=(0,p.Kk)("promocode");if(null!==e){var t;T(e),null===(t=E.current)||void 0===t||t.setValue(e),f({promocode:e}),(0,p.gk)("promocode")}},[]);let G=k(a);return(0,i.jsxs)("form",{onSubmit:A(f),className:s()(h().form,v),children:[!n&&C.isValid&&C.isSubmitSuccessful&&!a&&(0,i.jsx)("div",{className:g,children:(0,i.jsx)(d.b,{mode:d.p.safe,children:k("Промокод активирован")})}),(0,i.jsx)("div",{className:h().form__control,children:(0,i.jsx)(r.Qr,{name:"promocode",control:I,rules:{required:k("Поле не может быть пустым")},render:e=>{var t;let{field:n,formState:o}=e;return(0,i.jsx)(_.F5,{...n,controlMode:_.S1.text,placeholder:b||k("Промокод"),error:null===(t=o.errors.promocode)||void 0===t?void 0:t.message,fullWidth:!0,ref:E})}})}),(0,i.jsx)("div",{className:h().form__sumbit,children:(0,i.jsx)(c.z,{type:"submit",mode:"primary",size:"medium",text:k("Активировать"),fullWidth:!0,loading:n,className:x,disabled:N&&!C.isDirty})}),(0,i.jsx)(m.u_,{isOpen:!!(j&&a),onClose:B,title:k("Сообщение"),primaryButton:{label:k("ОК"),onClick:B},children:(0,i.jsx)("p",{children:G})})]})}},91366:function(e,t,n){"use strict";n.d(t,{z:function(){return l}});var i=n(44194),o=n(62094),a=n(61794),s=n(1590),r=n(78265);let l=()=>{let[e,t]=(0,i.useState)(""),[n,l]=(0,o.Dz)(r.D,null),[_,c]=(0,i.useState)(!1),[d,u]=(0,i.useState)(!0),[m,p]=(0,i.useState)(!1),[f,h]=(0,i.useState)(),b=(0,a.CG)(e=>e.foundationUser.id),x=()=>{u(!1),c(!0),t(""),p(!1),h(void 0)},v=async e=>{x();let n=new a.cf.CSRF({url:"/pages/ajax_empty2/",provider:{id:"activate_coupone"},request:{method:"POST",data:{action:"activate_coupone",gu_ajax:!0,descr:18,code1:e.promocode}}});try{var i;let{error:o,response:a}=await n.fetch();o&&t(o.statusText||(0,s.L)("unknown")),(null==a?void 0:a.error_msg)&&t(a.error_msg),(null==a?void 0:null===(i=a.redirect)||void 0===i?void 0:i.location)&&h(a.redirect.location),(null==a?void 0:a.status)==="ok"&&(l({path:window.location.pathname,promocode:e.promocode,userId:b,isActivated:!0,isFixedPromocode:!1,isPromocodeWithRedirectUrl:!1},{expires:0}),p(!0))}catch(e){t((0,s.L)("unknown"))}c(!1)};return[{activatedPromocode:(0,i.useMemo)(()=>n&&n.path===window.location.pathname?n.promocode:null,[n]),backendErrorMessage:e,isLoading:_,isSuccess:m,isUninitialized:d,redirectUrl:f},{redeemPromocode:v,resetRedeemPromocode:x,setBackendErrorMessage:t,setActivatedPromocode:l}]}},16896:function(e,t,n){"use strict";n.d(t,{Fj:function(){return s},RX:function(){return r},SL:function(){return _},n8:function(){return d},rp:function(){return c},w:function(){return l}});var i=n(44731),o=n(59838),a=n(1774);let s=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{if(n){i.TM.sendEventSync({eventType:e,params:{...t,source_internal:o.Ym&&window.location.href||"unknown source"}});return}i.TM.sendEvent(["LITRES_TRACKER"],{eventType:e,params:{...t,source_internal:o.Ym&&window.location.href||"unknown source"}})}catch(e){console.error("Error sending analytics from state machine",e)}},r=e=>{let{scenario:t,type:n,authMethodStatus:i}=e;s("edit_auth_info_click",{scenario:t,type:n,...i?{auth_method_status:i}:{}})},l=e=>{let{name:t,type:n,scenario:i,authMethodStatus:o}=e;s("authorization_view",{type:n,name:t,auth_method_status:null!=o?o:"unverified",...i?{scenario:i}:{}})},_=e=>{let{type:t,scenario:n,authMethodStatus:i,value:o,isVerified:r}=e;s("didnt_receive_code_click",{type:t,auth_method_status:null!=i?i:(0,a.S)(o,r),scenario:null!=n?n:(0,a.T)(o,r)})},c=e=>{let{type:t,scenario:n,authMethodStatus:i,value:o,isVerified:r}=e;s("email_to_support_click",{type:t,auth_method_status:null!=i?i:(0,a.S)(o,r),scenario:null!=n?n:(0,a.T)(o,r)})},d=e=>{let{type:t,scenario:n,authMethodStatus:i,value:o,isVerified:r,name:l,error:_}=e;s(l,{type:t,auth_method_status:null!=i?i:(0,a.S)(o,r),scenario:null!=n?n:(0,a.T)(o,r),..._?{error:_}:{}})}},1774:function(e,t,n){"use strict";n.d(t,{S:function(){return o},T:function(){return i}});let i=(e,t)=>e?t?"edit":"verify":"add",o=(e,t)=>e?t?"verified":"unverified":"empty"},39469:function(e,t,n){"use strict";n.d(t,{J:function(){return l},n:function(){return r}});var i=n(31549),o=n(44194),a=n(34270);let s=(0,o.createContext)({addNotification:e=>{}}),r=()=>(0,o.useContext)(s),l=e=>{let{children:t}=e,[n,r]=(0,o.useState)(null),l=(0,o.useCallback)(e=>{r(e)},[r]),_=(0,o.useCallback)(()=>{r(null)},[r]),c=(0,o.useMemo)(()=>({addNotification:l}),[l]);return(0,i.jsxs)(s.Provider,{value:c,children:[t,n&&(0,i.jsx)(a.P,{message:n,title:"",mode:"info",horizontalAlign:"right",verticalAlign:"top",isOpen:!0,onClose:_})]})}},99786:function(e,t,n){"use strict";n.d(t,{u:function(){return o}});var i=n(43467);let o=e=>(0,i.C)(e)},8801:function(e,t,n){"use strict";n.d(t,{l:function(){return s}});var i=n(99786),o=n(65865);let a={id:"emailModifying",initial:"changingEmail",context:{newEmail:"",mfaAddress:"",otpId:"",otpCode:"",mfaOtpId:"",mfaOtpCode:"",marketingConsentState:!1,isRateLimitExceeded:!1},states:{changingEmail:{on:{TRANSITION_TO_ENTERING_OTP_SENT_TO_EMAIL_HAPPENED:{target:"enteringOTPSentToConfirmedEmail",actions:[(0,o.f0)({otpId:(e,t)=>t.data.otp_id||e.otpId,isRateLimitExceeded:!1})]},MARKETING_CONSENT_STATUS_CHANGED:{actions:(0,o.f0)({marketingConsentState:(e,t)=>!!t.data.marketingConsentState})},NEW_EMAIL_VALUE_CHANGED:{actions:(0,o.f0)({newEmail:(e,t)=>t.data.newEmail||e.newEmail})},OTP_RATE_LIMIT_EXCEEDED:{actions:(0,o.f0)({isRateLimitExceeded:!0})}}},enteringOTPSentToConfirmedEmail:{on:{OTP_RATE_LIMIT_EXCEEDED:{actions:(0,o.f0)({isRateLimitExceeded:!0})},BACK:"changingEmail",OTP_CODE_VALUE_CHANGED:{actions:(0,o.f0)({otpCode:(e,t)=>t.data.otp_code||e.otpCode})},MFA_OTP_CODE_WAS_SENT:{target:"enteringMFAOTPSentToOldEmail",actions:(0,o.f0)({mfaOtpId:(e,t)=>t.data.otp_id||e.mfaOtpId,mfaAddress:(e,t)=>(null==t?void 0:t.data.address)||e.mfaAddress,mfaType:(e,t)=>null==t?void 0:t.data.type})},TRANSITION_TO_ENTERING_OTP_SENT_TO_EMAIL_HAPPENED:{target:"enteringOTPSentToConfirmedEmail",actions:(0,o.f0)({otpId:(e,t)=>t.data.otp_id||e.otpId})}}},enteringMFAOTPSentToOldEmail:{on:{OTP_CODE_VALUE_CHANGED:{actions:(0,o.f0)({mfaOtpCode:(e,t)=>t.data.otp_code||e.mfaOtpCode})},MFA_OTP_CODE_WAS_SENT:{target:"enteringMFAOTPSentToOldEmail",actions:(0,o.f0)({mfaOtpId:(e,t)=>t.data.otp_id||e.mfaOtpId,mfaAddress:(e,t)=>(null==t?void 0:t.data.address)||e.mfaAddress})}}}},on:{RESET:{target:".changingEmail",actions:(0,o.f0)({newEmail:"",otpId:"",otpCode:"",mfaAddress:"",mfaOtpCode:"",mfaOtpId:""})}}},s=(0,i.u)(a)},38700:function(e,t,n){"use strict";n.d(t,{v:function(){return s}});var i=n(99786),o=n(65865);let a={id:"emailModifying",initial:"enteringOTPSentToCurrentEmail",context:{otp_id:"",otp_code:"",marketingConsentState:!1,isRateLimitExceeded:!1},states:{enteringOTPSentToCurrentEmail:{on:{OTP_CODE_VALUE_CHANGED:{actions:(0,o.f0)({otp_code:(e,t)=>t.data.otp_code||e.otp_code})},OTP_ID_VALUE_CHANGED:{actions:(0,o.f0)({otp_id:(e,t)=>t.data.otp_id||e.otp_id,isRateLimitExceeded:!1})},OTP_RATE_LIMIT_EXCEEDED:{actions:(0,o.f0)({isRateLimitExceeded:!0})},MARKETING_CONSENT_STATUS_CHANGED:{actions:(0,o.f0)({marketingConsentState:(e,t)=>!!t.data.marketingConsentState})}}}},on:{RESET:{target:".enteringOTPSentToCurrentEmail",actions:(0,o.f0)({otp_id:"",otp_code:""})}}},s=(0,i.u)(a)},41418:function(e,t,n){"use strict";n.d(t,{Q:function(){return s}});var i=n(99786),o=n(65865);let a={id:"passwordEditing",initial:"idle",context:{email:"",newEmail:"",password:"",passwordRepeat:"",otp_id:"",otp_code:"",marketingConsentState:!1,isRateLimitExceeded:!1},states:{idle:{on:{TRANSITION_TO_ENTERING_CURRENT_PASSWORD_HAPPENED:{target:"enteringCurrentPassword",actions:["sendAnalytics"]},TRANSITION_TO_SELECTING_CONFIRMATION_METHOD_HAPPENED:{target:"selectingConfirmationMethod",actions:["sendAnalytics"]}}},enteringCurrentPassword:{on:{BACK:{target:"selectingConfirmationMethod",actions:(0,o.f0)({password:""})},TRANSITION_TO_ENTERING_NEW_PASSWORD_HAPPENED:{target:"enteringNewPassword",actions:(0,o.f0)({password:""})},TRANSITION_TO_EMAIL_ADD_REQUEST:"addingEmailRequest",TRANSITION_TO_EMAIL_VERIFY_REQUEST:"verifyingEmailRequest",PASSWORD_VALUE_CHANGED:{actions:(0,o.f0)({password:(e,t)=>t.data.password||e.password})}}},editingEmail:{on:{MARKETING_CONSENT_STATUS_CHANGED:{actions:(0,o.f0)({marketingConsentState:(e,t)=>t.data.marketingConsentState||e.marketingConsentState})},NEW_EMAIL_VALUE_CHANGED:{actions:(0,o.f0)({newEmail:(e,t)=>t.data.newEmail||e.newEmail})},BACK:{target:"verifyingEmailRequest",actions:(0,o.f0)({isRateLimitExceeded:!1})},TRANSITION_TO_ENTERING_OTP_SENT_TO_EMAIL_HAPPENED:{target:"enteringOTPSentToNewEmail",actions:(0,o.f0)({otp_id:(e,t)=>t.data.otp_id||e.otp_id,isRateLimitExceeded:!1})},OTP_RATE_LIMIT_EXCEEDED:{actions:(0,o.f0)({isRateLimitExceeded:!0})}}},addingEmail:{on:{MARKETING_CONSENT_STATUS_CHANGED:{actions:(0,o.f0)({marketingConsentState:(e,t)=>t.data.marketingConsentState||e.marketingConsentState})},NEW_EMAIL_VALUE_CHANGED:{actions:(0,o.f0)({newEmail:(e,t)=>t.data.newEmail||e.newEmail})},BACK:{target:"addingEmailRequest",actions:(0,o.f0)({isRateLimitExceeded:!1})},TRANSITION_TO_ENTERING_OTP_SENT_TO_EMAIL_HAPPENED:{target:"enteringOTPSentToNewEmail",actions:(0,o.f0)({otp_id:(e,t)=>t.data.otp_id||e.otp_id,isRateLimitExceeded:!1})},OTP_RATE_LIMIT_EXCEEDED:{actions:(0,o.f0)({isRateLimitExceeded:!0})}}},addingEmailRequest:{on:{BACK:"enteringCurrentPassword",TRANSITION_TO_EDITING_EMAIL_HAPPENED:{target:"addingEmail",actions:(0,o.f0)({isRateLimitExceeded:!1})}}},verifyingEmailRequest:{on:{BACK:{target:"enteringCurrentPassword",actions:(0,o.f0)({isRateLimitExceeded:!1})},TRANSITION_TO_ENTERING_OTP_SENT_TO_EMAIL_HAPPENED:"enteringOTPSentToEmail",TRANSITION_TO_EDITING_EMAIL_HAPPENED:{target:"editingEmail",actions:(0,o.f0)({isRateLimitExceeded:!1})},OTP_ID_VALUE_SET:{actions:(0,o.f0)({otp_id:(e,t)=>t.data.otp_id||e.otp_id,isRateLimitExceeded:!1})},RATE_LIMIT_EXCEEDED:{actions:(0,o.f0)({isRateLimitExceeded:!0})}}},selectingConfirmationMethod:{on:{TRANSITION_TO_ENTERING_OTP_SENT_TO_EMAIL_HAPPENED:"enteringOTPSentToEmailToChangePassword",TRANSITION_TO_ENTERING_CURRENT_PASSWORD_HAPPENED:{target:"enteringCurrentPassword",actions:(0,o.f0)({isRateLimitExceeded:!1})},RATE_LIMIT_EXCEEDED:{actions:(0,o.f0)({isRateLimitExceeded:!0})},OTP_ID_VALUE_SET:{actions:(0,o.f0)({otp_id:(e,t)=>t.data.otp_id||e.otp_id,isRateLimitExceeded:!1})}}},enteringOTPSentToEmail:{on:{BACK:"selectingConfirmationMethod",RATE_LIMIT_EXCEEDED:{actions:(0,o.f0)({isRateLimitExceeded:!0})},OTP_CODE_VALUE_CHANGED:{actions:(0,o.f0)({otp_code:(e,t)=>t.data.otp_code||e.otp_code})},OTP_ID_VALUE_SET:{actions:(0,o.f0)({otp_id:(e,t)=>t.data.otp_id||e.otp_id,isRateLimitExceeded:!1})},TRANSITION_TO_ENTERING_NEW_PASSWORD_HAPPENED:{target:"enteringNewPassword",actions:(0,o.f0)({password:""})}}},enteringOTPSentToNewEmail:{on:{OTP_CODE_VALUE_CHANGED:{actions:(0,o.f0)({otp_code:(e,t)=>t.data.otp_code||e.otp_code})},TRANSITION_TO_ENTERING_OTP_SENT_TO_EMAIL_HAPPENED:{target:"enteringOTPSentToNewEmail",actions:(0,o.f0)({otp_id:(e,t)=>t.data.otp_id||e.otp_id,isRateLimitExceeded:!1})},TRANSITION_TO_ENTERING_NEW_PASSWORD_HAPPENED:"enteringNewPassword"}},enteringOTPSentToEmailToChangePassword:{on:{BACK:"selectingConfirmationMethod",RATE_LIMIT_EXCEEDED:{actions:(0,o.f0)({isRateLimitExceeded:!0})},OTP_CODE_VALUE_CHANGED:{actions:(0,o.f0)({otp_code:(e,t)=>t.data.otp_code||e.otp_code})},OTP_ID_VALUE_SET:{actions:(0,o.f0)({otp_id:(e,t)=>t.data.otp_id||e.otp_id,isRateLimitExceeded:!1})},TRANSITION_TO_ENTERING_NEW_PASSWORD_HAPPENED:{target:"enteringNewPassword",actions:(0,o.f0)({password:""})}}},enteringNewPassword:{on:{PASSWORD_REPEAT_VALUE_CHANGED:{actions:(0,o.f0)({passwordRepeat:(e,t)=>t.data.passwordRepeat||e.passwordRepeat})},PASSWORD_VALUE_CHANGED:{actions:(0,o.f0)({password:(e,t)=>t.data.password||e.password})}}}},on:{RESET:{target:".idle",actions:(0,o.f0)({email:"",password:"",passwordRepeat:"",otp_id:"",otp_code:""})}}},s=(0,i.u)(a)},18781:function(e,t,n){"use strict";n.d(t,{d:function(){return a}});var i=n(65865);let o={id:"phoneModifying",initial:"modifyingPhoneNumber",context:{phone:"",country:"",otp_id:"",otp_code:"",mfa_otp_id:"",mfa_phone:"",mfa_otp_code:"",isRateLimitExceeded:!1},states:{modifyingPhoneNumber:{on:{CONTINUE:{target:"confirmingEnteredPhoneNumber",actions:(0,i.f0)({phone:(e,t)=>t.data.phone||e.phone,country:(e,t)=>t.data.country||e.country})},COUNTRY_CODE_CHANGED:{actions:(0,i.f0)({country:(e,t)=>t.data.country||e.country})}}},confirmingEnteredPhoneNumber:{on:{OTP_RATE_LIMIT_EXCEEDED:{actions:(0,i.f0)({isRateLimitExceeded:!0})},CONTINUE:"enteringOTPSentToPhoneNumber",EDIT:"modifyingPhoneNumber",OTP_ID_WAS_SET:{actions:(0,i.f0)({otp_id:(e,t)=>t.data.otp_id||e.otp_id,isRateLimitExceeded:!1})}}},enteringOTPSentToPhoneNumber:{on:{CONTINUE:{target:"confirmingMFAOTPSend",actions:(0,i.f0)({mfa_otp_id:(e,t)=>t.data.otp_id||e.mfa_otp_id,mfa_phone:(e,t)=>t.data.address||e.mfa_phone})},OTP_CODE_WAS_SET:{actions:(0,i.f0)({otp_code:(e,t)=>t.data.otp_code||e.otp_code})},OTP_ID_WAS_SET:{actions:(0,i.f0)({otp_id:(e,t)=>t.data.otp_id||e.otp_id,isRateLimitExceeded:!1})},OTP_RATE_LIMIT_EXCEEDED:{actions:(0,i.f0)({isRateLimitExceeded:!0})}}},confirmingMFAOTPSend:{on:{CONTINUE:"enteringMFAOTPSentToOldPhoneNumber"}},enteringMFAOTPSentToOldPhoneNumber:{on:{OTP_CODE_WAS_SET:{actions:(0,i.f0)({mfa_otp_code:(e,t)=>t.data.otp_code||e.otp_code})},MFA_OTP_CODE_WAS_SENT:{actions:(0,i.f0)({mfa_otp_id:(e,t)=>t.data.otp_id||e.mfa_otp_id,mfa_phone:(e,t)=>t.data.address||e.mfa_phone})},OTP_ID_WAS_SET:{actions:(0,i.f0)({otp_id:(e,t)=>t.data.otp_id||e.otp_id,isRateLimitExceeded:!1})},OTP_RATE_LIMIT_EXCEEDED:{actions:(0,i.f0)({isRateLimitExceeded:!0})}}}},on:{RESET:{target:".modifyingPhoneNumber",actions:(0,i.f0)({phone:()=>"",country:()=>"",otp_id:()=>"",otp_code:()=>"",mfa_otp_id:()=>"",mfa_phone:()=>"",mfa_otp_code:()=>"",isRateLimitExceeded:!1})}}},a=(0,n(99786).u)(o)},72227:function(e,t,n){"use strict";n.d(t,{N:function(){return i}});let i=n(25868).uc.feature("UserCredentialPage")},68021:function(e,t,n){"use strict";n.d(t,{e7:function(){return i},ps:function(){return a},sm:function(){return o}});let i=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],o=100111,a=154058},75978:function(e,t,n){"use strict";n.d(t,{$:function(){return s}});var i=n(61794),o=n(39595),a=n(5320);class s{useAllUserSavedPaymentMethods(e){let t=i.ir.useGetUserRebillsQuery(e);return s.adaptSavedPaymentMethodsResponse(t.data||[])}useAllUserSavedPaymentMethodsQuery(e){let t=i.ir.useGetUserRebillsQuery(e);return{...t,data:s.adaptSavedPaymentMethodsResponse(t.data||[])}}makeAllUserSavedPaymentMethodsRequest(e){return this.appDispatch(i.ir.endpoints.getUserRebills.initiate(e)).then(e=>(e.error&&this.reviewRequestResult(e.error),e))}handleAllUserSavedPaymentMethodsSsrRequest(e,t){let{error:n}=i.ir.endpoints.getUserRebills.select(e)(t.getState());this.reviewRequestResult(n)}useDeleteUserSavedPaymentMethod(){return i.ir.useDeleteUserRebillMutation()}reviewRequestResult(e){if(e)throw(0,o.EL)("BackendInteractionError","All user rebills info getting","Request error",{originalError:e})}static adaptSavedPaymentMethodsResponse(e){let t=[];for(let n of e)n.info?t.push(new a.cZ({savedPaymentMethodId:n.id,info:n.info,paymentMethod:n.payment_method,paymentSystemId:n.payment_system_id.toString(),isLinkedToAbonement:n.is_linked_to_abonement,isLinkedToSubscription:n.is_linked_to_subscription})):(0,o.EL)("BackendInteractionError","Rebills info adapting","rebill does not include info for ".concat(n.payment_method,", ").concat(n.payment_system_id)).emit();return t}constructor(e){this.appDispatch=e}}},65642:function(e,t,n){"use strict";n.d(t,{A:function(){return r}});var i=n(61794),o=n(44194),a=n(59838),s=n(39595);let r=()=>{let e=(0,i.CG)(e=>e.foundationUser.id),t=(0,i.CG)(e=>e.foundationUser.is_tester),n=(0,i.CG)(e=>e.browser.headers["ui-currency"]),{data:r}=i.kn.endpoints.updateGAextendesCookies.useQuery(void 0,{skip:!e});(0,o.useEffect)(()=>{if(null==r?void 0:r.cookie)try{let e=r.cookie;console.log("Ecom -> sending...");let i=e.replace(/'/g,'"').replace(/undefined/g,"null").match(/\[([^\]]+)\]/g),o=i?i.map(e=>JSON.parse(e)):[];if(o.length){console.debug("Ecom -> cookie data:",o);let e=o.filter(function(e){return"_trackEvent"===e[0]})[0];console.debug("Ecom -> order:",e);let i=o.filter(function(e){return"_addTrans"===e[0]})[0];console.debug("Ecom -> paymentInfo:",i);let s={value:0,transaction_id:0,items:[],currency:n};if("SubscriptionSuccess"===e[1])s.value=i[2],s.transaction_id=i[1].split("_")[1],s.items.push({item_name:"subscription",price:i[2]});else if("SubscriptionPurchaseOk"===e[1])s.value=i[2],s.transaction_id=i[1].split("_")[1],s.items.push({item_name:"abonement",price:i[2]});else if("BasketPurchaseOk"===e[1]){s.value=i[3],s.transaction_id=i[1].split("_")[1];let e=o.filter(function(e){return"_addItem"===e[0]});s.items=e.map(function(e){return{item_id:e[2],price:e[5]}})}a.BK.sendEcommerceEvent({event:a.uK.PURCHASE,ecommerce:s},t)}}catch(e){(0,s.EL)("AnalyticsError","useSendEcomAnalyticsObject.ts","error when parsing ecommerce data:",{originalError:e}).emit()}},[null==r?void 0:r.cookie])}},8976:function(e,t,n){"use strict";n.d(t,{g:function(){return N}});var i=n(31549),o=n(44194),a=n(51865),s=n.n(a),r=n(48592),l=n(39319),_=n(61794),c=n(48747),d=n(52805),u=n(51208),m=n.n(u);let p=e=>{let{className:t}=e,n=(0,_.CG)(e=>e.foundationUser),a=(0,c.A)(),r=(0,d.u3)((null==a?void 0:a.detail).end_date),[l,u]=(0,o.useState)({hours:"00",minutes:"00",seconds:"00"});return((0,o.useEffect)(()=>{let e=null;if((null==a?void 0:a.status)==="ACTIVE"){let t=new Date(r).getTime();if(isNaN(t))return;e=setInterval(()=>{if(t<=new Date().getTime()){u({hours:"00",minutes:"00",seconds:"00"}),clearInterval(e);return}u({...(0,d.gv)(t)})},1e3)}return()=>{e&&clearInterval(e)}},[r]),!a||"ACTIVE"!==a.status||n.abonement.is_active||n.subscription.is_active)?null:(0,i.jsxs)("div",{className:s()(m().countdown,t),children:[l.hours,":",l.minutes,":",l.seconds]})},f=e=>{let{className:t}=e,{t:n}=(0,r.$G)();return(0,i.jsx)("h4",{className:s()(m().title,t),children:n("Четвёртая книга в подарок")})};var h=n(58655);let b=e=>{let{className:t}=e;return(0,i.jsx)("div",{className:s()(m().book,m().bookImage,t)})},x=e=>{let{isBookCard:t}=e,n=(0,_.CG)(e=>e.foundationUser),a=(0,c.A)();if(!a||n.abonement.is_active||n.subscription.is_active)return null;let r=e=>{if(e){var n;let i=t?32:45,o=t?44:62,a=null!==(n=e.cover_ratio)&&void 0!==n?n:i/o;return{width:"".concat(Math.max(a*o,i),"px")}}return{}};return(0,i.jsxs)("div",{className:s()(m().books,t&&m().books__card),children:[Array.from({length:3}).map((e,t)=>{var n,l,_,c;return(0,i.jsxs)(o.Fragment,{children:[(0,i.jsx)("div",{className:s()(m().book,{[m().book_empty]:!(null===(n=a.detail.arts)||void 0===n?void 0:n[t])}),style:r(null===(l=a.detail.arts)||void 0===l?void 0:l[t]),children:(null===(_=a.detail.arts)||void 0===_?void 0:_[t])&&(0,i.jsx)(h.uq,{artId:a.detail.arts[t].id,alt:a.detail.arts[t].title,loading:"lazy",decoding:"async",coverSizes:{byHeight:!0,desktopNormal:70,desktopHighDensity:120,mobileNormal:70,mobileHighDensity:120},unloaderSize:20})}),(0,i.jsx)("div",{className:m().divider,children:2===t?"=":"+"})]},(null===(c=a.detail.arts)||void 0===c?void 0:c[t])?a.detail.arts[t].id:"bannerBook-".concat(t))}),(0,i.jsx)(b,{})]})},v=e=>{let{className:t}=e;return(0,i.jsxs)("div",{className:s()(m().books,t),children:[Array.from({length:3}).map((e,t)=>(0,i.jsxs)(o.Fragment,{children:[(0,i.jsx)("div",{className:s()(m().book,m().book_empty)}),(0,i.jsx)("div",{className:m().divider,children:2===t?"=":"+"})]},"bannerBook-".concat(t))),(0,i.jsx)(b,{})]})},g=e=>{let{className:t}=e,n=(0,_.CG)(e=>e.foundationUser),{t:o}=(0,r.$G)(),a=(0,c.A)();return!a||n.abonement.is_active||n.subscription.is_active?null:"ACTIVE"===a.status?(0,i.jsx)("span",{className:s()(m().description,t),children:o("Успейте выбрать подарок.")}):(0,i.jsxs)("span",{className:s()(m().description,t),children:[!a.detail.arts.length&&o("Купите три книги и получите ещё одну в подарок."),1===a.detail.arts.length&&o("Осталось добавить ещё две книги."),2===a.detail.arts.length&&o("Осталось добавить ещё одну книгу."),a.detail.arts&&a.detail.arts.length>=3&&o("После покупки вы сможете выбрать в подарок книгу до {amount}.",{amount:a.offerPrice.toStringWithCurrency()})]})};var j=n(32475);let N=e=>{let{onTermsClick:t,className:n,isDisplayEmptyBooks:o}=e,a=(0,_.CG)(e=>e.foundationUser),{t:d}=(0,r.$G)(),u=(0,c.A)();return!u||a.abonement.is_active||a.subscription.is_active?null:(0,i.jsxs)("div",{className:s()(m().container,n),children:[(0,i.jsx)(f,{}),"ACTIVE"===u.status?(0,i.jsxs)("div",{className:m().countdownWrapper,children:[(0,i.jsx)("div",{className:m().countdownWrapper__left,children:(0,i.jsx)(b,{})}),(0,i.jsxs)("div",{className:m().countdownWrapper__right,children:[(0,i.jsxs)("div",{className:m().info,children:[(0,i.jsx)(g,{}),(0,i.jsx)(j.M,{onTermsClick:t})]}),(0,i.jsx)(p,{}),(0,i.jsx)(l.z,{mode:"primary",size:"small",text:d("Выбрать подарок"),className:m().countdownWrapper__button,href:"/"})]})]}):(0,i.jsxs)(i.Fragment,{children:[o?(0,i.jsx)(v,{}):(0,i.jsx)(x,{}),(0,i.jsxs)("div",{className:m().info,children:[!o&&(0,i.jsx)(g,{}),(0,i.jsx)(j.M,{onTermsClick:t})]})]})]})};N.Title=f,N.Books=x,N.BooksEmpty=v,N.Description=g,N.BookGift=b,N.Terms=j.M,N.Countdown=p},32475:function(e,t,n){"use strict";n.d(t,{M:function(){return u},e:function(){return m}});var i=n(31549);n(44194);var o=n(51865),a=n.n(o),s=n(48592),r=n(61794),l=n(55714),_=n(59838),c=n(51208),d=n.n(c);let u=e=>{let{onTermsClick:t,className:n}=e,{t:o}=(0,s.$G)();return(0,i.jsx)(l.Fg,{href:m(),className:a()(d().link,n),onClick:t,children:o("Условия акции")})};function m(){let e=(0,r.CG)(e=>e.browser.clientHost),t=new Map([["5636",_.Ok],["13804",_.Ov],["13954",_.p6],["13949",_.qT],["13974",_.LS],["13979",_.Gm],["13964",_.HF],["13959",_.MB],["13969",_.Yt]]);for(let n of t.keys()){let i=t.get(n);if("function"==typeof i&&i(e))return"https://".concat(e,"/pages/cms/?page=").concat(n)}}},48747:function(e,t,n){"use strict";n.d(t,{A:function(){return l}});var i=n(61794),o=n(44194),a=n(59838),s=n(81014);class r{get offerPrice(){if("offer_price"in this.detail&&this.detail.offer_price)return new s.W(this.detail.offer_price.amount,this.detail.offer_price.currency);if(this.detail.arts){let e=this.detail.arts.map(e=>{var t,n;return{price:(null===(t=e.prices)||void 0===t?void 0:t.full_price)||0,currency:(null===(n=e.prices)||void 0===n?void 0:n.currency)||"RUB"}}).sort((e,t)=>{let{price:n}=e,{price:i}=t;return n-i})[0];return new s.W(e.price,e.currency)}return new s.W(0,"RUB")}constructor(e){this.status=e.offer_status,this.detail=e.offer_detail}}let l=()=>{let{data:e,isLoading:t,isError:n}=i.Ce.useGetFourArtOfferQuery();if((0,o.useEffect)(()=>{n&&(0,a.RY)("getFourArtOffer error",{logLevel:"error"})},[n]),e&&!t&&!n)return new r(e)}},5320:function(e,t,n){"use strict";n.d(t,{cZ:function(){return a},fG:function(){return r},mg:function(){return s}});var i=n(87956),o=n(58689);class a{getLabel(){if(s(this)){let e=this.info.mask.slice(-4);return"**".concat(e)}return r(this)?this.info.email:""}getIconParams(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";if(s(this)){let t="unknown";switch(this.info.brand){case i.Y.MasterCard:t="default"===e?"masterCard":"masterCard-small";break;case i.Y.MIR:t="mir";break;case i.Y.UnionPay:t="unionPay";break;case i.Y.Visa:t="visa";break;default:t="unknown"}return{name:t,path:"paymentMethods"}}return r(this)?{name:"default"===e?"payPal":"payPal-small",path:"paymentMethods"}:{name:"unknown",path:"paymentMethods"}}checkIfRussianBankCardPaymentMethod(){return s(this)&&(this.paymentSystemId===o.Ah.PAYONLINE||this.paymentSystemId===o.Ah.SBER_PAY_V2)}constructor(e){this.data=e,this.savedPaymentMethodId=e.savedPaymentMethodId,this.info=e.info,this.paymentMethod=e.paymentMethod,this.paymentSystemId=e.paymentSystemId,this.isLinkedToSubscription=e.isLinkedToSubscription,this.isLinkedToAbonement=e.isLinkedToAbonement}}function s(e){return 1===e.paymentMethod}function r(e){return 2===e.paymentMethod}},59992:function(e,t,n){"use strict";n.d(t,{L3:function(){return v},R1:function(){return a},mU:function(){return g}});var i=n(31549);n(44194);var o=n(21092);function a(e){return null!==e&&"object"==typeof e&&"icon"in e}let s="<strong>340 000</strong> электронных книг — хиты, проверенные временем, и произведения молодых российских авторов",r="<strong>800 000</strong> электронных и аудиокниг, комиксов, спектаклей, подкастов и лекций",l="<strong>900 000</strong> электронных и аудиокниг, комиксов, спектаклей, подкастов и лекций",_="<strong>200 000</strong> книг и аудиокниг от современных российских авторов",c="<strong>800 000</strong> электронных и аудиокниг, комиксов, спектаклей, подкастов и лекций",d="Скидка до 30% на весь каталог Литрес",u="Скидка до 30% на бумажные книги в \xabЧитай-городе\xbb",m="Синхронизация текста и аудио",p=[r,m,u,d],f=[s,u,d],h=[l,{icon:(0,i.jsx)(j,{}),text:"Новинки и бестселлеры"},m,u,d],b=[_,m,u,d],x=[c,{icon:(0,i.jsx)(j,{}),text:"1 книга до 700 рублей в месяц из каталога Литрес - скачать и сохранить себе навсегда"},m,u,d];function v(e){return e instanceof o.T1?f:e instanceof o.jk?p:e instanceof o.mS?h:e instanceof o.KF?b:e instanceof o._P?x:[]}function g(e){return o.T1.checkIfBase(e)?s:o.jk.checkIfOptimal(e)?r:o.mS.checkIfMaximum(e)?l:o.KF.checkIfEasyReading(e)?_:o._P.checkIfBookshelf(e)?c:""}function j(e){return(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none",...e,children:(0,i.jsx)("path",{stroke:"#F50",strokeWidth:1.5,d:"M10.895 6.507c.353-.217.952-.676 1.183-1.399.066-.205.433-.302.532-.11.56 1.084 1.43 3.064 1.392 4.846-.043 2.264-1.648 4.204-3.933 4.959-.17.056-.314-.133-.234-.294.619-1.253 1.016-3.43-1.654-5.726a.2.2 0 0 0-.258 0c-2.728 2.348-2.254 4.567-1.616 5.805.08.158-.055.348-.227.301C1.773 13.724.437 9.37 4.22 6.5 7.6 3.936 6.685 2.203 5.936 1.344c-.117-.134-.03-.333.146-.312 1.233.144 4.452.939 4.54 5.309.002.145.15.243.274.166Z"})})}},87205:function(e,t,n){"use strict";n.d(t,{v:function(){return s}});var i=n(31549),o=n(52010),a=n.n(o);let s=e=>{let{text:t}=e;return(0,i.jsx)("p",{className:a().description,children:t})}},67752:function(e,t,n){"use strict";n.d(t,{I:function(){return d}});var i=n(31549),o=n(51865),a=n.n(o),s=n(48592),r=n(6769),l=n.n(r),_=n(14628),c=n(36675);let d=e=>{let{discounts:t}=e;return(0,i.jsx)("div",{children:(0,i.jsx)("div",{className:l().discountList,children:t.map(e=>(0,i.jsx)("div",{className:l().discountList__item,children:(0,i.jsx)(u,{discount:e})},e.toStringWithSymbol()))})})},u=e=>{let{discount:t}=e,{t:n,i18n:{language:o}}=(0,s.$G)();return(0,i.jsxs)("div",{className:a()(l().discount,{[l().discount_current]:t.isActive}),children:[(0,i.jsx)("strong",{className:l().discount__percent,children:t.toStringWithSymbol()}),(0,i.jsx)("span",{className:l().discount__label,children:t instanceof _.$?1===t.startSinceMonths?"сразу":2===t.startSinceMonths?"со ".concat(t.startSinceMonths.toString()," месяца"):"c ".concat(t.startSinceMonths.toString()," месяца"):t instanceof c.q?t.isActive?n("Уже доступна"):t.startAt?"".concat("ru-RU"===o?"c ":"").concat(new Date(t.startAt).toLocaleDateString(o,{month:"long",day:"numeric"})):"":""})]})}},18183:function(e,t,n){"use strict";n.d(t,{X:function(){return u}});var i=n(31549),o=n(51865),a=n.n(o),s=n(3224),r=n.n(s),l=n(48592),_=n(39319),c=n(1312),d=n.n(c);let u=e=>{let{className:t,subtitle:n,description:o,availableBooksText:s,handleClick:c,amount:u,shouldShowActions:m}=e,{t:p}=(0,l.$G)();return(0,i.jsxs)("div",{className:a()(t,d().root),children:[(0,i.jsxs)("div",{className:d().text,children:[(0,i.jsx)("h4",{className:d().text__subtitle,children:n}),(0,i.jsx)("p",{className:d().text__description,children:o})]}),m&&(0,i.jsxs)("div",{className:d().collection,children:[u>0&&(0,i.jsx)(_.z,{mode:"primary",size:"medium",text:p("Выбрать"),fullWidth:!0,className:d().collection__button,onClick:c}),r()(u)&&(0,i.jsxs)("div",{className:d().collection__amount,children:[s,(0,i.jsx)("span",{children:u})]})]})]})}},35713:function(e,t,n){"use strict";n.d(t,{i:function(){return s}});var i=n(33669),o=n(80094),a=n(92479);function s(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{forceTariffs:!1};if(!e.isActiveInGracePeriod)throw Error("Creation of prolongation object from user subscription is only possible when user subscription is in active grace period");let s={inapp_name:null,class_id:e.prolongClassId||e.classId,currency:"RUB",discount:0,is_best_price:!0,month_price:e.prolongPrice.value,price:e.prolongPrice.value,promo_counter:0,promo_price:e.prolongPrice.value,special_price:e.prolongPrice.value,subscription_discount_type:"",subscription_discount_value:0,prolong_price:e.prolongPrice.value,duration:e.prolongDuration.value,base_price:e.prolongPrice.value,bonus_month_count:0,is_trial_available:!1,plan:null!==(t=e.plan)&&void 0!==t?t:24},r=i.Y.checkIfSubscriptionTariffIsNotOptimal(e.plan);if(n.forceTariffs||r){let e=o.H.create(s);if(e)return e}return new a.i(s)}},35014:function(e,t,n){"use strict";n.d(t,{U:function(){return a}});var i=n(76791),o=n(26249);function a(){let e=(0,o.useRouter)();return!!((0,i.zX)(1234)||e.query.trial_renew_cancel)}},73385:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var i=n(61794),o=n(44194),a=n(15381),s=n(42982),r=n(34390);function l(){let e=(0,a.t)(),t=function(){let{data:e=[]}=i.Bh.useGetSubscriptionPricesQuery({subscriptionType:14});return(0,o.useMemo)(()=>new r.S(e),[e])}(),n=i.Bh.useGetUserSubscriptionsInfoQuery(null,{skip:!e}),l=(0,o.useMemo)(()=>n.data&&Object.keys(n.data).length?n.data:null,[n.data]),_=(0,o.useMemo)(()=>new s.M(l,t),[l,t]);return{...n,data:_}}},46633:function(e,t,n){"use strict";n.d(t,{o:function(){return d}});var i=n(31549),o=n(44194),a=n(61794),s=n(59838),r=n(26249),l=n.n(r),_=n(97933),c=n(68969);let d=(0,o.forwardRef)(function(e,t){let n=(0,a.CG)(e=>e.browser.pda),[r,d]=(0,o.useState)(!1),[m,p]=(0,o.useState)({}),f=(0,a.CG)(e=>e.face.language||s.pF.ru),h=(0,s.s7)(f),b=(0,s.XF)(f),x=(0,s.Ph)(f),v=(0,s.P6)(f),g=!1!==e.canNewPaymentFrameBeUsed&&(h||b||x||v),j=(0,o.useCallback)(()=>{let t=window.location,i={mode:"default",ref_url:encodeURIComponent(t.pathname+t.search),is_next:1};e.purchaseTraceId&&(i.purchase_trace_id=e.purchaseTraceId);let o=u(t.href);if(o.epay&&(i.epay=o.epay),n){let e=new URLSearchParams(i);window.location.href="/pages/put_money_on_account/?".concat(e)}else p(i),d(!0)},[n]),N=(0,o.useCallback)(()=>{let t=function(e){let{cameFromSource:t,cameFromSourcePayload:n,afterPaymentRedirectParams:i}=e;return(0,c.h)({cameFromSource:t,cameFromSourcePayload:n,afterPaymentRedirectParams:i,paymentOperation:"put-money-into-account",specificPaymentOperationUrlParams:{"initial-amount":"default"}})}(e);l().push(t)},[e]);return(0,o.useImperativeHandle)(t,()=>({goToPaymentOperation(){var t;return null===(t=e.onGoingToPayment)||void 0===t||t.call(e),g?N():j(),{isGoingToNewPaymentFrame:g,canGoToPayment:Promise.resolve(!0)}}}),[j,e]),(0,i.jsx)(_.T,{isOpen:r,onClose:()=>{var t;d(!1),null===(t=e.onCloseOldFrameModal)||void 0===t||t.call(e)},onShow:()=>{d(!1)},onHide:()=>{var t;d(!0),null===(t=e.onCloseOldFrameModal)||void 0===t||t.call(e)},paymentData:m})}),u=e=>{let t=new URL(e,m()).searchParams.entries(),n={};for(let[e,i]of t)n[e]=i;return n},m=()=>s.Ym&&window.location.host.includes("litres")&&!window.location.host.includes("stage.ssr.b")?window.location.protocol+"//"+window.location.hostname:"https://www.litres.ru"},39737:function(e,t,n){"use strict";n.d(t,{I:function(){return s}});var i=n(44194),o=n(26249),a=n(68969);let s=(0,i.forwardRef)(function(e,t){let{offerId:n,mode:s,cameFromSource:r,afterPaymentRedirectParams:l}=e,_=(0,o.useRouter)();return(0,i.useImperativeHandle)(t,()=>({goToPaymentOperation(){let e=function(e){let{cameFromSource:t,afterPaymentRedirectParams:n,mode:i,offerId:o}=e;return(0,a.h)({cameFromSource:t,paymentOperation:"rebill-changing",afterPaymentRedirectParams:n,specificPaymentOperationUrlParams:{mode:i,offer:(o||0).toString()}})}({offerId:n,mode:s,cameFromSource:r,afterPaymentRedirectParams:l});return _.push(e),{isGoingToNewPaymentFrame:!0,canGoToPayment:Promise.resolve(!0)}}}),[_,n,s,r,l]),null})},50307:function(e,t,n){"use strict";n.d(t,{n:function(){return l}});var i=n(31549),o=n(44194),a=n(61794),s=n(58689),r=n(97933);let l=(0,o.forwardRef)(function(e,t){let{offerId:n}=e,l=(0,a.CG)(e=>e.browser.pda),[_,c]=(0,o.useState)(!1),d=(0,o.useMemo)(()=>({mode:"change_offers_rebill",descr:s.Ds.BLIK,offer:(null==n?void 0:n.toString())||"0",is_next:"1"}),[n]),u=()=>{c(!0)},m=()=>{c(!1)},p=(0,o.useCallback)(()=>{if(l){let e=new URLSearchParams(d);window.location.href="/pages/put_money_on_account/?".concat(e.toString())}else u()},[d,l]),f=(0,o.useCallback)(()=>(p(),{canPay:!0}),[p]);return(0,o.useImperativeHandle)(t,()=>({goToPaymentOperation(){let{canPay:e}=f();return{isGoingToNewPaymentFrame:!1,canGoToPayment:Promise.resolve(e)}}}),[f]),(0,i.jsx)(r.T,{isOpen:_,onClose:m,onShow:m,onHide:u,paymentData:d})})},87956:function(e,t,n){"use strict";var i,o;n.d(t,{Y:function(){return i}}),(o=i||(i={})).Visa="Visa",o.MasterCard="MasterCard",o.UnionPay="UnionPay",o.MIR="MIR",o.Unknown="Unknown"},88396:function(e,t,n){"use strict";n.d(t,{MJ:function(){return a},Vl:function(){return s},WB:function(){return i},wN:function(){return o}});let i="800 000",o="".concat(i,"+"),a="".concat(o," аудиокниг, книг и подкастов из каталога Литрес"),s=[{iconName:"star",title:a},{iconName:"discount",title:"Скидка до 30% на бумажные книги в сети магазинов ”Читай город” и на Литрес из платного каталога"},{iconName:"sync",title:"Переключайтесь с текста на аудио в любой момент"},{iconName:"noInternet",title:"Читайте и слушайте без интернета"}]},58119:function(e,t,n){"use strict";n.d(t,{J:function(){return _},n:function(){return l}});var i=n(31549),o=n(44194),a=n(61794),s=n(34270);let r=(0,o.createContext)(e=>{}),l=()=>(0,o.useContext)(r),_=e=>{let{children:t}=e,n=(0,a.CG)(e=>e.browser.pda),[l,_]=(0,o.useState)(null);return(0,i.jsxs)(r.Provider,{value:_,children:[t,l&&(0,i.jsx)(s.P,{...l,title:l.title||"",message:l.message||"",mode:l.mode||"info",horizontalAlign:l.horizontalAlign||"right",verticalAlign:l.verticalAlign||"top",isMobile:n,isOpen:!0,onClose:()=>{_(null)}})]})}},65597:function(e,t,n){"use strict";n.d(t,{R:function(){return o}});var i=n(44194);function o(e){let[t,n]=(0,i.useState)(!1),o=(0,i.useMemo)(()=>new IntersectionObserver(e=>{let[t]=e;n(t.isIntersecting)}),[]);return(0,i.useEffect)(()=>(e.current&&o.observe(e.current),()=>{o.disconnect()}),[e,o]),t}},47057:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return s1},default:function(){return s3}});var i,o,a,s,r,l,_,c,d,u,m,p,f=n(31549),h=n(44194),b=n(21138),x=n.n(b),v=n(48592),g=n(21870),j=n(51865),N=n.n(j),y=n(61794),k=n(20239),E=n(4438),S=n(55714),P=n(49596),w=n.n(P);let T=()=>{let{t:e}=(0,v.$G)(),t=(0,y.TL)();return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(x(),{children:(0,f.jsx)("title",{children:e("Войдите или зарегистрируйтесь")})}),(0,f.jsxs)("div",{className:w().wrapper,children:[(0,f.jsx)("div",{className:w().heading,children:e("Вы не авторизованы")}),(0,f.jsx)("div",{className:w().subHeading,children:(0,f.jsx)(v.cC,{i18nKey:"Для доступа к личному кабинету необходимо <loginButton>войти</loginButton>",components:{loginButton:(0,f.jsx)(S.Fg,{onClick:e=>{null==e||e.preventDefault(),t(y.hi.global.header.auth.setAuthPopupVisibility(!0))}})}})})]})]})};var C=n(59838),I=n(73385),A=n(56469),R=n(44731);(i=_||(_={})).SUBSCRIPTION_AUTO_RENEWAL_ACCOUNT="subscription_autorenewal_account",i.SUBSCRIPTION_AUTO_RENEWAL_CANCEL="subscription_autorenewal_cancel",i.PROFILE_CLICK_CANCEL_SUBSCRIPTION="profile_click_cancel_subscription",i.LK_CLICK_MANAGE_SUBSCRIPTION="lk_click_manage_subscription",i.LK_CLICK_BOOK_SUBSCRIPTION="lk_click_book_subscription",i.LK_CLICK_PAY_SUBSCRIPTION="lk_click_pay_subscription",i.LK_CLICK_ADD_CARD_SUBSCRIPTION="lk_click_add_card_subscription",i.LK_CHOOSE_CLICK="lk_choose_click",i.LK_PROLONG_SUBSCRIPTION="lk_prolong_subscription",i.ABONEMENT_AUTO_RENEWAL_ACCOUNT="abonement_autorenewal_account",i.ABONEMENT_AUTO_RENEWAL_CANCEL="abonement_autorenewal_cancel",i.LK_CLICK_MANAGE_ABONEMENT="lk_click_manage_abonement",i.LK_CLICK_PERSONAL_SELECTION_ABONEMENT="lk_click_personal_selection_abonement",i.LK_CLICK_BOOK_ABONEMENT="lk_click_book_abonement",i.LK_CLICK_PAY_ABONEMENT="lk_click_pay_abonement",i.LK_CLICK_ADD_CARD_ABONEMENT="lk_click_add_card_abonement",i.LK_OPEN_PAYMENTS="lk_open_payments",i.LK_ADD_NEW_CARD="lk_add_new_card",i.LK_NEW_CARD_ADDED="lk_new_card_added",i.LK_NEW_CARD_DELETED="lk_new_card_deleted";let O=(e,t)=>{R.TM.sendEvent(["LITRES_TRACKER"],{eventType:e,params:{...t}})},D=e=>{var t,n,i;let{userSubscription:o,userAbonement:a}=e,s=(null===(t=o.getActiveCumulativeDiscount())||void 0===t?void 0:t.value)||0,r=(null==a?void 0:null===(i=a.activeSubscription)||void 0===i?void 0:null===(n=i.getActiveCumulativeDiscount())||void 0===n?void 0:n.value)||0;return s>r?s:r},L=e=>{var t,n;let{userInfo:i,userSubscription:o,userAbonement:a}=e;return{subscription_user_status:o.getStatus(),abonement_user_status:(null==a?void 0:a.getStatus())||"off",date_prolongate_subscription:o.dates.end||"",date_prolongate_abonement:(null==a?void 0:null===(t=a.activeSubscription)||void 0===t?void 0:t.renew.date.toString())||"",summ_prolongate_subscription:o.prolongPrice.value.toString()||"",summ_prolongate_abonement:(null==a?void 0:null===(n=a.activeSubscription)||void 0===n?void 0:n.renew.price.value.toString())||"",litres_wallet_summ:(null==i?void 0:i.account.real)||0,bonus_card_summ:(null==i?void 0:i.account.bonus)||0,user_discount_chitai:o.isActive?30:0,user_discount_litres:D({userSubscription:o,userAbonement:a}),email_added:!!(null==i?void 0:i.profile.email),phone_added:!!(null==i?void 0:i.profile.phone_number)}},B=e=>{let{extra:t,...n}=e;return{...L(n),...t}},G=[1,0],F=()=>{var e,t;let{data:n,isLoading:i}=y.r7.useGetFoundationUserDetailedInfoQuery(),{data:o,isLoading:a}=(0,I.Z)(),{data:s,isLoading:r}=(0,A.Z)(),[l,{data:_,isLoading:c,error:d}]=y.r7.useLazyGetBonusesQuery(),u=(null==_?void 0:_.current_available_bonuses)!==void 0&&null!==_.current_available_bonuses?_.current_available_bonuses:void 0,m=(null==_?void 0:null===(e=_.nearest_expiration_bonuses)||void 0===e?void 0:e.total)!==void 0&&null!==_.nearest_expiration_bonuses.total?_.nearest_expiration_bonuses.total:void 0,p=(null==_?void 0:null===(t=_.nearest_expiration_bonuses)||void 0===t?void 0:t.expired_at)?(0,C.YV)(_.nearest_expiration_bonuses.expired_at):0,f=L({userSubscription:o,userAbonement:s,userInfo:n}),{id:h,profile:b,settings:x,account:v,library_info:g,is_user_referral:j,is_reader_partner:N,login:k,abonement:{is_active:E,valid_till:S}={is_active:!1,valid_till:""},loyalty:{is_loyalty_user:P}={is_loyalty_user:void 0},subscription:{is_active:w}={is_active:!1}}=n||{},T=!!(((null==x?void 0:x.profile_privacy)==="public"||(null==x?void 0:x.profile_privacy)==="default")&&(null==b?void 0:b.avatar_url)&&(null==b?void 0:b.avatar_url.length)>0),R=(null==x?void 0:x.profile_privacy)==="public",{phone_number:O,is_phone_confirmed:D,email:B,is_email_confirmed:F,last_name:M,first_name:W,nickname:U,avatar_url:q="",description:z=""}=b||{},{marketing_consent_status:V}=null!=x?x:{marketing_consent_status:3},K=G.includes(V),{is_library_user:H,is_school_user:Q}=g||{},{real:$}=v||{real:0},Y=(0,y.CG)(e=>e.foundationUser.account.bonus),Z=(null==b?void 0:b.unread_notifications_count)||0,J=W&&M?"".concat(W," ").concat(M):W||M;return{phoneNumber:O,email:B,isPhoneNumberConfirmed:D,isEmailConfirmed:F,isUserFullyVerified:O&&D&&B&&F,isUserPhoneVerified:O&&D,userNameToDisplay:R?J||U||k:U||k,avatarURL:q,isAvatarPresent:T,moneyToDisplay:$,bonus:Y,isLoyaltyUser:P,isLibraryUser:H,isSchoolUser:Q,isUserReferral:j,isAbonementActive:E,abonementValidTillDate:S,isSubscriptionActive:w,isReaderPartner:N,userLogin:k,userDescription:z,userId:h,isAgreedToMarketingMailing:K,userSettings:x,analyticsParams:f,unreadNotificationsCount:Z,availableBonuses:u,burnBonuses:m,bonusesExpirationDaysLeft:p,fetchBonuses:l,bonusesError:d,isLoading:r||a||i||c}};var M=n(26249),W=n(62094);(o=c||(c={})).CREDENTIALS="/me/credentials/",o.HELP="/me/help/",o.HELPDESK="/me/help/helpdesk/",o.LIBRARIES="/me/libraries/",o.NOTIFICATIONS="/me/notifications/",o.NOTIFICATIONS_SETTINGS="/me/notifications/settings/",o.OFFERS="/me/offers/",o.PAYMENT="/me/payment/",o.PAYMENT_HISTORY="/me/payment/history/",o.PAYMENT_REFERRAL="/me/payment/referral/",o.PROFILE="/me/profile/",o.PROFILE_EDIT="/me/profile/edit/",o.SUBSCRIPTION="/me/subscription/",o.ABONEMENT="/me/abonement/",o.BONUSES="/me/bonuses/",o.DEVICES="/me/devices/",o.CONNECT_DEVICE="/me/devices/connect/";let U={ru:["/me/profile/","/me/credentials/","/me/payment/","/me/offers/","/me/notifications/","/me/help/"],other:["/me/profile/","/me/payment/","/me/offers/","/me/notifications/","/me/help/"],school:["/me/profile/","/me/credentials/","/me/notifications/","/me/help/"]},q=e=>(0,C.vo)(e)?U.school:(0,C.Ok)(e)?U.ru:U.other,z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"other",n=e.split("/").filter(Boolean),i=q((0,C.Ok)(t)?"litres.ru":t);return n.length<3?i[0]:"/".concat(n.slice(0,-1).join("/"),"/")};var V=n(96780),K=n(26832),H=n.n(K);let Q=()=>(0,f.jsx)("div",{className:H().loading,children:(0,f.jsx)(V.$,{})});var $=n(42824),Y=n.n($);let Z=e=>{let{type:t="bordered",className:n,children:i,onClick:o,...a}=e;return(0,f.jsx)("div",{onClick:o,className:N()(Y().block,Y()["block_".concat(t)],n),...a,children:i})};Z.Title=e=>{let{children:t,className:n,...i}=e;return(0,f.jsx)("h3",{className:N()(Y().block__title,n),...i,children:t})},Z.Description=e=>{let{className:t,children:n,...i}=e;return(0,f.jsx)("div",{className:N()(Y().block__description,t),...i,children:n})},Z.Divider=e=>{let{children:t}=e;return(0,f.jsx)("div",{className:Y().block__divider,children:t})};let J=()=>{let e=(0,y.CG)(e=>e.browser.pda),[t,n]=(0,h.useState)(e);return(0,h.useEffect)(()=>{e||n((0,C.gn)()||(0,C.Dt)())},[]),t};var X=n(81944),ee=n(59978),et=n(88535),en=n(39469),ei=n(43467),eo=n(18781),ea=n(65865);let es={id:"phoneVerifying",initial:"confirmingPhoneNumber",context:{phone:"",country:"",otp_id:"",otp_code:"",isRateLimitExceeded:!1},states:{confirmingPhoneNumber:{on:{TRANSITION_TO_ENTERING_OTP_SENT_TO_PHONE_NUMBER_HAPPENED:{target:"enteringOTPSentToPhoneNumber",actions:(0,ea.f0)({otp_id:(e,t)=>t.data.otp_id||e.otp_id,isRateLimitExceeded:!1})},OTP_RATE_LIMIT_EXCEEDED:{actions:(0,ea.f0)({isRateLimitExceeded:!0})}}},enteringOTPSentToPhoneNumber:{on:{OTP_CODE_WAS_SET:{actions:(0,ea.f0)({otp_code:(e,t)=>t.data.otp_code||e.otp_code})},TRANSITION_TO_ENTERING_OTP_SENT_TO_PHONE_NUMBER_HAPPENED:{target:"enteringOTPSentToPhoneNumber",actions:(0,ea.f0)({otp_id:(e,t)=>t.data.otp_id||e.otp_id,isRateLimitExceeded:!1})},OTP_RATE_LIMIT_EXCEEDED:{actions:(0,ea.f0)({isRateLimitExceeded:!0})}}}},on:{RESET:{target:".confirmingPhoneNumber",actions:(0,ea.f0)({phone:()=>"",country:()=>"",otp_id:()=>"",otp_code:()=>"",isRateLimitExceeded:!1})}}},er=(0,n(99786).u)(es);var el=n(41418),e_=n(8801),ec=n(38700);let ed=(0,ei.C)({id:"account",initial:"idle",states:{idle:{on:{MODIFY_PHONE:"phoneModifying",VERIFY_PHONE:"phoneVerifying",EDIT_PASSWORD:"passwordEditing",MODIFY_EMAIL:"emailModifying",VERIFY_EMAIL:"emailVerifying"}},phoneModifying:{invoke:{id:"phoneModifying",src:eo.d,onDone:{target:"idle"}},on:{CLOSE_MODAL:"idle"}},phoneVerifying:{invoke:{id:"phoneVerifying",src:er,onDone:{target:"idle"}},on:{CLOSE_MODAL:"idle"}},emailModifying:{invoke:{id:"emailModifying",src:e_.l,onDone:{target:"idle"}},on:{CLOSE_MODAL:"idle"}},emailVerifying:{invoke:{id:"emailVerifying",src:ec.v,onDone:{target:"idle"}},on:{CLOSE_MODAL:"idle",MODIFY_EMAIL:{target:"emailModifying"}}},passwordEditing:{invoke:{id:"passwordEditing",src:el.Q,onDone:{target:"idle"}},on:{CLOSE_MODAL:"idle"}}}});var eu=n(1178),em=n.n(eu),ep=n(9524);let ef=()=>(0,f.jsx)(ep.ZA,{isOpen:!0,children:(0,f.jsx)(V.$,{})}),eh=em()(()=>Promise.all([n.e(8993),n.e(1183),n.e(7100)]).then(n.bind(n,97100)),{loadableGenerated:{webpack:()=>[97100]},ssr:!1,loading:ef}),eb=em()(()=>n.e(6557).then(n.bind(n,52556)),{loadableGenerated:{webpack:()=>[52556]},ssr:!1,loading:ef}),ex=em()(()=>Promise.all([n.e(4519),n.e(7025)]).then(n.bind(n,27025)),{loadableGenerated:{webpack:()=>[27025]},ssr:!1,loading:ef});var ev=n(83958);let eg={phoneModifying:[eh,eb],phoneVerifying:[ex]},ej=()=>{let{isPhoneNumberConfirmed:e,phoneNumber:t}=(0,ev.P)(),[n,i]=(0,X.e)(ed),[o,a]=eg[n.value]||[()=>null,()=>null],s=()=>{t?e||i("VERIFY_PHONE"):i("MODIFY_PHONE")},r=()=>{i("CLOSE_MODAL")};return e?null:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(ee.b,{mode:ee.p.info,children:t?(0,f.jsx)(v.cC,{i18nKey:"<linkTag>Подтвердите телефон</linkTag>, чтобы вернуть доступ к профилю, если что-то случится",components:{linkTag:(0,f.jsx)(S.Fg,{onClick:s})}}):(0,f.jsx)(v.cC,{i18nKey:"<linkTag>Привяжите телефон</linkTag>, чтобы вернуть доступ к профилю, если что-то случится",components:{linkTag:(0,f.jsx)(S.Fg,{onClick:s})}})}),(0,f.jsx)(en.J,{children:(0,f.jsx)(et.zU,{name:"credentials",children:a?(0,f.jsx)(a,{onClose:r,children:(0,f.jsx)(o,{})}):(0,f.jsx)(o,{onClose:r})})})]})};var eN=n(79583),ey=n(74790),ek=n.n(ey);let eE=e=>{let{active:t,text:n}=e;return(0,f.jsx)("div",{className:N()(ek().discount,{[ek().discount_active]:t}),children:n})};var eS=n(77789),eP=n.n(eS);let ew=e=>{let{className:t,status:n,statusText:i}=e;return(0,f.jsx)("div",{className:N()(eP().status,eP()["status_".concat(n)],t),children:i})};var eT=n(10762),eC=n.n(eT);let eI=e=>(0,f.jsxs)("div",{className:eC().card,children:[(0,f.jsxs)("h3",{className:eC().card__title,children:[e.title,!!e.plan&&(0,f.jsx)("div",{className:eC().card__plan,children:e.plan}),e.status&&e.statusText&&(0,f.jsx)(ew,{status:e.status,statusText:e.statusText,className:eC().status})]}),(0,f.jsx)("div",{className:eC().card__description,"data-testid":"sabscriptionStatus__prolongInfo",children:e.description}),e.actions&&(0,f.jsx)("div",{className:eC().card__actions,children:e.actions.map((e,t)=>(0,f.jsx)(h.Fragment,{children:e},"action-".concat(t)))})]});var eA=n(39319),eR=n(51939),eO=n.n(eR);let eD=e=>(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(eA.z,{size:"medium",mode:e.mode,text:e.text,loading:e.loading,disabled:e.disabled,className:N()(eO().button,{[eO().button_light]:e.isLight}),fullWidth:!0,href:e.href,onClick:e.onClick})});var eL=n(92249),eB=n(4974),eG=n(33669);let eF=e=>{let{buttonText:t,buttonClass:n,buttonMode:i,afterPaymentRedirectParams:o,cameFromSourceForPaymentFrame:a}=e,{t:s}=(0,v.$G)(),{data:r}=y.r7.useGetFoundationUserDetailedInfoQuery(),{data:l}=(0,I.Z)(),{data:c}=(0,A.Z)(),{goToPayment:d,isGoingToNewPaymentFrame:u,paymentEntryPointControlRef:m}=(0,eL.o)(),p=eG.Y.checkIfSubscriptionTariffIsNotOptimal(l.plan);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(eA.z,{mode:i||"secondary",size:"medium",text:null!=t?t:s("Продлить за {price}",{price:l.prolongPrice.toStringWithCurrency()}),className:n,onClick:()=>{O(_.LK_CLICK_PAY_SUBSCRIPTION,B({userInfo:r,userSubscription:l,userAbonement:c})),d()},fullWidth:!0,loading:u,disabled:u}),l.promotedSubscriptionClass&&(0,f.jsx)(eB.Y,{selectedSubscriptionClass:l.promotedSubscriptionClass,cameFromSource:a,ref:m,afterPaymentRedirectParams:o,isShowingSubscriptionPlans:p})]})};var eM=n(21092),eW=n(3107),eU=n.n(eW);let eq=e=>{let{planId:t}=e,n=eM.DV[t],i=eM.mS.checkIfMaximum(t),o=eM._P.checkIfBookshelf(t);return(0,f.jsx)("div",{className:N()(eU().badge,{[eU().secondary]:i||o}),children:n})},ez=e=>{let{hasActions:t,afterPaymentRedirectParams:n,cameFromSourceForPaymentFrame:i}=e,{t:o,i18n:a}=(0,v.$G)(),s=(0,M.useRouter)(),{data:r}=y.r7.useGetFoundationUserDetailedInfoQuery(),{data:l}=(0,I.Z)(),{data:d}=(0,A.Z)(),u=e=>{e.preventDefault(),O(_.LK_CLICK_MANAGE_SUBSCRIPTION,B({userInfo:r,userSubscription:l,userAbonement:d})),s.push(c.SUBSCRIPTION,void 0,{shallow:!0})},m="",p=[],h="",b=null;switch(l.status){case"active":m=o("Активна"),h=l.isAutoRenewAvailable?o("Продлим {date} за {price}",{date:l.getProlongationDateText(a.language),price:l.prolongPrice.toStringWithCurrency()}):o("Подписка закончится {date}",{date:l.getProlongationDateText(a.language)}),l.plan&&(b=(0,f.jsx)(eq,{planId:l.plan})),p=[(0,f.jsx)(eD,{mode:"secondary",text:o("Управлять подпиской"),onClick:u},"action")];break;case"active_in_grace":m=o("Закончилась"),h=o("Возобновите подписку, чтобы вернуть доступ к каталогу и читать новые книги"),l.plan&&(b=(0,f.jsx)(eq,{planId:l.plan})),p=[(0,f.jsx)(eF,{afterPaymentRedirectParams:n,cameFromSourceForPaymentFrame:i},"payment"),(0,f.jsx)(eD,{mode:"tertiary",text:o("Управлять подпиской"),onClick:u,isLight:!0},"action")];break;default:m=o("Не подключена"),h=o("Получите доступ к каталогу из 800 000+ книг и читайте их одновременно без ограничений"),p=[(0,f.jsx)(eD,{mode:"secondary",text:o("Узнать подробности"),href:"/litres_subscription/"},"action")]}return(0,f.jsx)(eI,{title:o("Подписка"),description:h,actions:t?p:void 0,status:l.status,statusText:m,plan:b})};var eV=n(42699);let eK=()=>{let{t:e}=(0,v.$G)(),{data:t}=y.r7.useGetFoundationUserDetailedInfoQuery(),{data:n}=(0,I.Z)(),i=(0,A.g)(),{goToPayment:o,isGoingToNewPaymentFrame:a,paymentEntryPointControlRef:s}=(0,eL.o)();return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(eD,{mode:"secondary",text:e("Продлить сейчас за {summ}",{summ:i.activeSubscription.renew.price.toStringWithCurrency()}),onClick:()=>{O(_.LK_CLICK_PAY_ABONEMENT,B({userInfo:t,userSubscription:n,userAbonement:i})),(0,C.m8)({abonement_ref_url:window.location.href}),o()},loading:a,disabled:a}),(0,f.jsx)(eV.i,{ref:s,cameFromSource:eN.l.userProfileAbonement})]})},eH=e=>{var t,n;let{hasActions:i}=e,{t:o,i18n:a}=(0,v.$G)(),s=(0,M.useRouter)(),{data:r}=y.r7.useGetFoundationUserDetailedInfoQuery(),{data:l}=(0,I.Z)(),d=(0,A.g)(),u=d.activeSubscription.getExpiredDateText(a.language),m=0===d.activeSubscription.renew.status||1===d.activeSubscription.renew.status&&!(null===(t=d.activeSubscription)||void 0===t?void 0:t.rebillId),p=e=>{e.preventDefault(),O(_.LK_CLICK_MANAGE_ABONEMENT,B({userInfo:r,userSubscription:l,userAbonement:d})),s.push(c.ABONEMENT,void 0,{shallow:!0})},h="",b=[],x="";switch(d.status){case"active":h=o("Активен"),x=m?o("Закончится {date}",{date:u}):o("Продлим {date} за {price}",{date:u,price:null===(n=d.activeSubscription)||void 0===n?void 0:n.renew.price.toStringWithCurrency()}),b=[(0,f.jsx)(eD,{mode:"secondary",text:o("Управлять абонементом"),onClick:p},"button")];break;case"active_in_grace":h=o("Закончился"),x=o("Возобновите абонемент, чтобы вернуть доступ к каталогу и читать новые книги"),b=[(0,f.jsx)(eK,{},"payment"),(0,f.jsx)(eD,{mode:"tertiary",text:o("Управлять абонементом"),onClick:p,isLight:!0},"button")];break;default:h=o("Не подключен"),x=o("Получите доступ к каталогу из 800 000+ книг и читайте их одновременно без ограничений"),b=[(0,f.jsx)(eD,{mode:"secondary",text:o("Узнать подробности"),href:"/abonement/"},"button")]}return(0,f.jsx)(eI,{title:o("Абонемент"),description:x,actions:i?b:void 0,status:d.status,statusText:h})};var eQ=n(92911),e$=n.n(eQ);let eY=e=>(0,f.jsxs)("div",{className:N()(e$().cards,{[e$().cards_notActive]:!e.isActive}),children:[e.components.discountItems&&(0,f.jsx)("div",{className:e$().cards__discount,children:e.components.discountItems}),(0,f.jsx)("div",{className:e$().cards__list,children:e.components.cardItems})]}),eZ=e=>{var t;let{userSubscription:n,userAbonement:i,afterPaymentRedirectParams:o}=e,a=n.data.status,s=(null===(t=i.data)||void 0===t?void 0:t.status)||"off",{t:r}=(0,v.$G)();return(0,f.jsx)(eY,{isActive:!0,components:{discountItems:(0,f.jsxs)(f.Fragment,{children:[n.isSuccess&&"off"!==a&&(0,f.jsx)(eE,{active:"active"===a,text:r("-30% Читай-город")}),(n.isSuccess&&"off"!==a||i.isSuccess&&"off"!==s)&&(0,f.jsx)(eE,{active:[a,s].some(e=>"active"===e),text:r("до -30% Литрес")})]}),cardItems:(0,f.jsxs)(f.Fragment,{children:[n.isSuccess&&(0,f.jsx)(ez,{cameFromSourceForPaymentFrame:eN.l.userProfile,hasActions:!0,afterPaymentRedirectParams:o}),i.isSuccess&&"off"!==s&&(0,f.jsx)(eH,{hasActions:!0})]})}})};var eJ=n(73758);(a=d||(d={})).openMain="lk_open_main",a.openPayments="lk_open_payments",a.openPromotions="lk_open_promotions",a.openNotifications="lk_open_notifications",a.openSupport="lk_open_support",a.openExit="lk_open_exit",a.openEditAccount="lk_open_edit_account",a.openBonuses="lk_open_bonuses",a.promocodeAdded="lk_promocode_added",a.clickContactSupport="lk_click_contact_support",a.clickReadFaq="lk_click_read_faq",a.clickOpenAccount="lk_click_open_account",a.clickCloseAccount="lk_click_close_account",a.turnOnAdult="lk_turn_on_adult",a.turnOffAdult="lk_turn_off_adult",a.changeLanguageNotif="lk_change_language_notif",a.changeListNotif="lk_change_list_notif",a.clickLitresWallet="lk_click_litres_wallet",a.clickBonusCard="lk_click_bonus_card",a.clickMyLibraries="lk_click_my_libraries",a.clickBooksLibrary="lk_click_books_library",a.clickFondLibrary="lk_click_fond_library",a.clickReasonBanLibrary="lk_click_reason_ban_library",a.clickUnsubscribeLibrary="lk_click_unsubscribe_library",a.clickSubscribeOtherLibrary="lk_click_subscribe_other_library",a.clickCombineAccLibrary="lk_click_combine_acc_library",a.combinedAccLibrary="lk_combined_acc_library",a.clickPartnerStats="lk_click_partner_stats";let eX=e=>{eJ.TM.sendEvent(["LITRES_TRACKER"],{eventType:e.eventType,params:e.params})};var e0=n(52805),e1=n(46633),e3=n(43688),e4=n.n(e3);let e9=()=>{let{moneyToDisplay:e,analyticsParams:t}=F(),n=(0,y.CG)(e=>e.browser.headers["client-host"]),{i18n:i}=(0,v.$G)(),o=(0,h.useCallback)(()=>{(0,C.d8)("check_order_for_metric","new",{expires:1200}),eX({eventType:d.clickLitresWallet,params:t})},[]),{goToPayment:a,isGoingToNewPaymentFrame:s,paymentEntryPointControlRef:r}=(0,eL.o)({onGoingToPayment:o});return(0,f.jsxs)("div",{className:e4().litresAccount,onClick:a,children:[(0,C.aS)(e,(0,e0.zC)(n),i.language),(0,f.jsx)("button",{className:e4().litresAccount__button,disabled:s,children:(0,f.jsx)(E.uQ,{name:"addList",size:24})}),(0,f.jsx)(e1.o,{ref:r,cameFromSource:eN.l.userProfile})]})},e5=()=>{let{availableBonuses:e,fetchBonuses:t}=F();return(0,h.useEffect)(()=>{t()},[]),(0,f.jsxs)("div",{className:e4().profileBonuses,children:[e,(0,f.jsx)(E.uQ,{name:"bonusHeart",size:16})]})},e2=()=>{let{t:e}=(0,v.$G)();return(0,f.jsxs)("span",{title:e("Мои библиотеки"),className:e4().libraries,children:[(0,f.jsx)(E.uQ,{name:"libraryOutline",size:24,className:e4().libraries__icon}),e("Мои библиотеки"),(0,f.jsx)(E.uQ,{name:"chevronRight",size:24,className:e4().libraries__arrow})]})},e8=()=>{let{t:e}=(0,v.$G)();return(0,f.jsx)("span",{title:e("Стать автором Литрес"),className:e4().profileData__selfpub__title,children:e("Стать автором Литрес")})},e7=()=>{let{t:e}=(0,v.$G)();return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("span",{title:e("Абонемент"),className:e4().profileData__abonement__title,children:e("Абонемент")}),(0,f.jsx)(ew,{className:e4().status,status:"off",statusText:e("Не подключен")})]})};var e6=n(25868);let te=e6.uc.feature("UserGroupsError"),tt=()=>{let{t:e}=(0,v.$G)(),{analyticsParams:t}=F(),n=(0,y.CG)(e=>e.foundationUser.id),{data:i,error:o}=y.Df.useGetReferrerTypeQuery({referrer_id:n});return(0,h.useEffect)(()=>{o&&"status"in o&&(403===o.status||422===o.status)&&te("BackendInteractionError","Failed to fetch user groups (HTTP ".concat(o.status,")"),{originalError:o}).emit()},[o]),(0,f.jsxs)(S.Fg,{title:e("Статистика партнёра"),href:15===i||18===i?"/pages/show_reader_partner_stats/":"/company/partners/?new-terms-affiliate",onClick:()=>{eX({eventType:d.clickPartnerStats,params:t})},className:e4().partnerStats,children:[(0,f.jsx)(E.uQ,{name:"statistics",size:24,className:e4().libraries__icon}),(0,f.jsx)("span",{className:e4().profileData__partnerStats__title,children:e("Статистика партнёра")}),(0,f.jsx)(E.uQ,{name:"chevronRight",size:24,className:e4().libraries__arrow})]})},tn=()=>{var e;let{t}=(0,v.$G)(),n=(0,M.useRouter)(),i=J(),{isLibraryUser:o,isSchoolUser:a,isUserPhoneVerified:s,isReaderPartner:r,analyticsParams:l}=F(),{pushLocation:_}=sV(),u=(0,y.CG)(e=>e.browser.headers["client-host"]),m=(0,I.Z)(),p=(0,A.Z)(),h=p.isSuccess&&!(null===(e=p.data)||void 0===e?void 0:e.activeSubscription)&&!a&&(0,C.Ok)(u),b=!(0,C.Ok)(u),x=[{name:"litresAccount",description:t("Литрес Счёт"),component:(0,f.jsx)(e9,{})}];return(x.push({name:"bonusAccount",description:t("Бонусный счёт"),component:(0,f.jsx)(e5,{}),onClick:()=>{n.push("/me/bonuses/",void 0,{shallow:!0})}}),s||(x.pop(),x.push({name:"bonusAccountWithoutPhone",description:(0,f.jsx)("span",{className:e4().profileData__bonuses__description__text_blue,children:"Участвовать"}),component:(0,f.jsx)("span",{className:e4().profileData__bonuses__description__text_bold,children:"Бонусный счёт"}),onClick:()=>{n.push("/me/bonuses/",void 0,{shallow:!0})}})),b&&x.pop(),h&&x.push({name:"abonement",description:t("Скачать одну книгу из каталога до {price} и две из специальной подборки",{price:"700 ₽"}),component:(0,f.jsx)(e7,{}),onClick:()=>{n.push("/abonement/",void 0,{shallow:!0})}}),o&&x.push({name:"libraries",description:t("Ваши подключенные библиотеки в этом разделе"),component:(0,f.jsx)(e2,{}),onClick:e=>{eX({eventType:d.clickMyLibraries,params:l}),_(e,c.LIBRARIES)}}),x.push({name:"selfpub",description:t("Для тех, кто не только читает книги, но и пишет их"),component:(0,f.jsx)(e8,{}),onClick:()=>{window.open("https://selfpub.ru/?utm_source=litres&utm_medium=lk-button","_blank")}}),r&&x.push({name:"partnerStats",component:(0,f.jsx)(tt,{})}),m.isLoading||p.isLoading)?(0,f.jsx)(Q,{}):(0,f.jsx)("div",{className:N()(e4().wrapper,{[e4().wrapper_mobile]:i}),children:(0,f.jsxs)("div",{className:N()(e4().profileData,{[e4().profileData_withotBonuses]:b}),children:[(0,f.jsx)("div",{className:e4().profileData__alert,"data-testid":"profile__main--addPhoneAlert",children:(0,f.jsx)(ej,{})}),(m.isSuccess||p.isSuccess)&&(0,f.jsx)("div",{className:e4().profileData__subscription,"data-testid":"profile__mainSubscription--wrapper",children:(0,f.jsx)(eZ,{userSubscription:m,userAbonement:p,afterPaymentRedirectParams:{successRedirectUrl:c.SUBSCRIPTION,failRedirectUrl:c.PROFILE,backUrl:c.SUBSCRIPTION}})}),!a&&x.map(e=>(0,f.jsxs)(Z,{className:N()(e4().menuBlock,e4()["profileData__".concat(e.name)]),type:"selfpub"===e.name?"bordered-accent":"bordered",onClick:null==e?void 0:e.onClick,"data-testid":"profile__main--".concat(e.name),children:[(0,f.jsx)(Z.Title,{children:e.component}),e.description&&(0,f.jsx)("div",{className:e4().menuBlock__description,children:e.description})]},e.name))]})})},ti=e6.uc.feature("UserProfileEdit");var to=n(58119),ta=n(59193),ts=n.n(ta),tr=n.p+"static/media/noPhoto.f1d41efd.svg",tl=n(11735),t_=n(15927),tc=n(34871),td=n(73042),tu=n(19057),tm=n(63066),tp=n.n(tm);let tf=["jpg","jpeg","png","gif"],th=tf.map(e=>".".concat(e)).join(", "),tb=()=>{let{t:e}=(0,v.$G)(),t=(0,h.useRef)(null),n=(0,h.useRef)(null),{avatarURL:i,isSubscriptionActive:o}=F(),a=(0,y.CG)(e=>e.foundationUser.id),s=(0,to.n)(),[r,{isLoading:l}]=y.r7.useUpdateUserAvatarMutation(),_=(0,W.oh)({hasAvatar:!0,size:500,hash:"",imageURL:null!=i?i:"",defaultIcon:tr,shouldShowAvatar:!0,userId:a}),c=async n=>{try{let t=n.target.files;if(!t||1!==t.length){s({message:e("Пожалуйста, обновите страницу и попробуйте снова"),title:e("Произошла ошибка загрузки"),mode:"error",showIcon:!0});return}if(!tf.some(e=>t[0].type.includes(e))){s({message:e("Допустимые форматы для загрузки: gif, jpg, jpeg, png."),title:e("Недопустимый формат"),mode:"error",showIcon:!0});return}if(t[0].size>=3145728){s({message:e("Допустимый размер до 3 Mb."),title:e("Слишком большой размер картинки"),mode:"error",showIcon:!0});return}let i=await function(e){let t=new Image;return new Promise(n=>{t.src=URL.createObjectURL(e),t.addEventListener("load",()=>{n(t)}),t.addEventListener("error",()=>{n(null)})})}(t[0]);if(!i){s({message:e("Пожалуйста, обновите страницу и попробуйте снова"),title:e("Произошла ошибка загрузки"),mode:"error",showIcon:!0});return}if(i.height<40||i.width<40){s({message:e("Минимальный размер картинки 40x40px"),title:e("Слишком маленькая картинка"),mode:"error",showIcon:!0});return}let o=new FormData;o.append("avatar_file",t[0]),r(o).unwrap().then(()=>{s({message:e("Картинка обновится через несколько минут"),title:e("Фото профиля загружено"),mode:"success",showIcon:!0})}).catch(t=>{s({message:e("Пожалуйста, обновите страницу и попробуйте снова"),title:e("Произошла ошибка загрузки"),mode:"error",showIcon:!0}),ti("BackendInteractionError","setProfileAvatarBackendError",t).emit()})}finally{t.current&&(t.current.value="")}};return(0,f.jsxs)("div",{className:tp().avatar,children:[(0,f.jsx)("div",{className:N()(ts().block__avatar,ts().block__avatar_large,{[ts().block__avatar_subscr]:o}),children:(0,f.jsx)("div",{className:N()(ts().block__avatar__img,ts().block__avatar__img_large),children:l?(0,f.jsx)("div",{className:tp().avatar__loader,children:(0,f.jsx)(V.$,{})}):(0,f.jsx)("img",{src:_,alt:"User Picture",ref:n,onError:()=>{n.current&&(n.current.src=tr)}})})}),(0,f.jsx)("button",{type:"button",className:tp().avatar__button,onClick:()=>{t.current&&t.current.click()},disabled:l,children:e("Изменить аватар")}),(0,f.jsx)("input",{accept:th,style:{display:"none"},type:"file",ref:t,onChange:c})]})};var tx=n(17792),tv=n.n(tx),tg=n(76996),tj=n(9381),tN=n(26183),ty=n(1653);let tk=()=>{var e,t,n,i,o,a,s,r,l,_;let{t:c}=(0,v.$G)(),d=(0,h.useRef)(null),u=(0,h.useRef)(null),m=(0,h.useRef)(null),p=(0,h.useRef)(null),b=(0,to.n)(),{data:x}=y.r7.useGetFoundationUserDetailedInfoQuery(),[g,{isLoading:j}]=y.r7.useUpdateUserInfoMutation(),{control:N,formState:{isValid:k,dirtyFields:E,isDirty:S},handleSubmit:P,setError:w,reset:T}=(0,tg.cI)({defaultValues:{nickname:null!==(s=null==x?void 0:null===(e=x.profile)||void 0===e?void 0:e.nickname)&&void 0!==s?s:"",first_name:null!==(r=null==x?void 0:null===(t=x.profile)||void 0===t?void 0:t.first_name)&&void 0!==r?r:"",last_name:null!==(l=null==x?void 0:null===(n=x.profile)||void 0===n?void 0:n.last_name)&&void 0!==l?l:"",birthday:(null==x?void 0:null===(i=x.profile)||void 0===i?void 0:i.birthday)?function(e){let t=(0,tl.D)(e);return(0,t_.J)(t)?(0,tc.WU)(t,"dd.MM.yyyy"):void 0}(null==x?void 0:null===(o=x.profile)||void 0===o?void 0:o.birthday):"",description:null!==(_=null==x?void 0:null===(a=x.profile)||void 0===a?void 0:a.description)&&void 0!==_?_:void 0},mode:"onChange"});return x?(0,f.jsxs)("form",{className:tp().form,onSubmit:P(e=>{var t,n,i,o;let a={first_name:null===(t=e.first_name)||void 0===t?void 0:t.trim(),last_name:null===(n=e.last_name)||void 0===n?void 0:n.trim(),nickname:null===(i=e.nickname)||void 0===i?void 0:i.trim(),description:null===(o=e.description)||void 0===o?void 0:o.trim(),birthday:e.birthday?function(e){let t=(0,td.Qc)(e,"dd.MM.yyyy",new Date);return(0,t_.J)(t)?(0,tu.c)(t,{representation:"date"}):void 0}(e.birthday):void 0};g(a).unwrap().then(()=>{var t,n,i,o,s,r,l,_;d.current&&(null===(t=d.current)||void 0===t||t.setValue(null!==(n=a.first_name)&&void 0!==n?n:"")),m.current&&(null===(i=m.current)||void 0===i||i.setValue(null!==(o=a.nickname)&&void 0!==o?o:"")),u.current&&(null===(s=u.current)||void 0===s||s.setValue(null!==(r=a.last_name)&&void 0!==r?r:"")),p.current&&(null===(l=p.current)||void 0===l||l.setValue(null!==(_=a.description)&&void 0!==_?_:"")),T({...a,birthday:e.birthday})}).catch(e=>{b({message:c("Пожалуйста, попробуйте позже"),title:c("Ошибка сервера"),mode:"error",showIcon:!0}),ti("BackendInteractionError","setProfileAvatarBackendError",e).emit()})}),children:[(0,f.jsx)(tg.Qr,{control:N,name:"first_name",rules:{maxLength:{value:50,message:c("Вы превысили лимит в 50 символов. Сократите текст и попробуйте снова.")},validate:e=>{var t;return void 0===e||""===e||(null==x?void 0:null===(t=x.profile)||void 0===t?void 0:t.first_name)===e||!!(null==e?void 0:e.trim())||c("Поле не может содержать только пробелы.")}},render:e=>{var t;let{field:n,fieldState:i}=e;return(0,f.jsx)(ty.F5,{...n,ref:e=>{n.ref(e),d.current=e},controlMode:ty.S1.text,disabled:j,wrapperCustomClassName:tp().form__input_firstName,placeholder:c("Имя"),error:null===(t=i.error)||void 0===t?void 0:t.message})}}),(0,f.jsx)(tg.Qr,{control:N,name:"nickname",rules:{maxLength:{value:50,message:c("Вы превысили лимит в 50 символов. Сократите текст и попробуйте снова.")},validate:e=>{var t;return void 0===e||""===e||(null==x?void 0:null===(t=x.profile)||void 0===t?void 0:t.nickname)===e||!!(null==e?void 0:e.trim())||c("Поле не может содержать только пробелы.")}},render:e=>{var t;let{field:n,fieldState:i}=e;return(0,f.jsx)(ty.F5,{...n,ref:e=>{n.ref(e),m.current=e},controlMode:ty.S1.text,disabled:j,wrapperCustomClassName:tp().form__input_nickname,placeholder:c("Никнейм"),error:null===(t=i.error)||void 0===t?void 0:t.message})}}),(0,f.jsx)(tg.Qr,{control:N,name:"last_name",rules:{maxLength:{value:50,message:c("Вы превысили лимит в 50 символов. Сократите текст и попробуйте снова.")},validate:e=>{var t;return void 0===e||""===e||(null==x?void 0:null===(t=x.profile)||void 0===t?void 0:t.last_name)===e||!!(null==e?void 0:e.trim())||c("Поле не может содержать только пробелы.")}},render:e=>{var t;let{field:n,fieldState:i}=e;return(0,f.jsx)(ty.F5,{...n,ref:e=>{n.ref(e),u.current=e},controlMode:ty.S1.text,disabled:j,wrapperCustomClassName:tp().form__input_lastName,placeholder:c("Фамилия"),error:null===(t=i.error)||void 0===t?void 0:t.message})}}),(0,f.jsx)(tg.Qr,{control:N,rules:{required:{value:!!x.profile.birthday,message:c("Поле обязательно для заполнения")},validate:e=>{if(!e&&!x.profile.birthday)return!0;if(!e)return!1;let t=(0,td.Qc)(e,"dd.MM.yyyy",new Date);return(0,t_.J)(t)?!((0,tj.A)(t)||(0,tN.R)(t,new Date("1899-12-31")))||(w("birthday",{type:"invalid_date",message:c("Введенная дата рождения некорректна. Пожалуйста, укажите реальную дату.")}),!1):(w("birthday",{type:"not_valid_date",message:c("Укажите дату рождения в формате дд.мм.гггг")}),!1)}},name:"birthday",render:e=>{let{field:t,fieldState:n}=e;return(0,f.jsx)(tv(),{...t,mask:"99.99.9999",className:tp().form__input_birthday,disabled:j,children:e=>{var t;return(0,f.jsx)(ty.F5,{...e,controlMode:ty.S1.text,disabled:j,placeholder:c("Дата рождения"),error:null==n?void 0:null===(t=n.error)||void 0===t?void 0:t.message})}})}}),(0,f.jsx)(tg.Qr,{control:N,name:"description",rules:{maxLength:{value:100,message:c("Вы превысили лимит в 100 символов. Сократите текст и попробуйте снова.")}},render:e=>{let{field:t}=e;return(0,f.jsx)(ty.F5,{...t,ref:e=>{t.ref(e),p.current=e},controlMode:ty.S1.multiline,disabled:j,wrapperCustomClassName:tp().form__input_description,placeholder:c("О себе"),maxLength:100,symbolsCounter:!0})}}),(0,f.jsx)(eA.z,{className:tp().form__button,size:"medium",mode:"primary",text:c("Сохранить изменения"),type:"submit",loading:j,disabled:j||!k||!S&&!Object.keys(E).length})]}):null};var tE=n(51640);let tS=e=>{let{onChange:t}=e,n=(0,y.TL)(),{t:i}=(0,v.$G)(),o=(0,to.n)(),{data:a}=y.r7.useGetFoundationUserDetailedInfoQuery(),[s,{isLoading:r}]=y.r7.useSetPrivacyMutation();if(!a)return null;let l="public"===a.settings.profile_privacy;return(0,f.jsxs)("div",{className:tp().switcher,children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("h3",{className:tp().switcher__title,children:i("Открыть информацию")}),(0,f.jsx)("p",{className:tp().switcher__text,children:i("Пользователи Литрес увидят ваше фото и имя")})]}),(0,f.jsx)(tE.T,{disabled:r,checked:l,onChange:()=>{let e=l?"closed":"public",a=n(y.r7.util.updateQueryData("getFoundationUserDetailedInfo",void 0,t=>{Object.assign(t,{settings:{...t.settings,profile_privacy:e}})}));s({profile_privacy:e}).unwrap().then(()=>{null==t||t(l),n(y.hi.foundationUser.setFoundationUserAccountSettings({profile_privacy:e}))}).catch(e=>{a.undo(),o({message:i("Пожалуйста, попробуйте позже"),title:i("Ошибка сервера"),mode:"error",showIcon:!0}),ti("BackendInteractionError","setProfileAvatarBackendError",e).emit()})}})]})},tP=e=>{let{onChange:t,onError:n}=e,i=(0,y.TL)(),{t:o}=(0,v.$G)(),{data:a}=y.r7.useGetFoundationUserDetailedInfoQuery(),[s,{isLoading:r}]=y.r7.useSetSafemodeMutation();if(!a)return null;let l=!!a.settings.is_safemode_enabled;return(0,f.jsxs)("div",{className:tp().switcher,"data-testid":"profile__restcrictAdultContent--wrapper",children:[(0,f.jsxs)("div",{children:[(0,f.jsx)("h3",{className:tp().switcher__title,children:o("Ограничить взрослый контент")}),(0,f.jsx)("p",{className:tp().switcher__text,children:o("Скрыть книги с элементами эротики с главной страницы, из популярного и новинок")})]}),(0,f.jsx)(tE.T,{disabled:r,checked:l,onChange:()=>{var e;let o=i((e=!l,y.r7.util.updateQueryData("getFoundationUserDetailedInfo",void 0,t=>{Object.assign(t,{settings:{...t.settings,is_safemode_enabled:e}})})));s({is_safemode_enabled:!l}).unwrap().then(()=>{null==t||t(l)}).catch(e=>{o.undo(),null==n||n(),ti("BackendInteractionError","setProfileSafemodeBackendError",e).emit()})}})]})},tw=()=>{let{t:e}=(0,v.$G)(),{analyticsParams:t,userId:n}=F(),i=(0,to.n)();return(0,f.jsxs)("div",{className:tp().container,"data-testid":"profile__edit--wrapper",children:[(0,f.jsx)(tb,{}),(0,f.jsx)(tk,{}),(0,f.jsx)(tS,{onChange:e=>{eX({eventType:e?d.clickCloseAccount:d.clickOpenAccount,params:t})}}),(0,f.jsx)(tP,{onChange:e=>{eX({eventType:e?d.turnOnAdult:d.turnOffAdult,params:t})},onError:()=>{i({message:e("Пожалуйста, попробуйте позже"),title:e("Ошибка сервера"),mode:"error",showIcon:!0})}}),(0,f.jsxs)("div",{className:tp().text,children:[e("Ваш клиентский ID:")," ",n]})]})};var tT=n(4031),tC=n(76791),tI=n(72835),tA=n(53899),tR=n.n(tA);let tO=()=>{let{t:e}=(0,v.$G)();return(0,f.jsx)("div",{className:tR().error,children:(0,f.jsx)(tI.u,{title:e("Ошибка загрузки данных"),mainButton:{label:e("Обновить"),onClick:()=>{window.location.reload()}},children:e("Попробуйте обновить страницу или вернитесь позже.")})})};var tD=n(75978),tL=n(58689);let tB=()=>{let{t:e}=(0,v.$G)(),{data:t}=(0,I.Z)(),n=(0,y.TL)(),{data:i,isError:o}=new tD.$(n).useAllUserSavedPaymentMethodsQuery(Object.values(tL.X8).map(Number)),a=(0,h.useMemo)(()=>i.find(e=>e.savedPaymentMethodId===t.rebillId),[i,t.rebillId]),s="working",r=e(t.isAutoRenewAvailable?"У вас привязана банковская карта и продление подписки произойдет по плану":"Включите продление, чтобы списание произошло по плану");return t.rebillId||(s="none",r=e("Привяжите карту, чтобы вовремя продлить подписку и не потерять накопленную скидку")),t.isInGracePeriod&&(s="not_working",r=e(t.rebillId?"Возможно, на карте недостаточно средств. Пополните её или привяжите другую карту и подписка возобновится автоматически.":"Привяжите карту, чтобы продлить подписку")),o&&(s="error",r=e("Ошибка получения способов оплаты")),("AppStore"===t.purchaseOrigin||"Google Play"===t.purchaseOrigin)&&(s="app",r=e("Подписка была подключена через {name}. Вы можете продлить подписку либо через приложение {name}, либо через официальный сайт {name}.",{name:t.purchaseOrigin})),{linkedPaymentMethodStatusText:r,linkedPaymentMethodStatus:s,linkedPaymentMethodInfo:a}},tG=e=>{let{data:t}=(0,I.Z)();return(0,f.jsx)(eY,{isActive:"active"==t.status,components:{cardItems:(0,f.jsx)(ez,{cameFromSourceForPaymentFrame:eN.l.userProfileSubscription,hasActions:!1,afterPaymentRedirectParams:e.afterPaymentRedirectParams})}})},tF={send:{clickProlong:function(e){R.TM.sendEvent(["LITRES_TRACKER"],{eventType:_.LK_PROLONG_SUBSCRIPTION,params:{source_internal:(0,C.bu)(),rate:eM.DV[e]}})},clickChooseBook:function(e){R.TM.sendEvent(["LITRES_TRACKER"],{eventType:_.LK_CHOOSE_CLICK,params:{source_internal:(0,C.bu)(),rate:eM.DV[e]}})}}};var tM=n(18183),tW=n(13801),tU=n.n(tW);let tq=e=>{let{date:t}=e,{t:n}=(0,v.$G)();if(null==t)return null;let i=t.toLocaleDateString(null===v.ag||void 0===v.ag?void 0:v.ag.language,{month:"long",day:"numeric"});return(0,f.jsx)("div",{className:N()(tU().renewAtBlock,tU().renewAtBlock_autoRenew),children:(0,f.jsx)("p",{className:tU().renewAtBlock__text,children:n("{date} вам станет доступна новая книга.",{date:i})})})};var tz=n(39737),tV=n(35713),tK=n(2598);(s=u||(u={}))[s.OFF=0]="OFF",s[s.ON=1]="ON";let tH=e=>{let{newStatus:t,offerId:n,shouldBindCardBeforeRenew:i,linkedPaymentMethodStatus:o,goToPayment:a}=e,{t:s}=(0,v.$G)(),r=(0,to.n)(),l=(0,h.useRef)(null),[_,{isLoading:c}]=y.kS.useCancelSubscriptionProductMutation(),{refetch:d}=y.Bh.useGetUserSubscriptionsInfoQuery(null),u=async()=>{let e=await _({id:n,new_auto_renew_status:t});if((0,tK.$)(e)||i&&"error"===o){r({mode:"error",message:t?s("Не смогли включить продление. Повторите попытку или попробуйте позже"):s("Не смогли отключить продление. Повторите попытку или попробуйте позже"),alignElRef:l});return}if(i){a();return}d()};return{buttonRef:l,isLoading:c,handleClickByAutoRenewButton:u}},tQ=e=>{let{userSubscription:t}=e,{t:n}=(0,v.$G)(),{linkedPaymentMethodStatus:i}=tB(),o=t.checkIfBoughtByApp(),{goToPayment:a,isGoingToNewPaymentFrame:s,paymentEntryPointControlRef:r}=(0,eL.o)(),{handleClickByAutoRenewButton:l,buttonRef:_}=tH({newStatus:u.ON,offerId:t.id,shouldBindCardBeforeRenew:!!("not_working"===i||"none"===i),linkedPaymentMethodStatus:i,goToPayment:a}),d=(0,h.useMemo)(()=>(0,tV.i)(t),[t]);return(0,f.jsx)("div",{className:tU().renewAtBlock,children:(0,f.jsx)("p",{className:tU().renewAtBlock__text,children:o?n("Вы сможете получить книгу, если продлите подписку."):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(v.cC,{i18nKey:"Вы сможете получить книгу, если <button>продлите подписку</button>.",defaults:"Вы сможете получить книгу, если <button>продлите подписку</button>.",components:{button:(0,f.jsx)("button",{type:"submit",className:tU().renewLink,onClick:()=>{t.plan&&tF.send.clickProlong(t.plan),l()},disabled:s,ref:_})}}),"none"===i&&(0,f.jsx)(tz.I,{ref:r,offerId:t.id,mode:"subscription",cameFromSource:eN.l.userProfileSubscription,afterPaymentRedirectParams:{successRedirectUrl:c.SUBSCRIPTION,failRedirectUrl:c.PROFILE,backUrl:c.SUBSCRIPTION}}),"not_working"===i&&(0,f.jsx)(eB.Y,{selectedSubscriptionClass:d,ref:r,cameFromSource:eN.l.userProfileSubscription,afterPaymentRedirectParams:{successRedirectUrl:c.SUBSCRIPTION,failRedirectUrl:c.PROFILE,backUrl:c.SUBSCRIPTION},isShowingSubscriptionPlans:!0})]})})})},t$=e=>{let{userSubscription:t,amountAvailableArts:n,renewAt:i}=e;return n>0?null:t.isAutoRenewAvailable&&!t.isInGracePeriod?(0,f.jsx)(tq,{date:i}):(0,f.jsx)(tQ,{userSubscription:t})};var tY=n(23901),tZ=n.n(tY);let tJ=()=>{let e=(0,M.useRouter)(),{t}=(0,v.$G)(),{data:n}=(0,I.Z)();if(null==n.availableArts)return null;let{amount:i,maxPrice:o,renewAt:a}=n.availableArts;return(0,f.jsx)("section",{className:tZ().root,children:(0,f.jsxs)("div",{className:tZ().wrapper,children:[(0,f.jsx)(t$,{userSubscription:n,amountAvailableArts:i,renewAt:a}),(0,f.jsx)(tM.X,{subtitle:t("Книга до {price} навсегда",{price:o.toStringWithCurrency()}),description:t("Одна любая электронная или аудиокнига до {price} из самого большого каталога в России",{price:o.toStringWithCurrency()}),availableBooksText:"Доступно книг:",handleClick:()=>{n.plan&&tF.send.clickChooseBook(n.plan),e.push("/popular/?only_litres_bookshelf_subscription_token_arts=1")},amount:i,shouldShowActions:!0})]})})};var tX=n(67752),t0=n(24661),t1=n.n(t0);let t3=e=>{let{text:t}=e;return(0,f.jsx)("p",{className:t1().errorMsg,children:t})};var t4=n(87205);let t9=()=>{let{data:e}=(0,I.Z)();return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(t2,{}),(0,f.jsx)(tX.I,{discounts:e.cumulativeDiscountList}),(0,f.jsx)(t5,{})]})},t5=()=>{let{t:e}=(0,v.$G)(),{data:t}=(0,I.Z)();return"active"===t.status?(0,f.jsx)(f.Fragment,{}):(0,f.jsx)(t3,{text:e("Скидка действует и растёт только пока подписка активна непрерывно. После отключения накопленный прогресс сбросится.")})},t2=()=>{let{t:e}=(0,v.$G)();return(0,f.jsx)(t4.v,{text:e("Накапливаемая скидка на покупку книг, которые не входят в подписку")})};t9.Disclaimer=t5,t9.Description=t2;var t8=n.p+"static/media/discount.1125489d.png";let t7=()=>(0,f.jsx)(v.cC,{i18nKey:"Действует для всех участников  <br/> <linkTag>единой программы лояльности Книголов.</linkTag>",components:{linkTag:(0,f.jsx)(S.Fg,{href:"/me/bonuses/",target:"_blank"}),br:(0,f.jsx)("br",{})}});var t6=n(74462);let ne=e=>{let{size:t="medium",className:n}=e,{t:i}=(0,v.$G)(),[o,a]=(0,h.useState)(!1);return(0,f.jsxs)("div",{className:n,children:[(0,f.jsx)(eA.z,{size:t,mode:"secondary",text:i("Как воспользоваться?"),fullWidth:!0,onClick:()=>{a(!0)}}),o&&(0,f.jsx)(t6.d,{isModalOpen:o,onClose:()=>{a(!1)}})]})};var nt=n(21042),nn=n.n(nt);let ni=()=>(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(ne,{size:"medium",className:nn().paperDiscount__button}),(0,f.jsx)("div",{className:nn().paperDiscount__description,children:(0,f.jsx)(t7,{})}),(0,f.jsx)(ne,{size:"small",className:nn().paperDiscount__button_small}),(0,f.jsx)("div",{className:nn().paperDiscount__image,children:(0,f.jsx)("img",{src:t8,alt:"paper discount"})})]});ni.Text=t7,ni.Info=ne;var no=n(35014);let na=e=>{let{buttonClassName:t,disclaimerClassName:n}=e,{t:i}=(0,v.$G)(),o=(0,M.useRouter)(),{goToPayment:a,isGoingToNewPaymentFrame:s,paymentEntryPointControlRef:r}=(0,eL.o)(),{data:l}=(0,I.Z)(),{refetch:d}=y.Bh.useGetUserSubscriptionsInfoQuery(null),{linkedPaymentMethodStatus:m}=tB(),p="Web"!==l.purchaseOrigin||s,b="AppStore"===l.purchaseOrigin||"Google Play"===l.purchaseOrigin,x=!!(("not_working"===m||"none"===m)&&!l.isAutoRenewAvailable),g=(0,no.U)()&&l.isTrialPeriod,{isLoading:j,handleClickByAutoRenewButton:N,buttonRef:k}=tH({newStatus:u.ON,offerId:l.id,shouldBindCardBeforeRenew:x,linkedPaymentMethodStatus:m,goToPayment:a});return(0,h.useEffect)(()=>{let e=new URL(location.href);e.searchParams.has("no-survey")&&(O(_.SUBSCRIPTION_AUTO_RENEWAL_CANCEL,{source_internal:(0,C.bu)()}),e.searchParams.delete("no-survey"),o.replace("".concat(e.pathname).concat(e.search),void 0,{shallow:!0}),d())},[o,d]),(0,f.jsxs)(f.Fragment,{children:[l.isAutoRenewAvailable?(0,f.jsx)(eA.z,{size:"medium",mode:"tertiary",text:i(g?"Остановить пробный период":"Отключить продление"),disabled:p,className:t,onClick:()=>{p||(O(_.PROFILE_CLICK_CANCEL_SUBSCRIPTION,{monetization_type:"subscription"}),o.push("/subscription-cancel-survey/?redirect_url=/me/subscription/"))}}):(0,f.jsx)(eA.z,{ref:k,size:"medium",mode:"tertiary",text:i("Включить продление"),onClick:()=>{O(_.SUBSCRIPTION_AUTO_RENEWAL_ACCOUNT,{source_internal:(0,C.bu)()}),N()},loading:j,disabled:p,className:t}),b?!l.isActiveInGracePeriod&&(0,f.jsx)("div",{className:n,children:i(l.isAutoRenewAvailable?"Подписка была подключена через {name}. Вы можете отменить подписку либо через приложение {name}, либо через официальный сайт {name}.":"Подписка была подключена через {name}. Вы можете продлить подписку либо через приложение {name}, либо через официальный сайт {name}.",{name:l.purchaseOrigin})}):(0,f.jsxs)(f.Fragment,{children:["none"===m&&(0,f.jsx)(tz.I,{ref:r,offerId:l.id,mode:"subscription",cameFromSource:eN.l.userProfileSubscription,afterPaymentRedirectParams:{successRedirectUrl:c.SUBSCRIPTION,failRedirectUrl:c.PROFILE,backUrl:c.SUBSCRIPTION}}),"not_working"===m&&l.promotedSubscriptionClass&&(0,f.jsx)(eB.Y,{selectedSubscriptionClass:l.promotedSubscriptionClass,cameFromSource:eN.l.userProfileSubscription,ref:r,afterPaymentRedirectParams:{successRedirectUrl:c.SUBSCRIPTION,failRedirectUrl:c.PROFILE,backUrl:c.SUBSCRIPTION}})]})]})};var ns=n(87956),nr=n(5320),nl=n(30536),n_=n.n(nl);let nc=e=>{let{shouldDisplayBrand:t,className:n,savedPaymentMethodInfo:i}=e;return(0,f.jsxs)("div",{className:N()(n_().root,n),children:[(0,f.jsx)(tT.J,{...i.getIconParams("small"),className:n_().root__icon}),(0,f.jsx)("div",{className:n_().root__text,children:t&&(0,f.jsx)(nd,{savedPaymentMethodInfo:i})}),(0,f.jsx)("span",{className:n_().root__label,title:i.getLabel(),children:i.getLabel()})]})},nd=e=>{let{savedPaymentMethodInfo:t}=e;return(0,nr.mg)(t)&&t.info.brand!==ns.Y.Unknown?(0,f.jsx)("span",{className:n_().brand,children:t.info.brand}):(0,nr.fG)(t)?(0,f.jsx)("span",{className:n_().brand,children:"PayPal"}):null};var nu=n(80053),nm=n.n(nu);let np=()=>{let{t:e}=(0,v.$G)(),{data:t}=y.r7.useGetFoundationUserDetailedInfoQuery(),{data:n}=(0,I.Z)(),{data:i}=(0,A.Z)(),{goToPayment:o,isGoingToNewPaymentFrame:a,paymentEntryPointControlRef:s}=(0,eL.o)(),r=()=>{O(_.LK_CLICK_ADD_CARD_SUBSCRIPTION,B({userInfo:t,userSubscription:n,userAbonement:i})),o()},{linkedPaymentMethodStatus:l,linkedPaymentMethodStatusText:d,linkedPaymentMethodInfo:u}=tB();return"app"===l?(0,f.jsx)("div",{className:nm().payment,children:(0,f.jsx)("div",{className:nm().payment__text,children:d})}):"error"===l?(0,f.jsx)("div",{className:nm().payment,children:(0,f.jsx)("div",{className:nm().payment__error,children:(0,f.jsx)(ee.b,{mode:ee.p.error,children:d})})}):(0,f.jsxs)("div",{className:nm().payment,children:[(0,f.jsx)("div",{className:nm().payment__text,children:d}),"none"===l?(0,f.jsx)(eA.z,{mode:"primary",size:"medium",text:e("Привязать"),fullWidth:!0,onClick:r,loading:a,className:nm().payment__button}):u&&(0,f.jsxs)("div",{className:nm().payment__card,children:[(0,f.jsx)(nc,{savedPaymentMethodInfo:u}),(0,f.jsx)(eA.z,{onClick:r,disabled:a,size:"small",mode:"tertiary",icon:(0,f.jsx)(E.uQ,{name:"editPencil",size:16}),text:e("Изменить"),className:nm().payment__card__editBtn})]}),"not_working"===l&&(0,f.jsx)(eF,{buttonText:e("Продлить сейчас за {summ}",{summ:n.prolongPrice.toStringWithCurrency()}),buttonClass:nm().payment__button,buttonMode:"primary",afterPaymentRedirectParams:{successRedirectUrl:c.SUBSCRIPTION,failRedirectUrl:c.PROFILE,backUrl:c.SUBSCRIPTION},cameFromSourceForPaymentFrame:eN.l.userProfileSubscription}),(0,f.jsx)(tz.I,{ref:s,offerId:n.id,mode:"subscription",cameFromSource:eN.l.userProfileSubscription,afterPaymentRedirectParams:{successRedirectUrl:c.SUBSCRIPTION,failRedirectUrl:c.PROFILE,backUrl:c.SUBSCRIPTION}})]})};var nf=n(88396),nh=n(59992),nb=n(75999),nx=n.n(nb);function nv(e){let{planId:t}=e;return t?(0,f.jsx)("div",{className:nx().subtitle,children:(0,f.jsx)(v.cC,{i18nKey:(0,nh.mU)(t),components:{strongTag:(0,f.jsx)("span",{})}})}):(0,f.jsx)("div",{className:nx().subtitle,children:nf.MJ})}let ng=()=>{let{t:e}=(0,v.$G)(),t=(0,M.useRouter)(),{data:n}=y.r7.useGetFoundationUserDetailedInfoQuery(),{data:i}=(0,I.Z)(),{data:o}=(0,A.Z)();return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(nv,{planId:i.plan}),(0,f.jsx)(eA.z,{mode:"primary",size:"medium",text:e("Перейти к книгам"),fullWidth:!0,className:nx().button,disabled:"active"!==i.status,onClick:()=>{O(_.LK_CLICK_BOOK_SUBSCRIPTION,B({userInfo:n,userSubscription:i,userAbonement:o})),"active"===i.status&&t.push("/popular/?only_litres_subscription_arts=true")}}),"active"!==i.status&&(0,f.jsx)("div",{className:nx().errorMsg,children:e("Продлите подписку, чтобы выбирать новые книги")})]})};var nj=n(28206),nN=n(42146),ny=n.n(nN);let nk=e=>{let{isSubscribedToWink:t,isInGracePeriod:n,userPhone:i}=e;return n?(0,f.jsx)(nS,{}):(0,f.jsx)(nE,{isSubscribedToWink:t,userPhone:i})},nE=e=>{let{isSubscribedToWink:t,userPhone:n}=e,i=null==n?void 0:n.number,o=null==n?void 0:n.is_confirmed,[a,s]=(0,h.useState)(!i),[r,l]=(0,h.useState)(!1),_=nj.w.SUBSCRIBE_WINK;return a&&(_=nj.w.ADDED_PHONE_NUMBER),t&&(_=nj.w.WATCH_WINK),(0,h.useEffect)(()=>{r&&eJ.TM.sendEvent(["LITRES_TRACKER"],{eventType:"view_wink_offer",params:{source_internal:"subscription"}}),s(!i||!o)},[r,i,o]),(0,f.jsxs)(f.Fragment,{children:[t&&(0,f.jsxs)("div",{className:ny().wink__activated,children:["Успешно подключено"," ",(0,f.jsx)(E.uQ,{name:"checkbox",size:16,className:ny().wink__activated_icon})]}),(0,f.jsx)(nP,{}),(0,f.jsx)(eA.z,{mode:t?"secondary":"primary",size:"medium",text:t?"Как воспользоваться?":"Подключить бесплатно",onClick:()=>{eJ.TM.sendEvent(["LITRES_TRACKER"],{eventType:"click_wink_add",params:{source_internal:"subscription"}}),l(!0)},fullWidth:!0}),r&&(0,f.jsx)(nj._,{isModalOpen:r,onClose:()=>{l(!1)},initialStep:_,shouldReloadPageAfterSuccess:!0})]})},nS=()=>(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(nP,{}),(0,f.jsx)(eA.z,{mode:"secondary",disabled:!0,size:"medium",text:"Подключить бесплатно",fullWidth:!0}),(0,f.jsx)("p",{className:ny().errorMsg,children:"Продлите подписку, чтобы смотреть Wink"})]}),nP=()=>(0,f.jsxs)("ol",{className:ny().wink__benefits,children:[(0,f.jsx)("li",{children:"Более 130 ТВ-каналов"}),(0,f.jsx)("li",{children:"Тысячи фильмов и сериалов на любой вкус"})]});var nw=n(82333),nT=n.n(nw);(r=m||(m={})).SUBSCRIPTION="subscription",r.ABONEMENT="abonement";let nC=e=>{let{mode:t}=e,{t:n}=(0,v.$G)();return(0,f.jsxs)("div",{className:nT().switcher,children:[(0,f.jsx)(k.Z,{className:N()(nT().switcher__button,{[nT().switcher__button_active]:"subscription"===t}),href:c.SUBSCRIPTION,children:n("Подписка")}),(0,f.jsx)(k.Z,{className:N()(nT().switcher__button,{[nT().switcher__button_active]:"abonement"===t}),href:c.ABONEMENT,children:n("Абонемент")})]})},nI=(e,t)=>{let n=(0,M.useRouter)(),i=q((0,y.CG)(e=>e.browser.headers["client-host"]));(0,h.useEffect)(()=>{!t&&e&&"off"===e.status&&n.push(i[0],void 0,{shallow:!0})},[e,n,t])};var nA=n(96842),nR=n.n(nA);let nO=()=>{let{t:e}=(0,v.$G)(),t=(0,M.useRouter)(),n=J(),{data:i}=y.r7.useGetFoundationUserDetailedInfoQuery(),{linkedPaymentMethodStatus:o}=tB(),{data:a,isError:s,isLoading:r}=(0,I.Z)(),l=(0,A.g)(),_=(0,h.useRef)("1"===t.query.wink_sub_lk),c=(0,tC.bi)("wink_sub_lk","1"),d=_.current||c,u=!!(null==i?void 0:i.is_wink_subscriber),p=a.checkIfOneMonthTariff();return(nI(a.loaded?a:null),s)?(0,f.jsx)(tO,{}):r?(0,f.jsx)(Q,{}):(0,f.jsxs)("div",{className:N()(nR().subscriptionPage,nR()["subscriptionPage_".concat(a.status)],nR()["subscriptionPage_rebill_".concat(o)],{[nR().subscriptionPage_mobile]:n,[nR().subscriptionPage_winkActivated]:u}),"data-testid":"profile__subscription--wrapper",children:[n&&"off"!==a.status&&l.activeSubscription&&(0,f.jsx)("div",{className:N()(nR().subscriptionPage__switcher,nR().subscriptionPage__widget),children:(0,f.jsx)(nC,{mode:m.SUBSCRIPTION})}),(0,f.jsx)("div",{className:N()(nR().subscriptionPage__subscriptionBlock,nR().subscriptionPage__widget),children:(0,f.jsx)(tG,{})}),d&&p&&(0,f.jsxs)(Z,{type:"filled",className:N()(nR().subscriptionPage__wink,nR().subscriptionPage__widget),children:[(0,f.jsx)(Z.Title,{children:(0,f.jsx)(tT.J,{name:"wink",path:"loyalty",width:"72"})}),(0,f.jsx)(nk,{isSubscribedToWink:u,isInGracePeriod:a.isInGracePeriod,userPhone:null==i?void 0:i.phone})]}),(0,f.jsxs)(Z,{type:"filled",className:N()(nR().subscriptionPage__chooseBooks,nR().subscriptionPage__widget),"data-testid":"profile__subscription--chooseBooks",children:[(0,f.jsx)(Z.Title,{children:e("Входит в вашу подписку")}),(0,f.jsx)(ng,{}),(0,f.jsx)(tJ,{})]}),(0,f.jsxs)(Z,{type:"filled",className:N()(nR().subscriptionPage__displayDiscount,nR().subscriptionPage__widget),children:[(0,f.jsx)(Z.Title,{children:e("Дольше подписка — больше скидка")}),(0,f.jsx)(t9,{})]}),"active"===a.status&&(0,f.jsxs)(Z,{type:"filled",className:N()(nR().subscriptionPage__paperDiscount,nR().subscriptionPage__widget),children:[(0,f.jsx)(Z.Title,{children:e("Скидка до 30% на бумажные книги")}),(0,f.jsx)(ni,{})]}),("Web"===a.purchaseOrigin||a.isInGracePeriod)&&(0,f.jsx)(nD,{}),(0,f.jsx)("div",{className:nR().subscriptionPage__autoRenew,children:(0,f.jsx)(na,{disclaimerClassName:nR().description})})]})},nD=()=>{let{t:e}=(0,v.$G)();return(0,f.jsxs)(Z,{type:"filled",className:N()(nR().subscriptionPage__payment,nR().subscriptionPage__widget),children:[(0,f.jsx)(Z.Title,{children:e("Способ оплаты")}),(0,f.jsx)(np,{})]})},nL=()=>{var e,t;let{t:n}=(0,v.$G)(),i=(0,A.g)(),o=i.activeSubscription.checkIfBoughtByApp(),a=(0,y.TL)(),{data:s,isError:r}=new tD.$(a).useAllUserSavedPaymentMethodsQuery(Object.values(tL.X8).map(Number)),l=(0,h.useMemo)(()=>s.find(e=>e.savedPaymentMethodId===i.activeSubscription.rebillId),[s,i.activeSubscription.rebillId]),_="working",c=n(i.activeSubscription.renew.status?"У вас привязана банковская карта и продление абонемента произойдет по плану":"Включите продление, чтобы списание произошло по плану");return(null===(e=i.activeSubscription)||void 0===e?void 0:e.rebillId)||(_="none",c=n("Привяжите карту, чтобы вовремя продлить абонемент и не потерять накопленную скидку")),i.activeSubscription.gracePeriod.isActive&&(_="not_working",c=n((null===(t=i.activeSubscription)||void 0===t?void 0:t.rebillId)?"Возможно, на карте недостаточно средств. Пополните её или привяжите другую карту и абонемент возобновится автоматически.":"Привяжите карту, чтобы продлить абонемент")),r&&(_="error",c=n("Ошибка получения способов оплаты")),o&&(_="app",c=n("Абонемент был подключен через {name}. Вы можете продлить абонемент либо через приложение {name}, либо через официальный сайт {name}.",{name:i.activeSubscription.getCurrentPurchaseOriginName()})),{linkedPaymentMethodStatusText:c,linkedPaymentMethodStatus:_,linkedPaymentMethodInfo:l}},nB=e=>{let{hasActions:t}=e,n=(0,A.g)();return(0,f.jsx)(eY,{isActive:"active"==n.status,components:{cardItems:(0,f.jsx)(eH,{hasActions:!!t})}})},nG=e=>{var t;let{userAbonement:n}=e,{t:i}=(0,v.$G)(),o=(null===(t=n.data)||void 0===t?void 0:t.status)||"off";return(0,f.jsx)(eY,{isActive:!0,components:{discountItems:n.isSuccess&&"off"!==o&&(0,f.jsx)(eE,{active:"active"===o,text:i("до -30% Литрес")}),cardItems:(0,f.jsx)(f.Fragment,{children:n.isSuccess&&"off"!==o&&(0,f.jsx)(eH,{hasActions:!0})})}})},nF=e=>{let{newStatus:t,offerId:n,shouldBindCardBeforeRenew:i,linkedPaymentMethodStatus:o,goToPayment:a}=e,{t:s}=(0,v.$G)(),r=(0,to.n)(),l=(0,h.useRef)(null),[_,{isLoading:c}]=y.kS.useCancelSubscriptionProductMutation(),{refetch:d}=y.ce.useGetUserAbonementInfoQuery(null),u=async()=>{let e=await _({id:n,new_auto_renew_status:t});if((0,tK.$)(e)||i&&"error"===o){r({mode:"error",message:t?s("Не смогли включить продление. Повторите попытку или попробуйте позже"):s("Не смогли отключить продление. Повторите попытку или попробуйте позже"),alignElRef:l});return}if(i){"not_working"===o&&(0,C.m8)({abonement_ref_url:window.location.href}),a();return}d()};return{buttonRef:l,isLoading:c,handleClickByAutoRenewButton:u}};var nM=n(23340),nW=n(50307),nU=n(71995),nq=n.n(nU);let nz=()=>{var e;let{t,i18n:n}=(0,v.$G)(),{activeSubscription:i}=(0,A.g)(),{linkedPaymentMethodStatus:o}=nL(),a=i.arts.renewAt.toLocaleDateString(n.language,{month:"long",day:"numeric"}),s=(null===(e=i.getActiveCumulativeDiscount())||void 0===e?void 0:e.value)||0,r=i.arts.specialSetArts||0,l=i.checkIfBoughtByApp(),{goToPayment:d,isGoingToNewPaymentFrame:u,paymentEntryPointControlRef:m}=(0,eL.o)(),{handleClickByAutoRenewButton:p,buttonRef:h}=nF({newStatus:nM.h2.ON,offerId:i.offerId,shouldBindCardBeforeRenew:!!("not_working"===o||"none"===o),linkedPaymentMethodStatus:o,goToPayment:d});return i.arts.anyArts.amount>0||r>0?(0,f.jsx)("h3",{className:nq().title,children:t("Используйте ваш абонемент")}):i.renew.status&&!i.gracePeriod.isActive?(0,f.jsx)("div",{className:N()(nq().renewAtBlock,nq().renewAtBlock_autoRenew),children:(0,f.jsx)("p",{className:nq().renewAtBlock__text,children:t("{date} вам станут доступны новые три книги и скидка {discount}% на весь каталог.",{date:a,discount:s})})}):(0,f.jsx)("div",{className:nq().renewAtBlock,children:(0,f.jsx)("p",{className:nq().renewAtBlock__text,children:l?t("{date} вам станут доступны новые три книги и скидка {discount}% на весь каталог, если вы продлите абонемент",{date:a,discount:s}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(v.cC,{i18nKey:"{date} вам станут доступны новые три книги и скидка {discount}% на весь каталог, если вы <button>продлите абонемент</button>",defaults:"{date} вам станут доступны новые три книги и скидка {discount}% на весь каталог, если вы <button>продлите абонемент</button>",values:{date:a,discount:s},components:{button:(0,f.jsx)("button",{type:"submit",className:nq().renewLink,onClick:()=>{O(_.ABONEMENT_AUTO_RENEWAL_ACCOUNT,{source_internal:(0,C.bu)()}),p()},disabled:u,ref:h})}}),"none"===o&&("RU"===i.country?(0,f.jsx)(tz.I,{ref:m,offerId:i.offerId,mode:"abonement",cameFromSource:eN.l.userProfileAbonement,afterPaymentRedirectParams:{successRedirectUrl:c.ABONEMENT,failRedirectUrl:c.PROFILE,backUrl:c.ABONEMENT}}):(0,f.jsx)(nW.n,{ref:m,offerId:i.offerId})),"not_working"===o&&(0,f.jsx)(eV.i,{ref:m,cameFromSource:eN.l.userProfileAbonement})]})})})};var nV=n(68021);let nK=()=>{let{t:e}=(0,v.$G)(),t=(0,M.useRouter)(),{data:n}=y.r7.useGetFoundationUserDetailedInfoQuery(),{data:i}=(0,I.Z)(),o=(0,A.g)(),a=o.activeSubscription.arts,s=a.anyArts.amount||0,r=a.anyArts.maxPrice.toStringWithCurrency();return(0,f.jsx)(tM.X,{className:nq().anyArts,subtitle:e("Книга до {price}",{price:r}),description:e("Одна любая электронная или аудиокнига до {price} из самого большого каталога в России",{price:r}),availableBooksText:"Доступно книг:",handleClick:()=>{O(_.LK_CLICK_BOOK_ABONEMENT,B({userInfo:n,userSubscription:i,userAbonement:o,extra:{available_book_in_abonement:s}})),t.push("/popular/?only_abonement_arts=true")},amount:s,shouldShowActions:!0})},nH=()=>{let{t:e}=(0,v.$G)(),t=(0,M.useRouter)(),{data:n}=y.r7.useGetFoundationUserDetailedInfoQuery(),{data:i}=(0,I.Z)(),o=(0,A.g)(),a=o.activeSubscription.arts,s=(null==a?void 0:a.specialSetArts)||0,r="PL"===o.activeSubscription.country?nV.ps:nV.sm,{data:l}=y.Wo.useGetCollectionQuery({collectionIdOrSlug:r});return(0,f.jsx)(tM.X,{subtitle:e("Персональная подборка"),description:(null==l?void 0:l.url)?(0,f.jsx)(v.cC,{i18nKey:'Книги на выбор из <a href="{url}">персональной подборки</a>',defaults:'Книги на выбор из <a href="{url}">персональной подборки</a>',values:{url:null==l?void 0:l.url},components:{a:(0,f.jsx)(S.Fg,{})}}):e("Книги на выбор из персональной подборки"),availableBooksText:"Доступно книг:",handleClick:()=>{O(_.LK_CLICK_PERSONAL_SELECTION_ABONEMENT,B({userInfo:n,userSubscription:i,userAbonement:o,extra:{available_in_selection_abonement:s}})),(null==l?void 0:l.url)&&t.push(null==l?void 0:l.url)},amount:s,shouldShowActions:!0})},nQ=()=>(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(nz,{}),(0,f.jsx)(nK,{}),(0,f.jsx)(nH,{})]}),n$=()=>{let{activeSubscription:e}=(0,A.g)();return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(nZ,{}),(0,f.jsx)(tX.I,{discounts:e.cumulativeDiscountList}),e.gracePeriod.isActive&&(0,f.jsx)(nY,{})]})},nY=()=>{let{t:e}=(0,v.$G)();return(0,f.jsx)(t3,{text:e("Скидка действует и растёт только пока абонемент активен непрерывно. После отключения накопленный прогресс сбросится.")})},nZ=()=>{let{t:e}=(0,v.$G)();return(0,f.jsx)(t4.v,{text:e("Накапливаемая скидка на покупку книг, которые не входят в абонемент")})};n$.Disclaimer=nY,n$.Description=nZ;let nJ=e=>{let{buttonClassName:t,disclaimerClassName:n}=e,{t:i}=(0,v.$G)(),o=(0,A.g)(),{linkedPaymentMethodStatus:a}=nL(),{goToPayment:s,isGoingToNewPaymentFrame:r,paymentEntryPointControlRef:l}=(0,eL.o)(),d=o.activeSubscription.getCurrentPurchaseOriginName(),u=o.activeSubscription.checkIfBoughtByApp(),m=!!(("not_working"===a||"none"===a)&&!o.activeSubscription.renew.status),p=o.activeSubscription.purchaseOrigin!==nM.ti.WEB||r,{isLoading:h,handleClickByAutoRenewButton:b,buttonRef:x}=nF({newStatus:o.activeSubscription.renew.status?nM.h2.OFF:nM.h2.ON,offerId:o.activeSubscription.offerId,shouldBindCardBeforeRenew:m,linkedPaymentMethodStatus:a,goToPayment:s});return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(eA.z,{ref:x,size:"medium",mode:"tertiary",text:i(o.activeSubscription.renew.status?"Отключить продление":"Включить продление"),loading:h,onClick:()=>{o.activeSubscription.renew.status?O(_.ABONEMENT_AUTO_RENEWAL_CANCEL,{source_internal:(0,C.bu)()}):O(_.ABONEMENT_AUTO_RENEWAL_ACCOUNT,{source_internal:(0,C.bu)()}),b()},disabled:p,className:t,e2eId:o.activeSubscription.renew.status?"disable__renewal--button":"enable__renewal--button"}),u?!o.activeSubscription.gracePeriod.isActive&&(0,f.jsx)("div",{className:n,children:i(o.activeSubscription.renew.status?"Абонемент был подключен через {name}. Вы можете отменить абонемент либо через приложение {name}, либо через официальный сайт {name}.":"Абонемент был подключен через {name}. Вы можете продлить абонемент либо через приложение {name}, либо через официальный сайт {name}.",{name:d})}):(0,f.jsxs)(f.Fragment,{children:["none"===a&&("RU"===o.activeSubscription.country?(0,f.jsx)(tz.I,{ref:l,offerId:o.activeSubscription.offerId,mode:"abonement",cameFromSource:eN.l.userProfileAbonement,afterPaymentRedirectParams:{successRedirectUrl:c.ABONEMENT,failRedirectUrl:c.PROFILE,backUrl:c.ABONEMENT}}):(0,f.jsx)(nW.n,{ref:l,offerId:o.activeSubscription.offerId})),"not_working"===a&&(0,f.jsx)(eV.i,{ref:l,cameFromSource:eN.l.userProfileAbonement})]})]})};var nX=n(91270),n0=n(21232),n1=n(52601),n3=n.n(n1);function n4(){let{data:e,isFetching:t,isLoading:n,isError:i}=y.RQ.useGetAbonementExclusivesQuery({limit:10});return{exclusivesArts:e,isFetching:t,isLoading:n,isError:i}}let n9=()=>{let{t:e}=(0,v.$G)(),t=(0,nX.useSelector)(e=>e.browser.pda),{exclusivesArts:n,isLoading:i}=n4(),o=(null==n?void 0:n.total_count)||0;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:n3().description,children:e("Книги, которые сейчас доступны только владельцам Абонемента")}),(0,f.jsx)(n0.p,{isPDA:t,isSkeleton:o>0&&i,data:null==n?void 0:n.data,noTitle:!0,customCoverHeight:150}),(0,f.jsx)("div",{className:n3().link,children:(0,f.jsx)(k.I,{href:"/pages/subscription_only_11/",children:e("Все")})})]})};var n5=n(30219),n2=n.n(n5);let n8=()=>{let{t:e}=(0,v.$G)(),{data:t}=y.r7.useGetFoundationUserDetailedInfoQuery(),{data:n}=(0,I.Z)(),i=(0,A.g)(),{goToPayment:o,isGoingToNewPaymentFrame:a,paymentEntryPointControlRef:s}=(0,eL.o)(),r=()=>{O(_.LK_CLICK_ADD_CARD_ABONEMENT,B({userInfo:t,userSubscription:n,userAbonement:i})),o()},{linkedPaymentMethodStatus:l,linkedPaymentMethodStatusText:d,linkedPaymentMethodInfo:u}=nL();return"app"===l?(0,f.jsx)("div",{className:n2().payment,children:(0,f.jsx)("div",{className:n2().payment__text,children:d})}):"error"===l?(0,f.jsx)("div",{className:n2().payment,children:(0,f.jsx)("div",{className:n2().payment__error,children:(0,f.jsx)(ee.b,{mode:ee.p.error,children:d})})}):(0,f.jsxs)("div",{className:n2().payment,children:[(0,f.jsx)("div",{className:n2().payment__text,children:d}),"none"===l?(0,f.jsx)(eA.z,{mode:"primary",size:"medium",text:e("Привязать"),fullWidth:!0,onClick:r,loading:a,className:n2().payment__button}):u&&(0,f.jsxs)("div",{className:n2().payment__card,children:[(0,f.jsx)(nc,{savedPaymentMethodInfo:u}),(0,f.jsx)(eA.z,{onClick:r,disabled:a,size:"small",mode:"tertiary",icon:(0,f.jsx)(E.uQ,{name:"editPencil",size:16}),text:e("Изменить"),className:n2().payment__card__editBtn})]}),"not_working"===l?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(eA.z,{mode:"primary",size:"medium",text:e("Продлить сейчас за {summ}",{summ:i.activeSubscription.renew.price.toStringWithCurrency()}),fullWidth:!0,onClick:()=>{O(_.LK_CLICK_PAY_ABONEMENT,B({userInfo:t,userSubscription:n,userAbonement:i})),(0,C.m8)({abonement_ref_url:window.location.href}),o()},loading:a,disabled:a,className:n2().payment__button}),(0,f.jsx)(eV.i,{ref:s,cameFromSource:eN.l.userProfileAbonement})]}):"RU"===i.activeSubscription.country?(0,f.jsx)(tz.I,{ref:s,offerId:i.activeSubscription.offerId,mode:"abonement",cameFromSource:eN.l.userProfileAbonement,afterPaymentRedirectParams:{successRedirectUrl:c.ABONEMENT,failRedirectUrl:c.PROFILE,backUrl:c.ABONEMENT}}):(0,f.jsx)(nW.n,{ref:s,offerId:i.activeSubscription.offerId})]})};var n7=n(21622),n6=n.n(n7);let ie=()=>{let{data:e,isError:t}=(0,A.Z)();return(nI(e),null==e?void 0:e.isActive)?(0,f.jsx)(it,{}):t?(0,f.jsx)(tO,{}):(0,f.jsx)(Q,{})},it=()=>{let e=J(),{t}=(0,v.$G)(),{activeSubscription:n}=(0,A.g)(),{linkedPaymentMethodStatus:i}=nL(),{data:o}=(0,I.Z)();return(0,f.jsxs)("div",{className:N()(n6().abonementPage,{[n6().abonementPage_active]:!n.gracePeriod.isActive},n6()["abonementPage_rebill_".concat(i)],{[n6().abonementPage_mobile]:e}),children:[e&&"off"!==o.status&&n&&(0,f.jsx)("div",{className:N()(n6().abonementPage__switcher,n6().abonementPage__widget),children:(0,f.jsx)(nC,{mode:m.ABONEMENT})}),(0,f.jsx)("div",{className:N()(n6().abonementPage__abonementBlock,n6().abonementPage__widget),children:(0,f.jsx)(nB,{})}),(0,f.jsx)(Z,{type:"filled",className:N()(n6().abonementPage__abonementAvailableArts,n6().abonementPage__widget),children:(0,f.jsx)(nQ,{})}),(0,f.jsxs)(Z,{type:"filled",className:N()(n6().abonementPage__displayDiscount,n6().abonementPage__widget),children:[(0,f.jsx)(Z.Title,{children:t("Дольше абонемент — больше скидка")}),(0,f.jsx)(n$,{})]}),(0,f.jsx)(ii,{}),(n.purchaseOrigin===nM.ti.WEB||n.gracePeriod.isActive)&&(0,f.jsx)(io,{}),(0,f.jsx)("div",{className:n6().abonementPage__autoRenew,children:(0,f.jsx)(nJ,{disclaimerClassName:n6().description})})]})},ii=()=>{let{t:e}=(0,v.$G)(),{exclusivesArts:t,isError:n}=n4();return n||!((null==t?void 0:t.data)&&((null==t?void 0:t.data.length)>0||(null==t?void 0:t.total_count)>0))?null:(0,f.jsxs)(Z,{type:"filled",className:N()(n6().abonementPage__abonementExclusives,n6().abonementPage__widget),children:[(0,f.jsx)(Z.Title,{children:e("Эксклюзивно в абонементе")}),(0,f.jsx)(n9,{})]})},io=()=>{let{t:e}=(0,v.$G)();return(0,f.jsxs)(Z,{type:"filled",className:N()(n6().abonementPage__payment,n6().abonementPage__widget),children:[(0,f.jsx)(Z.Title,{children:e("Способ оплаты")}),(0,f.jsx)(n8,{})]})};var ia=n(59497),is=n(16896),ir=n(1774);let il=em()(()=>Promise.all([n.e(5394),n.e(8993),n.e(1183),n.e(1578)]).then(n.bind(n,91578)),{loadableGenerated:{webpack:()=>[91578]},ssr:!1,loading:ef}),i_=em()(()=>n.e(4573).then(n.bind(n,74573)),{loadableGenerated:{webpack:()=>[74573]},ssr:!1,loading:ef}),ic=em()(()=>Promise.all([n.e(6700),n.e(8993),n.e(4283)]).then(n.bind(n,4283)),{loadableGenerated:{webpack:()=>[4283]},ssr:!1,loading:ef}),id=em()(()=>n.e(3155).then(n.bind(n,23155)),{loadableGenerated:{webpack:()=>[23155]},ssr:!1,loading:ef}),iu=em()(()=>Promise.all([n.e(8993),n.e(2106),n.e(1183),n.e(4169),n.e(2127)]).then(n.bind(n,42127)),{loadableGenerated:{webpack:()=>[42127]},ssr:!1,loading:ef}),im=em()(()=>Promise.all([n.e(4169),n.e(8602)]).then(n.bind(n,84169)),{loadableGenerated:{webpack:()=>[84169]},ssr:!1,loading:ef});var ip=n(13886),ih=n.n(ip);let ib=e=>{let{text:t,isForMobileAndTablet:n}=e;return(0,f.jsx)("span",{className:N()(ih().credentialPlaceholder,{[ih().credentialPlaceholder_desktop]:!n,[ih().credentialPlaceholder_mobileOrTablet]:n}),children:t})},ix=(e,t)=>e&&t?"tertiary":"secondary",iv=e=>{if(11!==e.length)return e;{let t=e.slice(0,1),n=e.slice(1,4),i=e.slice(4,7),o=e.slice(9);return"".concat(t," ").concat(n," ").concat(i," ").concat("**"," ").concat(o)}};var ig=n(42161),ij=n.n(ig);let iN=e=>{let{value:t,type:n,isConfirmed:i,getActionButtonOnClickHandler:o}=e,{t:a}=(0,v.$G)();return(0,f.jsx)(eA.z,{className:ij().credentialButton,mode:ix(t,i),size:"small",fullWidth:!0,onClick:o(n),text:a(t?i?"Изменить":"Подтвердить":"Добавить"),e2eId:t?i?"profile__".concat(n,"Change--button"):"profile__".concat(n,"Confirm--button"):"profile__".concat(n,"Add--button")})};var iy=n(46735),ik=n.n(iy);let iE={phoneModifying:[eh,eb],phoneVerifying:[ex],passwordEditing:[iu,im],emailModifying:[il,i_],emailVerifying:[ic,id]},iS=()=>{let{t:e}=(0,v.$G)(),{phoneNumber:t,isPhoneNumberConfirmed:n,email:i,isEmailConfirmed:o}=(0,ev.P)(),a=(0,h.useMemo)(()=>[{type:"email",label:e("Почта"),value:i,isConfirmed:o,notConfirmedMessage:e("не подтверждена"),addTextDescriptionMobileAndTablet:e("Добавьте почту"),addTextDescriptionDesktop:e("Добавьте почту, защитите аккаунт")},{type:"phone",label:e("Телефон"),value:iv(t||""),isConfirmed:n,notConfirmedMessage:e("не подтвержден"),addTextDescriptionMobileAndTablet:e("Добавьте телефон"),addTextDescriptionDesktop:e("Добавьте телефон, защитите аккаунт")},{type:"password",label:e("Пароль"),value:"********",isConfirmed:!0,notConfirmedMessage:null}],[i,o,t,n]),[s,r]=(0,X.e)(ed),l=()=>{r("MODIFY_PHONE")},_=()=>{r("VERIFY_PHONE")},c=()=>{(0,is.RX)({scenario:"edit",type:"password",authMethodStatus:"verified"}),r("EDIT_PASSWORD")},d=()=>{r("MODIFY_EMAIL")},u=()=>{r("VERIFY_EMAIL")},m=()=>{let e=(0,ir.T)(t,n),i=(0,ir.S)(t,n);(0,is.RX)({scenario:e,type:"phone",authMethodStatus:i}),("verify"===e?_:l)()},p=()=>{let e=(0,ir.T)(i,o),t=(0,ir.S)(i,o);(0,is.RX)({scenario:e,type:"email",authMethodStatus:t}),("verify"===e?u:d)()},b=()=>{r("CLOSE_MODAL")},x=e=>"phone"===e?m:"password"===e?c:"email"===e?p:C.ZT,[g,j]=iE[s.value]||[()=>null,()=>null];return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(ia.K,{children:(0,f.jsx)(en.J,{children:(0,f.jsx)(et.zU,{name:"credentials",children:j?(0,f.jsx)(j,{onClose:b,switchToEmailEditing:d,children:(0,f.jsx)(g,{})}):(0,f.jsx)(g,{onClose:b})})})}),(0,f.jsx)("div",{className:ik().credentials,children:a.map(e=>{let{type:t,label:n,value:i,isConfirmed:o,notConfirmedMessage:a,addTextDescriptionMobileAndTablet:s,addTextDescriptionDesktop:r}=e;return(0,f.jsxs)("div",{className:ik().credentials__item,children:[(0,f.jsx)("div",{className:ik().credentials__contentWrapper,children:(0,f.jsxs)("div",{className:ik().credentials__content,children:[(0,f.jsx)("div",{className:ik().credentials__label,children:n}),(0,f.jsxs)("div",{className:N()(ik().textContent,{[ik().credentials__textContent_pale]:!i}),"data-testid":"profile__".concat(t,"Credentials--placeholder"),children:[i?(0,f.jsx)("span",{className:ik().credentials__value,children:i}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(ib,{text:s,isForMobileAndTablet:!0}),(0,f.jsx)(ib,{text:r,isForMobileAndTablet:!1})]}),i&&!o&&(0,f.jsx)("span",{className:N()(ik().credentials__verification,ik().credentials__verification_notVerified),children:a})]})]})}),(0,f.jsx)(iN,{type:t,value:i,isConfirmed:o,getActionButtonOnClickHandler:x},t)]},t)})})]})};iS.Alert=e=>{let{className:t}=e,{t:n}=(0,v.$G)(),{isUserFullyVerified:i}=(0,ev.P)(),o=i?ee.p.safe:ee.p.info;return(0,f.jsx)("div",{className:t,children:(0,f.jsx)(ee.b,{mode:o,children:n(i?"Ваши данные надежно защищены":"Заполните контактные данные, чтобы вернуть доступ, если что-то случится")})})},iS.Info=e=>{let{className:t}=e,{t:n}=(0,v.$G)();return(0,f.jsx)("p",{className:t,children:n("Электронная почта, номер телефона и социальные сети нужны для входа на сайт и восстановления пароля")})};let iP=e=>{var t;return null!==(t=({SocialUserAlreadyExists:"Аккаунт уже привязан к другому пользователю",SocialProviderNotAvailableException:"Вход через социальную сеть недоступен",RequestParamValidationError:"Техническая ошибка",PermissionMissingError:"Техническая ошибка",NoAlternateLoginMethodError:"Невозможно удалить единственный способ входа"})[e])&&void 0!==t?t:"Техническая ошибка"},iw=()=>{let[e,t]=(0,h.useState)({}),[n,,i]=(0,W.y$)("authInfo",null,"session");return(0,h.useEffect)(()=>{n&&(t(n),i())},[n]),e};var iT=n(72227);let iC={sb:"sberid",vk:"vk",vkid:"vk",gp:"google",ya:"yandex",ma:"mailru",ok:"ok",apple:"apple",ap:"apple"},iI=()=>{let[e,t]=(0,h.useState)(!1),[n]=y.iJ.useDisconnectSocialNetworkMutation(),[i,o]=(0,h.useState)([]),a=e=>{o(t=>[...t,e])},s=e=>{o(t=>t.filter(t=>t!==e))};return{disconnectingNetworks:i,onNetworkDisconnection:(e,i,o)=>{a(e),n(iC[e]).unwrap().then(i).catch(e=>{var n,i;let{status:a,data:s}=e;o({status:a,type:null==s?void 0:null===(n=s.error)||void 0===n?void 0:n.type}),400===a&&(null==s?void 0:null===(i=s.error)||void 0===i?void 0:i.type)==="NoAlternateLoginMethodError"&&t(!0)}).finally(()=>{s(e)})},hasNoAlternativeAuthMethodsError:e}},iA=["google","gp","vk","vkid","ok","ya","ma","sb","ap","apple"],iR=["facebook","fb","tw","x","apple","ap"],iO=()=>{let e=(0,y.CG)(e=>e.foundationUser.socials.map(e=>{let{provider_code:t}=e;return t}).map(e=>"vk"===e?"vkid":e).map(e=>"ap"===e?"apple":e).filter(e=>iA.includes(e))),{data:t=[],error:n}=y.iJ.useGetAvailableSocialNetworksQuery(),[i,o]=(0,h.useState)(e),{onNetworkDisconnection:a,disconnectingNetworks:s,hasNoAlternativeAuthMethodsError:r}=iI(),l=(0,h.useCallback)(e=>{let t="https://".concat(window.location.host,"/auth_proxy/?origin=").concat(encodeURIComponent(window.location.href),"&network=").concat("vk"===e?"vkid":e,"&authenticated=true");window.open(t,"_self")},[]),_=(0,h.useCallback)((e,t,n)=>{a(e,()=>{t(),o(t=>t.filter(t=>t!==e))},e=>{let{status:t,type:i}=e;n({status:t,type:i})})},[o,a]),c=(0,h.useMemo)(()=>{let e=new Map(t.filter(e=>{let{provider:t}=e;return!iR.includes(t)}).map(e=>{let{provider:t}=e;return[t,{provider_code:t,isConnected:!1}]}));return i.forEach(t=>{let n=e.get(t)||{provider_code:t};e.set(t,{...n,isConnected:!0})}),Array.from(e.values())},[t,i]);return(0,h.useEffect)(()=>{n&&(0,iT.N)("BackendInteractionError","UserCredentialsPage Error during loading allowed social networks",{originalError:n}).emit()},[n]),{socialNetworks:c,disconnectingNetworks:s,hasNoAlternativeAuthMethodsError:r,connectNetwork:l,disconnectNetwork:_}};var iD=n(94407),iL=n.n(iD);let iB={vk:"VK ID",vkid:"VK ID",gp:"Google",ma:"Mail.ru",ya:"Яндекс",sb:"Сбер ID",ok:"Одноклассники",apple:"Apple ID",ap:"Apple ID"},iG=()=>{let{t:e}=(0,v.$G)(),{errorType:t,erroredNetwork:n,authorizedNetwork:i}=iw(),{socialNetworks:o,disconnectingNetworks:a,hasNoAlternativeAuthMethodsError:s,disconnectNetwork:r,connectNetwork:l}=iO();(0,h.useEffect)(()=>{n&&t&&(0,is.Fj)("edit_auth_info_fail",{type:n,scenario:"add",error:iP(t)}),i&&(0,is.Fj)("edit_auth_info_success",{type:i,scenario:"add"})},[t,n,i]);let _=e=>{(0,is.RX)({scenario:"delete",type:e}),r(e,()=>{(0,is.Fj)("edit_auth_info_success",{type:e,scenario:"delete"})},t=>{let{type:n}=t;(0,is.Fj)("edit_auth_info_fail",{type:e,scenario:"delete",error:iP(n)})})},c=e=>{(0,is.RX)({scenario:"add",type:e}),l(e)};return(0,f.jsx)(en.J,{children:o.map(i=>{let{provider_code:o,isConnected:r}=i,l=r?e("Удалить"):e("Добавить"),d=r?_:c,u=e(iB[o]);return(0,f.jsxs)("div",{className:iL().networkItemWrapper,children:[(0,f.jsxs)("div",{className:iL().networkItem,children:[(0,f.jsx)("div",{children:(0,f.jsxs)("div",{className:iL().networkItem__iconWrapper,children:[(0,f.jsx)(tT.J,{path:"socialNetworks",name:o,width:"32",height:"32",className:iL().networkItem__icon}),(0,f.jsx)("div",{className:iL().networkItem__nameBonus,children:(0,f.jsx)("span",{className:iL().networkItem__networkName,children:u})})]})}),(0,f.jsx)("div",{className:iL().bonusWrapper,children:(0,f.jsx)(eA.z,{className:iL().addNetwork,mode:r?"tertiary":"secondary",size:"small",text:l,onClick:()=>{d(o)},loading:a.includes(o)})})]}),t&&n===o&&(0,f.jsx)("div",{className:iL().networkItemWrapper__restrictedLabel,children:e("Аккаунт уже привязан к другому пользователю")}),s&&r&&(0,f.jsx)("div",{className:iL().networkItemWrapper__restrictedLabel,children:e("Вы не можете удалить единственный способ входа. Добавьте альтернативный.")})]},o)})})};iG.Info=e=>{let{className:t}=e,{t:n}=(0,v.$G)();return(0,f.jsx)("p",{className:t,children:n("Подключайте социальные сети для лёгкого входа на сайт и в приложения Литрес")})};var iF=n(52234),iM=n.n(iF);let iW=()=>{var e;let{t}=(0,v.$G)(),{isSchoolUser:n}=F(),i=(0,y.CG)(e=>e.browser.headers["client-host"]),o=(0,A.Z)(),a=(0,C.LS)(i)&&(null===(e=o.data)||void 0===e?void 0:e.status)!=="off";return(0,f.jsxs)("div",{className:iM().credentials,"data-testid":"profile__entery--wrapper",children:[a&&(0,f.jsx)("div",{className:iM().credentials__abonementBlock,children:(0,f.jsx)(nG,{userAbonement:o})}),(0,f.jsxs)("div",{className:iM().credentials__userInfo,children:[(0,f.jsx)(iS.Info,{className:iM().credentials__info}),(0,f.jsx)(iS.Alert,{}),(0,f.jsx)("h3",{className:iM().credentials__title,children:t("Личная информация")}),(0,f.jsx)(iS,{})]}),!n&&(0,C.Ok)(i)&&(0,f.jsxs)("div",{className:iM().credentials__socialNetworks,children:[(0,f.jsx)("h3",{className:iM().credentials__title,children:t("Социальные сети")}),(0,f.jsx)(iG.Info,{className:iM().credentials__info}),(0,f.jsx)(iG,{})]})]})};var iU=n(57628);let iq=[{title:"Наши предложения",data:[{title:"Подписка",text:"<p>Подписка — это простой способ читать больше, практически без ограничений. Вы получаете доступ к огромному каталогу книг и можете слушать и читать их одновременно без ограничений по количеству. <a href='https://litres.helpdeskeddy.com/ru/knowledge_base/cat/112/podpiska' target='_blank'>Подробнее о подписке</a></p>"},{title:"Абонемент",component:(0,f.jsx)(()=>{let{t:e}=(0,v.$G)(),{data:{abonement:t}={}}=y.r7.useGetFoundationUserDetailedInfoQuery(),n=e=>{e.stopPropagation()};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("p",{children:e("Абонемент предоставляет возможность выгодно приобретать книги на нашем сервисе. За {price} рублей в месяц вам доступно:",{price:null==t?void 0:t.default_abonement_month_price})}),(0,f.jsxs)("ol",{children:[(0,f.jsx)("li",{children:e("Выбор электронной или аудиокниги из платного каталога с базовой стоимостью до 700 рублей (включительно).")}),(0,f.jsx)("li",{children:(0,f.jsx)(v.cC,{i18nKey:"Получение двух книг на выбор из <linkTag>специальной подборки</linkTag>",components:{linkTag:(0,f.jsx)(k.I,{href:"/collections/knigi-v-podarok-ot-litres/",target:"_blank",onClick:n})}})}),(0,f.jsx)("li",{children:(0,f.jsx)(v.cC,{i18nKey:"Растущая <linkTag>скидка</linkTag> на весь каталог Литрес.",components:{linkTag:(0,f.jsx)(k.I,{href:"https://litres.helpdeskeddy.com/ru/knowledge_base/art/598/cat/113/",target:"_blank",onClick:n})}})})]}),(0,f.jsx)(S.Fg,{href:"https://litres.helpdeskeddy.com/ru/knowledge_base/cat/113/abonement",target:"_blank",onClick:n,children:e("Подробнее об Абонементе")})]})},{})},{title:"Кэшбэк за покупку книг",text:"<p>Мы часто проводим совместные акции с разными партнерами, участвуя в которых можно получить кэшбэк на счет вашего аккаунта Литрес.</p>"},{title:"Скидка 20% на вторую покупку",text:"<p>После покупки одной книги с ее карточки или из корзины у вас есть возможность приобрести электронные или аудиокниги со скидкой 20%.</p><p>Обратите внимание: скидка действует только на сайте и доступна 15 минут после покупки.</p> <a href='https://litres.helpdeskeddy.com/ru/knowledge_base/art/823/cat/86/skidka-20-na-vtoruju-pokupku' target='_blank'>Полные условия акции</a>"}]},{title:"Промокоды",data:[{title:"Где взять промокод?",text:"<p>Промокоды Литрес на скидки и подарки вы можете увидеть в рекламе, получить в рассылках и на сайтах партнеров Литрес и даже найти в упаковках товаров.</p>"},{title:"Как выбрать книгу после активации промокода на сайте?",text:"<p>Некоторые промокоды позволяют выбрать одну или несколько книг из специальной подборки. Если после активации промокода вы закрыли эту подборку, то можете вернуться к ней позже в разделе Мои книги > Мои акции</p>"}]},{title:"Скачивание книг",data:[{title:"В каких форматах я могу скачивать текстовые книги?",text:"<p>Большинство электронных текстовых книг представлены для скачивания в самых распространенных форматах: FB2, EPUB, PDF, RTF, TXT и так далее.</p><p>Доступные форматы указаны на карточке книги под ценником в разделе Описание книги.</p><p>Для некоторых книг может быть доступен только один формат, например, PDF или EPUB. Ограничение на количество доступных форматов для каждой книги накладывает правообладатель.</p>"},{title:"Как выбрать формат текстовой книги при скачивании?",text:"<p>Список доступных форматов указан индивидуально на карточке каждой книги перед покупкой.</p><p>Выбор формата зависит от того, какой формат поддерживает устройство, на котором вы планируете читать книгу. В нашем магазине вы можете приобрести книги в самых распространенных форматах: EPUB, FB2 (FB3), RTF, MOBI, PDF, TXT.</p><p>Если в перечне доступных для книги форматов нет формата, который подходит для вашего устройства для чтения, вы можете самостоятельно сконвертировать нужный вам формат с помощью соответствующих сервисов в интернете</p>"},{title:"Как выбрать формат аудиокниги при скачивании?",text:"<p>Аудиокниги доступны для скачивания в двух форматах – MP3 и M4B.</p><p>Файл аудиокниги в формате MP3 чаще всего представляет собой ZIP-архив, в котором аудиокнига разделена на несколько файлов (глав). Удобен для прослушивания на компьютере и в плеере.</p><p>В формате M4B аудиокнига представлена полностью единым файлом, этот формат удобен для мобильных устройств.</p>"},{title:"Как перенести файл книги на ридер?",text:"<p>Для того чтобы книга появилась на вашем ридере:</p><ol><li>Ознакомьтесь с инструкцией к вашему устройству для чтения электронных книг (ридеру). Выясните, какие текстовые форматы поддерживает ваш ридер</li><li>Скачайте файл книги на свой компьютер.</li><li>Подключите свой ридер к компьютеру с помощью USB кабеля, предоставленного в комплекте с ридером.</li><li>Перенесите файл книги, сохраненный на вашем компьютере, в нужную папку вашего ридера.</li></ol><p>Более подробную информацию по переносу файлов на ридер вы найдете в инструкции к вашему ридеру.</p>"},{title:"Сколько раз можно скачивать оплаченные книги?",text:"<p>Оплаченные книги вы можете скачивать неограниченное количество раз в любых доступных для книги форматах.</p><p>Исключение: книги с пометкой \xabЧитайте только на Литрес\xbb. Такие книги не будут доступны для скачивания в виде файла, но их можно без ограничений читать в наших приложениях для мобильных устройств и в онлайн-читалке на нашем сайте.</p>"}]}];var iz=n(42054),iV=n.n(iz);let iK=()=>{let{t:e}=(0,v.$G)(),t=e=>{e.stopPropagation()},{pushLocation:n}=sV(),{analyticsParams:i}=F();return(0,f.jsxs)("div",{className:iV().helpData,"data-testid":"profile__help--wrapper",children:[iq.map(n=>{let i=e(n.title);return(0,f.jsxs)(h.Fragment,{children:[(0,f.jsx)("h3",{className:iV().helpData__title,"data-testid":"profile__help--titleSection",children:i}),(0,f.jsx)("div",{className:iV().accordion,children:(0,f.jsx)(iU.U,{children:n.data.map(n=>{let i=e(n.title);return(0,f.jsx)(iU.U.Item,{title:(0,f.jsx)("h4",{className:iV().accordion__title,"data-testid":"profile__help--chapterSection",children:i}),classes:{root:iV().accordion__item,chevronIcon:iV().accordion__item__icon},children:(0,f.jsxs)("div",{className:iV().accordion__item__description,"data-testid":"profile__help--chapterDescription",children:[n.component,n.text&&(0,f.jsx)(v.cC,{i18nKey:n.text,components:{ol:(0,f.jsx)("ol",{}),li:(0,f.jsx)("li",{}),p:(0,f.jsx)("p",{}),a:(0,f.jsx)(S.Fg,{onClick:t})}})]})},n.title)})})})]},n.title)}),(0,f.jsxs)(Z,{className:iV().helpdesk,children:[(0,f.jsx)("div",{className:iV().helpdesk__title,"data-testid":"profile__help--helpdeskTitle",children:e("Не нашли ответ на свой вопрос?")}),(0,f.jsx)(eA.z,{mode:"secondary",size:"medium",text:e("Обратитесь к нашей базе знаний"),fullWidth:!0,className:iV().button,href:"https://litres.helpdeskeddy.com/ru/",targetBlank:!0,onClick:()=>{eX({eventType:d.clickReadFaq,params:i})},e2eId:"button__content--helpdeskContact"}),(0,f.jsx)(Z.Divider,{children:e("или")}),(0,f.jsx)(eA.z,{mode:"tertiary",size:"medium",text:e("Напишите в службу поддержки"),fullWidth:!0,href:c.HELPDESK,onClick:e=>{eX({eventType:d.clickContactSupport,params:i}),n(e,c.HELPDESK)},e2eId:"button__content--helpdeskWrite"})]})]})};(l=p||(p={})).payment_problem="payment_problem",l.book_not_open="book_not_open",l.library_problem="library_problem",l.suggest_idea="suggest_idea",l.other="other";let iH=new Map([["payment_problem","Проблема с покупкой"],["book_not_open","Не открывается книга"],["library_problem","Проблема с библиотекой"],["suggest_idea","Предложить идею"],["other","Другое"]]);var iQ=n(7956),i$=n(14688);let iY=e=>{var t;let{placeholder:n,className:i,controlMode:o,autoFocus:a,autoComplete:s,minLength:r,maxLength:l,symbolsCounter:_,e2eId:c,...d}=e,{field:u,fieldState:m}=(0,tg.bc)({...d,shouldUnregister:!0});return"hidden"===d.type?(0,f.jsx)("input",{type:"hidden",...u}):(0,f.jsx)(ty.F5,{...u,maxLength:l,minLength:r,symbolsCounter:_,placeholder:n,onChange:e=>{let t=e.target.value.trim();u.onChange(t)},onKeyUp:e=>{"Tab"===e.key&&(e.preventDefault(),e.stopPropagation())},autoFocus:a,autoComplete:s,controlMode:o,className:i,hideLabel:!0,error:m.invalid?null===(t=m.error)||void 0===t?void 0:t.message:void 0,"data-testid":c})};var iZ=n(66309),iJ=n.n(iZ);let iX=e=>{let{onSubmit:t,initialData:n,isSubmitting:i}=e,{t:o}=(0,v.$G)(),{formState:a,control:s,handleSubmit:r,setValue:l}=(0,tg.cI)({defaultValues:n});return(0,f.jsxs)("form",{className:iJ().form,onSubmit:r(t),children:[(0,f.jsxs)("div",{className:iJ().form__control,children:[(0,f.jsx)("label",{className:iJ().form__label,children:o("Тема обращения")}),(0,f.jsx)(iY,{name:"subject",type:"hidden",control:s,controlMode:ty.S1.text}),(0,f.jsx)(i$.L,{className:iJ().form__select,items:Object.entries(Object.fromEntries(iH)).map(e=>{let[t,n]=e;return{id:t,value:o(n)}}),defaultActiveId:p.payment_problem,onChange:e=>{let t=iH.get(e);t&&l("subject",t)}})]}),(0,f.jsxs)("div",{className:iJ().form__control,children:[(0,f.jsx)("label",{className:iJ().form__label,children:o("Ваша электронная почта")}),(0,f.jsx)(iY,{name:"email",control:s,controlMode:ty.S1.text,className:iJ().form__input,placeholder:"mail@mail.ru",rules:{required:o("Это поле обязательно для заполнения"),validate:e=>(0,iQ.Z_)().email().isValidSync(e)||o("Введите корректный адрес эл. почты")}})]}),(0,f.jsxs)("div",{className:iJ().form__control,children:[(0,f.jsx)("label",{className:iJ().form__label,children:o("Сообщение")}),(0,f.jsx)(iY,{name:"text",control:s,controlMode:ty.S1.multiline,className:iJ().form__input,rules:{minLength:{value:10,message:o("От {min} до {max} символов",{min:10,max:2e4})},maxLength:{value:2e4,message:o("От {min} до {max} символов",{min:10,max:2e4})},required:o("Это поле обязательно для заполнения")},maxLength:2e4,minLength:10,symbolsCounter:!0})]}),(0,f.jsx)("div",{className:iJ().form__button,children:(0,f.jsx)(eA.z,{type:"submit",mode:"primary",size:"medium",text:o("Отправить"),loading:a.isSubmitting||i,fullWidth:!0})})]})},i0=e=>{let{mode:t,text:n,buttonText:i,onClick:o}=e;return(0,f.jsxs)("div",{className:N()(iJ().message,iJ()["message_".concat(t)]),children:[(0,f.jsx)(E.uQ,{name:t,size:40,className:iJ().message__icon}),(0,f.jsx)("div",{className:iJ().message__text,children:n}),(0,f.jsx)(eA.z,{mode:"primary",size:"medium",text:i,onClick:o,fullWidth:!0})]})},i1=()=>{var e;let{t}=(0,v.$G)(),{pushLocation:n}=sV(),[i,{isError:o,isSuccess:a,isLoading:s}]=y.R3.useCreateTicketMutation(),r={subject:null!==(e=iH.get(p.payment_problem))&&void 0!==e?e:"",text:"",email:""},[l,_]=(0,h.useState)(!1),[c,d]=(0,h.useState)(r),u=q((0,y.CG)(e=>e.browser.headers["client-host"]));return((0,h.useEffect)(()=>{!s&&l&&_(!1)},[s,l]),o||l)?(0,f.jsx)(i0,{mode:"achtung",text:t("Не удалось отправить сообщение"),buttonText:t("Попробовать ещё раз"),onClick:()=>{i(c).unwrap(),_(!0)}}):a?(0,f.jsx)(i0,{mode:"done",text:t("Ваша заявка принята"),buttonText:t("Закрыть"),onClick:e=>{n(e,u[0])}}):(0,f.jsx)(iX,{onSubmit:e=>{d(e),i(e).unwrap()},initialData:r,isSubmitting:s})};var i3=n(73160),i4=n.n(i3);let i9=e=>{let{library:t,onSuccess:n}=e,{t:i}=(0,v.$G)(),{isSchoolUser:o}=F(),[a,s]=(0,h.useState)(!1),r=(0,y.TL)(),l=(0,y.CG)(e=>e.pages.personalCabinet.userLibraries.actions.unsubscribeCSRF.isLoading),_=(0,to.n)(),c=()=>{s(!1)};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(eA.z,{size:"medium",mode:"tertiary",text:i("Выписаться из библиотеки"),fullWidth:!0,className:i4().button,onClick:()=>{s(!0)}}),(0,f.jsx)(ep.u_,{isOpen:a,onClose:c,title:i("Хотите выписаться из библиотеки?"),primaryButton:{label:o?i("Удалить"):i("Выписаться"),onClick:()=>{r(y.hi.pages.personalCabinet.userLibraries.unsubscribeCSRF({data:{puid:t.library_card_number_id},onError:e=>{var t;s(!1),_({mode:"error",message:(null===(t=e.error)||void 0===t?void 0:t.title)||i("Ошибка выполнения запроса"),verticalAlign:"top"})},onSuccess:n}))},loading:l},secondaryButton:{label:i("Отменить"),onClick:c},children:o?i("Вам будет доступен расширенный платный каталог на нашем сайте. Чтобы продолжить бесплатное чтение, запишитесь в библиотеку рядом с домом."):(0,f.jsxs)(f.Fragment,{children:[i("Вы не сможете самостоятельно восстановить свой читательский билет онлайн."),(0,f.jsx)("br",{}),(0,f.jsx)("br",{}),i("У вас останется текущий логин и пароль и возможность покупать книги в магазине Литрес.")]})})]})};var i5=n(80930);let i2=e=>{let t=(0,y.TL)(),{t:n}=(0,v.$G)(),i=(0,y.CG)(e=>e.foundationUser.actions.teleport_CSRF),[o,{isLoading:a}]=y.iJ.useGetOneTimeSidMutation(),[s,r]=(0,h.useState)(!1),{analyticsParams:l}=F();return(0,h.useEffect)(()=>{var t;if(null===(t=i.error)||void 0===t?void 0:t.title){console.error(i.error.title),r(!1);return}i.response&&(0,C.vV)({getNewStackOneTimeSid:()=>o().unwrap(),teleportData:i.response,redirectionPathname:"/pages/library_fund/",redirectionSearchParams:new URLSearchParams({lib:"".concat(e.id)})}).catch(e=>{console.error(e)})},[i,e.id]),(0,f.jsx)(eA.z,{size:"medium",mode:"secondary",text:n("Запросить книгу из каталога"),fullWidth:!0,className:i4().button,onClick:()=>{let n=e.host||i5.Z$,i="https://".concat(n,"/pages/library_fund/?lib=").concat(e.id);if(eX({eventType:d.clickFondLibrary,params:l}),n===window.location.hostname){(0,C.xw)(i,"_blank");return}r(!0),t(y.hi.foundationUser.teleport_CSRF({data:{host:n}}))},loading:s&&(a||i.isLoading),disabled:s&&(a||i.isLoading)})},i8=/(http[s]?:\/\/)?([^\/\s]+\/)(.*)/g,i7=e=>e.replace(i8,""),i6=e=>{var t;return null===(t=e.match(i8))||void 0===t?void 0:t[0]},oe=e=>{var t;let{t:n}=(0,v.$G)(),[i,o]=(0,h.useState)(!1),{analyticsParams:a}=F(),s=(null===(t=e.blocking_info)||void 0===t?void 0:t.reason)||"";return(0,f.jsxs)(ee.b,{mode:ee.p.error,title:n("Доступ заблокирован библиотекой"),children:[n("Библиотека приостановила Ваш бесплатный доступ к книгам на Литрес. Пожалуйста, свяжитесь с библиотекой напрямую."),!!s&&(0,f.jsxs)(f.Fragment,{children:[" ",(0,f.jsx)(S.Fg,{onClick:()=>{eX({eventType:d.clickReasonBanLibrary,params:a}),o(!0)},children:n("Узнать причину")}),(0,f.jsx)(ep.u_,{isOpen:i,onClose:()=>{o(!1)},closeOnClickOutside:!0,ariaLabel:n("Причина блокировки"),children:(0,f.jsxs)("div",{className:i4().reason,children:[(0,f.jsx)("h3",{className:i4().reason__title,children:n("Причина блокировки")}),(0,f.jsx)(v.cC,{i18nKey:i7(s),components:{strong:(0,f.jsx)("strong",{}),a:(0,f.jsx)(S.Fg,{})}}),!!i6(s)&&(0,f.jsx)(eA.z,{mode:"primary",size:"medium",text:n("Заполнить"),fullWidth:!0,href:i6(s),targetBlank:!0,className:i4().reason__button})]})})]})]})},ot=e=>{let{onSuccess:t}=e,{t:n}=(0,v.$G)(),[i,o]=(0,h.useState)(!1),{analyticsParams:a}=F(),{control:s,handleSubmit:r,reset:l,setError:_}=(0,tg.cI)({defaultValues:{},mode:"onChange"}),c=(0,y.TL)(),u=(0,y.CG)(e=>e.pages.personalCabinet.userLibraries.actions.uniteCSRFV2.isLoading),m=(0,to.n)();return(0,f.jsxs)("div",{className:i4().merge,children:[(0,f.jsx)(v.cC,{i18nKey:"Если у вас есть аккаунт в другой библиотеке, <linkTag>объедините их</linkTag>",components:{linkTag:(0,f.jsx)(S.Fg,{onClick:()=>{eX({eventType:d.clickCombineAccLibrary,params:a}),o(!0)}})}}),(0,f.jsx)(ep.u_,{isOpen:i,onClose:()=>{o(!1)},closeOnClickOutside:!0,ariaLabel:n("Объединение аккаунтов"),children:(0,f.jsxs)("form",{onSubmit:r(e=>{c(y.hi.pages.personalCabinet.userLibraries.uniteCSRFV2({data:{user_login:e.login,user_passwd:e.password},onError:e=>{var t,i;let a=(null===(t=e.error)||void 0===t?void 0:t.statusText)||n("Ошибка выполнения запроса");(null===(i=e.error)||void 0===i?void 0:i.status)===1?_("password",{type:"manual",message:a}):(m({mode:"error",message:a,verticalAlign:"top"}),o(!1))},onSuccess:()=>{t(),o(!1),l()}}))}),className:i4().form,children:[(0,f.jsx)("h3",{className:i4().form__title,children:n("Объединение аккаунтов")}),(0,f.jsx)("div",{className:i4().form__control,children:(0,f.jsx)(tg.Qr,{name:"login",control:s,rules:{required:n("Обязательное поле"),validate:e=>e.trim().length>0||n("Логин не может быть пустым")},render:e=>{let{field:t,fieldState:{error:i}}=e;return(0,f.jsx)(ty.F5,{controlMode:ty.S1.text,placeholder:n("Логин другой библиотеки"),error:null==i?void 0:i.message,...t})}})}),(0,f.jsx)("div",{className:i4().form__control,children:(0,f.jsx)(tg.Qr,{name:"password",control:s,rules:{required:n("Обязательное поле"),validate:e=>e.trim().length>0||n("Пароль не может быть пустым")},render:e=>{let{field:t,fieldState:{error:i}}=e;return(0,f.jsx)(ty.F5,{...t,controlMode:ty.S1.password,placeholder:n("Пароль"),error:null==i?void 0:i.message})}})}),(0,f.jsx)(eA.z,{mode:"primary",size:"medium",text:n("Объединить"),fullWidth:!0,type:"submit",loading:u})]})})]})},on=()=>{let{t:e}=(0,v.$G)(),{data:{library_info:t}={},refetch:n}=y.r7.useGetFoundationUserDetailedInfoQuery(),{analyticsParams:i}=F(),o=()=>{eX({eventType:d.clickFondLibrary,params:i})},a=()=>{eX({eventType:d.clickUnsubscribeLibrary,params:i}),n()};return(0,f.jsxs)("div",{className:i4().container,"data-testid":"profile__mainLibraries--wrapper",children:[(0,f.jsxs)(Z,{type:"bordered-accent",children:[(0,f.jsx)(Z.Title,{children:e("Книги из всех доступных вам библиотек собраны в одном фонде")}),(0,f.jsx)(eA.z,{text:e("Перейти к книгам"),mode:"primary",size:"medium",fullWidth:!0,icon:(0,f.jsx)(E.uQ,{name:"libraryOutline",size:24}),className:i4().openLibraryFund,href:"/pages/library_fund/",onClick:()=>{eX({eventType:d.clickBooksLibrary,params:i})}}),(0,f.jsx)(Z.Description,{children:e("Если вы не нашли нужную книгу в фонде библиотеки, вы можете запросить ее в каталоге - библиотекарь выдаст её при первой возможности")})]}),null==t?void 0:t.libraries.map(e=>(0,f.jsxs)(Z,{children:[e.logo.url&&(0,f.jsx)("div",{className:i4().library__logo,children:(0,f.jsx)("img",{src:e.logo.url})}),(0,f.jsx)(Z.Title,{children:e.title}),!!e.mail&&(0,f.jsx)("div",{className:i4().library__mail,children:(0,f.jsx)(S.Fg,{href:"mailto:".concat(e.mail),children:e.mail})}),(0,f.jsx)(Z.Description,{children:e.is_blocked?(0,f.jsx)(oe,{...e}):(0,f.jsx)(v.cC,{i18nKey:e.html_description||"",components:{strong:(0,f.jsx)("strong",{}),a:(0,f.jsx)(S.Fg,{onClick:o})}})}),!e.is_blocked&&!t.is_school_user&&(0,f.jsx)(i2,{...e}),(0,f.jsx)(i9,{library:e,onSuccess:a})]},e.id)),(!(null==t?void 0:t.is_school_user)||!(null==t?void 0:t.libraries.length))&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(Z,{children:[e("Запишитесь сразу в несколько библиотек и получайте книги быстрее"),(0,f.jsx)(eA.z,{text:e("Записаться в другую библиотеку"),mode:"secondary",size:"medium",fullWidth:!0,className:i4().button,href:"/pages/libhouse_map/",onClick:()=>{eX({eventType:d.clickSubscribeOtherLibrary,params:i})}})]}),(0,f.jsx)(ot,{onSuccess:()=>{eX({eventType:d.combinedAccLibrary,params:i}),n()}})]})]})};var oi=n(44575),oo=n.p+"static/media/knigolovCompanyLogos.87a4381b.svg",oa=n.p+"static/media/knigolovCompanyLogosMobile.58f4a16d.svg",os=n(87073),or=n.n(os),ol=()=>{let e=(0,y.CG)(e=>e.browser.pda);return(0,f.jsx)("div",{className:or().brands,children:(0,f.jsx)("img",{src:e?oa:oo,height:44})})},o_=n.p+"static/media/knigolovLogo.39fa41ad.svg",oc=n(58792),od=n.n(oc),ou=()=>{let{isUserPhoneVerified:e}=F(),t=(0,y.CG)(e=>e.browser.pda);return(0,f.jsxs)("div",{className:N()(od().bonusesTitle,{[od().bonusTitle_phoneVerified]:e}),children:[!e&&(0,f.jsx)("img",{src:o_,height:40}),(0,f.jsxs)("div",{className:e?od().bonusTitlePhoneVerified__title:od().bonusesTitle__title,children:[t&&e&&(0,f.jsx)(k.Z,{className:od().bonusesTitle__backLink,href:"/me/profile/",children:(0,f.jsx)(E.uQ,{name:"arrowBack",size:24})}),"Бонусный счёт"]})]})},om=n(12619),op=n.n(om);let of=e=>{let{className:t=""}=e;return(0,f.jsxs)("div",{className:N()(op().bonusStatus__content,{[t]:t}),children:[(0,f.jsx)("div",{className:op().bonusStatus__statusSign,children:(0,f.jsx)(V.$,{})}),(0,f.jsx)("p",{className:op().bonusStatus__text,children:"Подключаем бонусный счёт"}),(0,f.jsx)("small",{className:op().bonusStatus__subtext,children:"Пожалуйста, вернитесь на эту страницу через некоторое время"})]})},oh=e=>{let{className:t=""}=e;return(0,f.jsxs)("div",{className:N()(op().bonusStatus__content,{[t]:t}),children:[(0,f.jsx)("div",{className:op().bonusStatus__statusSign,children:(0,f.jsx)(V.$,{})}),(0,f.jsx)("p",{className:op().bonusStatus__text,children:"Загружаем бонусный счёт"}),(0,f.jsx)("small",{className:op().bonusStatus__subtext,children:"Пожалуйста, подождите"})]})},ob=e=>{let{className:t=""}=e;return(0,f.jsxs)("div",{className:N()(op().bonusStatus__content,{[t]:t}),children:[(0,f.jsx)("div",{className:N()(op().bonusStatus__statusSign,op().bonusStatus__error),children:(0,f.jsx)(E.uQ,{name:"alertFilled",size:16})}),(0,f.jsx)("p",{className:op().bonusStatus__text,children:"Что-то пошло не так"}),(0,f.jsxs)("small",{className:op().bonusStatus__subtext,children:["Не удалось подключить бонусную программу. Обратитесь в ",(0,f.jsx)("br",{}),(0,f.jsx)(k.I,{href:"https://litres.helpdeskeddy.com/ru/knowledge_base/art/697/cat/71/kak-obratitsja-v-sluzbu-tehpodderzki",children:"службу поддержки"})," или попробуйте ещё раз."]})]})};var ox=n(41782),ov=n.n(ox);let og=["Используйте единый номер телефона в своих аккаунтах Литрес, Читай-городе и Буквоеде, чтобы пользоваться всеми преимуществами единой программы лояльности \xabКниголов\xbb.",", Читай-городе и Буквоеде и получайте до 15% бонусами на счёт. Процент начисления определяется уровнем в программе.","Оплачивайте бонусами до 99% от суммы чека. 1 бонус = 1₽."];var oj=e=>{let{className:t=""}=e;return(0,f.jsxs)("div",{className:N()(ov().howItWorks,{[t]:t}),children:[(0,f.jsx)("h3",{className:ov().howItWorks__title,children:"Как это работает?"}),(0,f.jsx)("ol",{className:ov().howItWorks__steps,children:og.map((e,t)=>(0,f.jsxs)("li",{className:ov().howItWorks__step,children:[(0,f.jsx)("span",{className:ov().howItWorks__number,children:t+1}),1===t&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(k.I,{href:"/",children:"Покупайте книги в Литрес"})," "]}),e]},e))})]})},oN=n(38913),oy=n.n(oN);let ok=e=>{let{contents:t}=e;return(0,f.jsx)(f.Fragment,{children:t.map(e=>{if(Array.isArray(e)){let[t,n]=e;return(0,f.jsxs)("div",{className:oy().bonusesFAQ__wrap,children:[t&&(0,f.jsx)("h5",{className:oy().bonusesFAQ__subTitle,children:t}),(0,f.jsx)("p",{children:n})]},"".concat(t,": ").concat(n))}return(0,f.jsx)("p",{children:e},e)})})},oE=[{title:"Как работает программа лояльности?",content:(0,f.jsx)(ok,{contents:["В Литрес, Читай-городе и Буквоеде действует единая программа лояльности. Чтобы стать участником и получать максимум выгоды за покупки книг в каждом из брендов участников – зарегистрируйтесь и подтвердите свой номер телефона на сайте или в приложении Литрес, Читай-город и Буквоед."]})},{title:"Как получить бонусы?",content:(0,f.jsx)(ok,{contents:[["Как получить бонусы в Литрес","Зарегистрируйтесь на сайте или в приложении, добавьте номер телефона к своему профилю. Если вы ранее были зарегистрированы в Читай-городе или Буквоеде – используйте тот же номер телефона."],"Совершите покупку книги на сайте или в приложении – бонусы будут начислены автоматически через 14 дней. Бонусы не распространяются на подписку и абонемент.",["Как получить бонусы в интернет-магазинах Читай-город и Буквоед","Зарегистрируйтесь на сайте или в приложении с тем же номером телефона, который был использован для Литрес или в розничных магазинах Читай-города и Буквоед."],"Оформите заказ – бонусы будут начислены автоматически через 14 дней.","Также, вы можете получить бонусы, если оставите отзыв о товаре, укажите дату рождения в своём профиле или подпишитесь на рассылку.",["Как получить бонусы в офлайн магазинах сети Читай-город и Буквоед","Зарегистрируйтесь на сайте через специальный QR-код, размещенный в магазинах, и подтвердите номер телефона. Используйте тот же номер телефона, который был зарегистрирован для Литрес."],"Покажите на кассе пластиковую карту, штрихкод в личном кабинете или сообщите номер мобильного телефона, к которому привязана Карта Участника.","Оставляйте отзыв о работе магазина, в котором вы сделали покупку и получайте бонусами 3% от суммы чека."]})},{title:"Как оплатить покупку бонусами?",content:(0,f.jsx)(ok,{contents:["Чтобы списывать бонусы – привяжите номер телефона к своему профилю. Если вы ранее были зарегистрированы в Читай-городе или Буквоеде – используйте тот же номер телефона. После этого вы сможете оплачивать покупки бонусами в любом из брендов-участников программы лояльности. 1 бонус = 1 рубль.",["Как оплатить покупку бонусами в Литрес","При оплате книги на сайте или в приложении – выберите опцию “списать бонусы”. Вы можете потратить до 99% бонусов при оплате покупки. Бонусы не распространяются на оплату подписки и абонемента."],["Как оплатить покупку бонусами в интернет-магазинах Читай-город и Буквоед","При оформлении заказа на сайте поставьте галочку в поле \xabОплатить заказ бонусами\xbb. В мобильном приложении в поле \xabСписать бонусы\xbb передвиньте бегунок. Вы сможете потратить до 30% бонусами от суммы чека."],["Как оплатить покупку бонусами в офлайн магазинах сети Читай-город и Буквоед","Покажите на кассе пластиковую карту или назовите номер телефона. Если вы добавили карту в мобильное приложение или у вас есть личный кабинет на сайте, то можете показать штрихкод. Вы можете потратить до 99% бонусов при оплате покупки."]]})},{title:"Как узнать, сколько у меня бонусов?",content:(0,f.jsx)(ok,{contents:["В своём профиле на сайте или в мобильном приложении Литрес, Читай-город или Буквоед."]})},{title:"Бонусы сгорают?",content:(0,f.jsx)(ok,{contents:["Да, срок действия бонусов – 120 дней."]})},{title:"Где почитать все условия?",content:(0,f.jsxs)("p",{className:oy().bonusesFAQ__flexColumn,children:["Полные юридические правила программы смотрите здесь:",(0,f.jsx)(k.I,{href:"/landing/bonus-rules/",children:"https://www.litres.ru/landing/bonus-rules/"})]})}];var oS=()=>{let e=(0,W.uH)();return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("h3",{className:oy().bonusesFAQ__title,children:"Что еще нужно знать?"}),(0,f.jsx)(iU.U,{children:oE.map(t=>(0,f.jsx)(iU.U.Item,{title:t.title,classes:{root:oy().item,chevronIcon:oy().chevronIcon},manualToggleSettings:e?void 0:{isActive:!0,onClick:C.ZT},children:t.content},t.title))})]})},oP=n(89510),ow=n.n(oP),oT=n(94123),oC=n(3224),oI=n.n(oC),oA=n(56260),oR=n.n(oA);let oO=e=>{let{level:t=1,currentLevel:n,discountPercentage:i=3,purchaseAmount:o,minValue:a=0,maxValue:s,className:r}=e,l=5===t&&5===n,_=s?s>=o&&a<o:a<o,c=_&&s?(s-o).toFixed(2):(a-o).toFixed(2),d=s&&_?Math.round(o/s*100):_&&o>=a&&void 0===s||l?100:void 0,u=l?"Самые выгодные условия начисления бонусов":o?!_&&o?"Для достижения этого уровня осталось потратить ".concat(c,"₽"):_&&o&&c?"До следующего уровня осталось потратить ".concat(c,"₽"):void 0:"Процент начисления зависит от суммы ваших покупок";return(0,f.jsxs)("div",{className:N()(oR().container,r),children:[(0,f.jsxs)("div",{className:oR().levelContainer,children:[(0,f.jsxs)("div",{className:oR().level,children:["Уровень ",t]}),(!_||!o)&&(0,f.jsx)(E.uQ,{className:N()(oR().levelContainer_icon,{[oR().icon__none]:l}),name:"lockFilled",size:16})]}),(0,f.jsxs)("div",{className:oR().caption,children:[(0,f.jsxs)("div",{className:oR().caption_title,children:[i,"% начисления за покупки"]}),(0,f.jsx)("div",{className:N()(oR().caption_description,{[oR().innactive]:!_}),children:u})]}),(0,f.jsxs)("div",{className:oR().progressContainer,children:[(0,f.jsx)("div",{className:oR().progress,style:{"--progress":"".concat(d,"%")}}),(0,f.jsxs)("div",{className:oR().rangeContainer,children:[(0,f.jsxs)("div",{className:oR().price,children:[a," ₽"]}),s&&(0,f.jsxs)("div",{className:oR().price,children:[s," ₽"]})]})]})]})};var oD=n(43846),oL=n.n(oD);let oB=[{level:1,discount:3,min:0,max:6e3},{level:2,discount:6,min:6001,max:9e3},{level:3,discount:9,min:9001,max:11e3},{level:4,discount:11,min:11001,max:15e3},{level:5,discount:15,min:15001}],oG=()=>{var e,t,n;let i=(0,y.CG)(e=>e.browser.pda),{data:o,isLoading:a}=y.r7.useGetBonusesQuery(),s=0,r=[{threshold:15,level:5},{threshold:11,level:4},{threshold:9,level:3},{threshold:6,level:2},{threshold:3,level:1}],l=null!==(n=null==o?void 0:o.current_cashback_percent)&&void 0!==n?n:0,_=null==r?void 0:null===(e=r.find(e=>{let{threshold:t}=e;return l>=(null!=t?t:0)}))||void 0===e?void 0:e.level;o&&oI()(null===(t=o.current_loyalty_level_range)||void 0===t?void 0:t.next_level_threshold)&&oI()(o.purchase_amount_for_next_level)&&(s=o?o.current_loyalty_level_range.next_level_threshold-o.purchase_amount_for_next_level:0);let c=(0,h.useMemo)(()=>_?oB.slice(_-1):oB,[_]);return a?(0,f.jsx)("div",{className:oL().fakeBlock}):(0,f.jsx)("div",{className:oL().carousel,style:{"--slide-spacing":"8px"},children:(0,f.jsx)(oT.l,{options:{loop:!1},hasAutoplay:!1,isEnableButtons:!i,containerClassName:oL().carousel_container,styleViewPort:{padding:"10px 0"},dotClassName:oL().dot,children:c.map(e=>{let{level:t,min:n,max:i,discount:o}=e;return(0,f.jsx)(oO,{level:t,currentLevel:_,minValue:n,maxValue:i,discountPercentage:o,purchaseAmount:s,className:oL().card},t)})})})};var oF=()=>{let e=(0,y.CG)(e=>e.foundationUser),[t,n]=(0,h.useState)(!1),[i,o]=(0,h.useState)(!1),[a,s]=(0,h.useState)(!1),r=(0,y.CG)(e=>e.browser.pda),l=(0,h.useRef)(!0),[_,{isLoading:c,isSuccess:d,isError:u}]=y.YR.endpoints.registerLoyalty.useMutation(),{availableBonuses:m,burnBonuses:p,bonusesExpirationDaysLeft:b,isLoading:x,isUserPhoneVerified:v,fetchBonuses:g,bonusesError:j,isLoyaltyUser:S}=F(),P=!!j,w=(0,M.useRouter)();(0,h.useEffect)(()=>{(v&&i||S)&&g().finally(()=>{l.current&&o(!1)})},[]);let T=()=>{o(!0),I(),s(!0)};(0,h.useEffect)(()=>{if(!a)return;s(!1);let e=setTimeout(()=>{g().finally(()=>{l.current&&o(!1)})},1e3);return()=>{l.current=!1,clearTimeout(e)}},[a]);let I=()=>{n(!1)},A=void 0!==m&&v&&!x&&!P&&!i,R=void 0!==p&&v&&!x&&!i&&!P&&b>0,O=!v||P||!S,D=!v&&!x&&!i||P||!S,L=S&&v&&!P,B=e=>(0,C.pd)(e,["бонус","бонуса","бонусов"]),G=((0,tC.gn)(e.varioqubTests.flags,"welcome_bonuses","true")||"welcome_bonuses"===w.query.test)&&e.loyalty.need_show_welcome_bonuses&&!S;return(0,f.jsxs)("div",{className:ow().bonuses,"data-testid":"profile__bonus--wrapper",children:[!(r&&v)&&(0,f.jsx)(k.Z,{className:ow().bonuses__backLink,href:"/me/profile/",children:(0,f.jsx)(E.uQ,{name:"arrowBack",size:24})}),(0,f.jsxs)("div",{className:ow().bonuses__inner,children:[(0,f.jsxs)("div",{className:N()(ow().bonuses__content,{[ow().bonuses__content_phoneVerified]:v}),children:[(0,f.jsx)(ou,{}),A&&(0,f.jsxs)("div",{className:ow().bonuses__amount,children:[(0,f.jsx)(E.uQ,{name:"bonusHeartDouble",size:r?24:40}),(0,f.jsxs)("p",{children:[m," ",B(m)]})]}),R&&(0,f.jsxs)("p",{className:ow().bonuses__expiration,children:[(0,f.jsx)(E.uQ,{name:"fire",width:12,height:12}),p," ",B(p)," ",(0,C.pd)(p,["сгорит","сгорят","сгорят"])," ","через ",b," ",(0,C.pd)(b,["день","дня","дней"])]}),O&&(0,f.jsx)("p",{className:ow().bonuses__description,children:"Копите и тратьте бонусы в Литрес, Читай‑городе и Буквоеде"}),(0,f.jsx)(ol,{}),x&&!i&&(0,f.jsx)(oh,{className:ow().bonuses__status}),i&&(0,f.jsx)(of,{className:ow().bonuses__status}),(P||u)&&!i&&!x&&(0,f.jsx)(ob,{className:ow().bonuses__status}),G&&(0,f.jsxs)("div",{className:ow().bonuses__welcome,children:[(0,f.jsx)(E.uQ,{name:"bonusHeartDouble",size:24}),(0,f.jsx)("span",{children:"+50 бонусов новым участникам"})]}),D&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(eA.z,{className:ow().bonuses__getBonuses,size:"medium",fullWidth:!0,text:"Получать бонусы",mode:"secondary",onClick:()=>{!S&&v?c||_().then(()=>{d&&T()}):P?T():x||n(!0)}}),t&&(0,f.jsx)(oi.AddNewPhonePopup,{onClose:I,onSuccess:T,subTitle:"Чтобы использовать бонусы, добавьте номер телефона"})]})]}),(0,f.jsx)(oG,{}),(0,f.jsx)("div",{className:ow().bonuses__background})]}),L&&(0,f.jsx)(eA.z,{className:ow().bonuses__goToShoping,size:"medium",fullWidth:!0,text:"Перейти к покупкам",mode:"primary",href:"/recommend/"}),(0,f.jsx)(oj,{className:ow().bonuses__howItWorks}),(0,f.jsx)(oS,{})]})},oM=n(64009),oW=n(38112),oU=n(65597),oq=n(58655),oz=n(8725),oV=n(600),oK=n.n(oV);let oH=e=>{var t,n;let{art:i}=e;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(k.I,{href:null!==(t=i.url)&&void 0!==t?t:"",className:oK().art,children:[(0,f.jsx)(oq.uq,{alt:i.title,artId:i.id,wrapperClassName:oK().cover}),(0,f.jsx)("span",{className:oK().art__title,children:i.title})]}),(0,f.jsx)(oz.h,{className:oK().art__annotation,html:null!==(n=i.html_annotation)&&void 0!==n?n:""})]})};var oQ=n(58242),o$=n.n(oQ);let oY=e=>{let{notification:t,onView:n}=e,{t:i}=(0,v.$G)(),o=(0,h.useRef)(null),a=(0,tc.WU)(new Date(t.created_at),"dd.MM.yy"),s=(0,oM.S1)(o,{freezeOnceVisible:!0}),r="";return"recense_moderation"===t.type&&(r=i("Ваш отзыв отправлен на модерацию")),"subscr_charge_fail"===t.type&&(r=i("Ошибка оплаты подписки")),(0,h.useEffect)(()=>{if(t.is_viewed||!(null==s?void 0:s.isIntersecting))return;let e=setTimeout(()=>{n(t.id)},3e3);return()=>{clearTimeout(e)}},[null==s?void 0:s.isIntersecting,t.is_viewed]),(0,f.jsxs)("div",{className:N()(o$().notification,{[o$().notification_isViewed]:t.is_viewed}),ref:o,children:[t.title?(0,f.jsx)("h4",{className:o$().notification__title,children:t.title}):r&&(0,f.jsx)("h4",{className:o$().notification__title,children:r}),(0,f.jsxs)("div",{className:o$().notification__content,children:[t.text?(0,f.jsx)("div",{className:o$().notification__content__text,children:t.text}):"",t.art&&(0,f.jsx)(oH,{art:t.art}),(0,f.jsx)("div",{className:o$().notification__content__dateStamp,children:a})]})]})};var oZ=n(77837),oJ=n.n(oZ);let oX=()=>{let[e]=y.BT.useSetStatusMutation(),t=(0,h.useRef)(new Set([])),n=(0,oM.$0)(oJ()(()=>{t.current&&(e({notifications:Array.from(t.current).map(e=>({id:e,status:"delivered"}))}),t.current.clear())},300));return{handleIsViewed:e=>{t.current.add(e),n()}}};var o0=n(91657),o1=n.n(o0);let o3=()=>{let{t:e}=(0,v.$G)(),[t,n]=(0,h.useState)(),{data:i,isFetching:o,isLoading:a}=y.BT.useGetNotificationsQuery({limit:10,after:t}),{handleIsViewed:s}=oX(),r=(0,h.useRef)(null),l=(0,oU.R)(r),_=(0,h.useMemo)(()=>(null==i?void 0:i.data)||[],[i]),c=(0,oM.$0)(()=>{var e;if(!(null==i?void 0:null===(e=i.pagination)||void 0===e?void 0:e.next_page))return;let t=new URLSearchParams(i.pagination.next_page).get("after");t&&n(t)});return(0,h.useEffect)(()=>{l&&c()},[l]),(0,f.jsxs)("div",{className:o1().notifications,"data-testid":"profile__notifications--wrapper",children:[a||0!==_.length?_.map(e=>(0,f.jsx)(oY,{notification:e,onView:s},e.id)):(0,f.jsx)("div",{className:o1().empty,children:(0,f.jsx)(tI.u,{children:e("У вас нет новых уведомлений")})}),(0,f.jsx)("div",{ref:r}),o&&(0,f.jsx)(f.Fragment,{children:(0,C.TS)(3).map(e=>(0,f.jsx)(oW.T3,{coverType:"square"},e))})]})};var o4=n(98071),o9=n(47443),o5=n.n(o9);let o2=()=>{var e,t;let n=(0,y.TL)(),{t:i}=(0,v.$G)(),o=(0,y.CG)(e=>e.face.language||"ru"),a=new Intl.Collator(o),{data:s,isLoading:r}=y.BT.useGetNotificationsSettingsQuery(),[l]=y.BT.useUpdateNotificationsSettingsMutation(),{userSettings:_,analyticsParams:c}=F(),u=(0,h.useMemo)(()=>s?s.default_subscription_languages.map(e=>{let{iso_code:t,title:n}=e;return{id:t.toUpperCase(),value:i(n)}}).sort((e,t)=>e.id===o.toUpperCase()?-1:t.id===o.toUpperCase()?1:a.compare(e.value,t.value)):[],[s]),m=(e,t)=>{var n;let i=(null==s?void 0:null===(n=s.channels)||void 0===n?void 0:n.reduce((e,n)=>n.is_active&&n.channel_id!==t.channel_id&&n.message_type_id?e?"".concat(e,",").concat(n.message_type_id):"".concat(n.message_type_id):e,""))||"";l({channels:[{channel_id:t.channel_id||0,message_type_id:t.message_type_id||0,status:e?1:0}]}).unwrap().then(()=>{eX({eventType:d.changeListNotif,params:{...c,language:(null==_?void 0:_.ui_language)||"RU",list_notification:"".concat(i).concat(e&&t.message_type_id?",".concat(t.message_type_id):"")}})})};return(0,f.jsxs)("div",{className:o5().settings,children:[(0,f.jsx)("div",{className:o5().settings__info,children:i("Здесь вы можете выбрать, какие рассылки вы хотите получать и способы их получения")}),r?(0,f.jsx)("div",{className:o5().settings__loading,children:(0,f.jsx)(V.$,{})}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:o5().settings__block,children:[(0,f.jsx)("h3",{className:o5().settings__title,children:i("Какие уведомления вы хотите получать?")}),null==s?void 0:null===(e=s.channels)||void 0===e?void 0:e.map(e=>{var t;return(0,f.jsxs)(f.Fragment,{children:[e.channel_id&&(0,f.jsx)(o4.X,{id:"".concat(e.channel_id,"-").concat(e.message_type_id),name:"".concat(e.channel_id,"-").concat(e.message_type_id),onChange:t=>{m(t,e)},isCheckedDefault:!!e.is_active,text:i(e.title),className:o5().settings__channel},"".concat(e.channel_id,"-").concat(e.message_type_id)),null===(t=e.devices_notifications)||void 0===t?void 0:t.map(t=>t.channel_id&&(0,f.jsx)(o4.X,{id:"".concat(t.channel_id,"-").concat(t.message_type_id),name:"".concat(t.channel_id,"-").concat(t.message_type_id),onChange:e=>{m(e,t)},isCheckedDefault:!!t.is_active,text:"".concat(i(e.title)," ").concat(t.title),className:o5().settings__channel},"".concat(t.channel_id,"-").concat(t.message_type_id)))]})})]}),(0,f.jsxs)("div",{className:o5().settings__block,children:[(0,f.jsx)("h3",{className:o5().settings__title,children:i("Основной язык рассылок:")}),(0,f.jsx)("div",{className:o5().settings__language,children:(0,f.jsx)(i$.L,{items:u,defaultActiveId:null!==(t=null==_?void 0:_.ui_language)&&void 0!==t?t:"RU",onChange:e=>{l({subscriptions_language:e}).unwrap().then(()=>{var t;n(y.r7.util.invalidateTags([y.eJ.USER_DETAILED_DATA])),eX({eventType:d.changeLanguageNotif,params:{...c,list_notification:null==s?void 0:null===(t=s.channels)||void 0===t?void 0:t.reduce((e,t)=>t.is_active&&t.message_type_id?e?"".concat(e,",").concat(t.message_type_id):"".concat(t.message_type_id):e,""),language:e}})})},menuClassName:o5().settings__language__list})})]})]})]})};var o8=n(48747),o7=n(8976),o6=n(1114),ae=n(5043),at=n.n(ae);let an=()=>{let{t:e}=(0,v.$G)(),{data:t}=(0,o6.B)();return(null==t?void 0:t.bought_collections.length)?(0,f.jsxs)("div",{className:at().offers__block,children:[(0,f.jsxs)("h3",{className:at().offers__block__title,children:[e("Активные акции"),(0,f.jsx)("div",{className:at().offers__count,children:t.bought_collections.length})]}),(0,f.jsx)("div",{className:N()(at().offers__list,{[at().offers__list_fullWithLastChild]:t.bought_collections.length%2}),children:null==t?void 0:t.bought_collections.map(t=>(0,f.jsxs)(Z,{type:"bordered",className:at().offer,children:[(0,f.jsxs)(k.I,{href:t.url||void 0,className:at().offer__title,children:[(0,f.jsx)("h3",{children:t.name}),(0,f.jsx)(E.uQ,{name:"chevronRight",size:16,className:at().offer__title__icon})]}),(0,f.jsx)("div",{className:at().offer__count,children:e("{count} книга",{count:t.total_items})})]},t.id))})]}):null};var ai=n(91366),ao=n(84764);let aa=()=>{let{analyticsParams:e}=F(),[{isSuccess:t,isLoading:n,backendErrorMessage:i,redirectUrl:o},{redeemPromocode:a}]=(0,ai.z)();return(0,f.jsx)(ao.N,{isSuccess:t,isLoading:n,redirectUrl:o,backendErrorMessage:i,onSubmit:a,onPromocodeActivated:t=>{eX({eventType:d.promocodeAdded,params:{...e,promocode:t}})}})},as=()=>{let{t:e}=(0,v.$G)(),t=(0,o8.A)();return(0,f.jsxs)("div",{className:at().offers,"data-testid":"profile__promo--wrapper",children:[(0,f.jsxs)(Z,{type:"filled",className:at().offers__block,children:[(0,f.jsx)("h3",{className:at().offers__block__title,children:e("Активация промокода Литрес")}),(0,f.jsx)(aa,{})]}),(0,f.jsxs)("div",{className:at().offers__block,children:[(0,f.jsx)("h3",{className:at().offers__block__title,children:e("Бонусные карты")}),(0,f.jsxs)(Z,{type:"bordered",children:[(0,f.jsxs)(k.Z,{href:"/pages/personal_cabinet_loyalties",className:at().offers__block__title,children:[(0,f.jsx)("h4",{children:e("Подключить бонусные карты от партнеров")}),(0,f.jsx)(E.uQ,{name:"chevronRight",size:16,className:at().offer__title__icon})]}),(0,f.jsx)("p",{className:at().offer__count,children:e("Предложения партнеров")})]})]}),(0,f.jsx)(an,{}),t&&(0,f.jsxs)("div",{className:at().offers__block,children:[(0,f.jsx)("h3",{className:at().offers__block__title,children:e("Персональные акции")}),(0,f.jsx)(o7.g,{})]})]})};var ar=n(54417),al=n.n(ar),a_=n(26012),ac=n(286),ad=n(90643),au=n.n(ad);let am=e=>{let{savedPaymentMethodInfo:t,onUserWantsToDelete:n}=e,{t:i}=(0,v.$G)(),o=[];return t.isLinkedToSubscription&&o.push(i("Этой картой вы оплачиваете подписку")),t.isLinkedToAbonement&&o.push(i("Этой картой вы оплачиваете абонемент")),(0,f.jsxs)("div",{className:au().root,children:[(0,f.jsxs)("div",{className:au().savedPaymentMethodDetails,children:[(0,f.jsx)(nc,{savedPaymentMethodInfo:t,shouldDisplayBrand:!0,className:au().root__data}),0==o.length&&(0,f.jsx)(ap,{onUserWantsToDelete:()=>{n(t.savedPaymentMethodId)}})]}),o.length>0&&(0,f.jsx)("ul",{children:o.map(e=>(0,f.jsx)("li",{className:au().linkingInfo,children:e},e))})]})},ap=e=>{let[t,n]=(0,h.useState)(null),{t:i}=(0,v.$G)();return null===t?(0,f.jsx)(E.uQ,{name:"delete",size:16,className:au().deleteIcon,onClick:()=>{n(setTimeout(()=>{e.onUserWantsToDelete()},3e3))},title:i("Удалить способ оплаты")}):(0,f.jsxs)("div",{className:au().root__actions,children:[(0,f.jsx)("span",{className:au().root__message,children:i("Способ оплаты удалён")}),(0,f.jsx)(E.uQ,{name:"return",size:16,title:i("Восстановить способ оплаты"),className:au().deleteIcon,onClick:()=>{t&&(clearTimeout(t),n(null))}})]})};var af=n(40994),ah=n.n(af);let ab=e=>{let{notifyError:t}=e,{t:n}=(0,v.$G)(),i=(0,y.TL)(),o=new tD.$(i),a=Object.values(tL.X8).map(e=>parseInt(e,10)),{data:s,isError:r,isLoading:l,refetch:c}=o.useAllUserSavedPaymentMethodsQuery(a),[d]=o.useDeleteUserSavedPaymentMethod(),{data:u}=y.r7.useGetFoundationUserDetailedInfoQuery(),{data:m}=(0,I.Z)(),{data:p}=(0,A.Z)(),h=async e=>{let i=await d(e);if((0,tK.$)(i)){t({message:n("Ошибка удаления способа оплаты")});return}c(),O(_.LK_NEW_CARD_DELETED,B({userInfo:u,userSubscription:m,userAbonement:p,extra:{cnt_active_card:s.length-1}}))};return l?(0,f.jsxs)("div",{className:ah().noPaymentMethods,children:[(0,f.jsx)(ac.B,{className:ah().icon}),(0,f.jsx)("p",{children:n("Загрузка")})]}):r?(0,f.jsxs)("div",{className:ah().noPaymentMethods,children:[(0,f.jsx)(E.uQ,{className:ah().icon,name:"alert",size:24}),(0,f.jsx)("p",{children:n("Произошла ошибка загрузки")}),(0,f.jsx)(a_.z,{text:n("Обновить"),size:"very-small",mode:"secondary",className:ah().retryButton,onClick:c})]}):(0,f.jsx)(f.Fragment,{children:s.map(e=>(0,f.jsx)(am,{savedPaymentMethodInfo:e,onUserWantsToDelete:h},e.savedPaymentMethodId))})},ax=()=>{let{t:e}=(0,v.$G)(),t=(0,y.CG)(e=>e.browser.pda),{goToPayment:n,isGoingToNewPaymentFrame:i,paymentEntryPointControlRef:o}=(0,eL.o)(),{data:a}=y.r7.useGetFoundationUserDetailedInfoQuery(),{data:s}=(0,I.Z)(),{data:r}=(0,A.Z)();return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(eA.z,{text:e("Добавить карту"),icon:(0,f.jsx)(E.uQ,{name:"addList",size:24}),size:t?"small":"medium",mode:"secondary",loading:i,disabled:i,onClick:()=>{O(_.LK_ADD_NEW_CARD,B({userInfo:a,userSubscription:s,userAbonement:r})),n()},fullWidth:!0}),(0,f.jsx)(tz.I,{ref:o,mode:"rebill-link",cameFromSource:eN.l.userProfile,afterPaymentRedirectParams:{successRedirectUrl:c.PAYMENT,failRedirectUrl:c.PAYMENT,backUrl:c.PAYMENT}})]})},av=e=>{let{notifyError:t}=e,{t:n}=(0,v.$G)();return(0,f.jsxs)("div",{"data-testid":"profile__payments--wrapper",children:[(0,f.jsxs)("div",{className:al().header,children:[(0,f.jsx)("h3",{className:al().header__label,children:n("Способы оплаты")}),(0,f.jsx)("span",{className:al().header__subText,children:n("Здесь можно посмотреть ваши сохраненные способы оплаты и добавить новые")}),(0,f.jsx)(ab,{notifyError:t})]}),(0,f.jsx)(ee.b,{mode:ee.p.safe,title:n("Платеж безопасен"),className:al().alert,children:n("Пополнение счета осуществляется по протоколу с поддержкой шифрования и защиты. Данные вашей карты в безопасности.")}),(0,f.jsx)(ax,{})]})};var ag=n(36552),aj=n.n(ag),aN=e=>{let{label:t,caption:n,href:i}=e,{pushLocation:o}=sV();return(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(Z,{onClick:e=>{o(e,i)},className:aj().linkTo,children:[(0,f.jsx)(Z.Title,{className:aj().linkTo__title,children:t}),(0,f.jsxs)(Z.Description,{className:aj().linkTo__content,children:[n,(0,f.jsx)(E.uQ,{name:"chevronRight",size:16,className:aj().linkTo__content__chevronButton})]})]})})},ay=n(73116),ak=n.n(ay);let aE=()=>{let{t:e}=(0,v.$G)(),t=(0,y.CG)(e=>e.browser.headers["client-host"]),n=(0,to.n)();return(0,f.jsxs)("div",{className:ak().paymentSelector,children:[(0,f.jsx)(av,{notifyError:n}),(0,C.Sg)(t)&&(0,f.jsxs)(Z,{className:ak().menuBlock,children:[(0,f.jsx)(Z.Title,{children:(0,f.jsx)(e9,{})}),(0,f.jsx)("div",{className:ak().menuBlock__description,children:e("Литрес Счёт")})]}),(0,f.jsx)(aN,{href:c.PAYMENT_HISTORY,label:e("История операций"),caption:e("История списаний, начислений и действий с книгами")}),(0,f.jsx)(aN,{href:c.PAYMENT_REFERRAL,label:e("Покупки друзей"),caption:e("Начисления за покупки ваших друзей")})]})};class aS{constructor(e){this.date=new Date(e.date),this.moneyMovementId=e.money_movement_id,this.moneyMovementType=e.money_movement_type,this.specificData=this.getSpecificDataByInfoFromBackend(e)}}class aP extends aS{getSpecificDataByInfoFromBackend(){return{}}getOperationId(){return"".concat(this.moneyMovementType,"-").concat(this.moneyMovementId)}}var aw=n(81014);class aT extends aS{getSpecificDataByInfoFromBackend(e){var t,n,i,o,a;let s=e.specific_data;return{product:null!==(t=s.product)&&void 0!==t?t:null,hasReceipt:null!==(n=s.has_receipt)&&void 0!==n&&n,isGift:null!==(i=s.is_gift)&&void 0!==i&&i,isAppliedPromocode:null!==(o=s.is_applied_promocode)&&void 0!==o&&o,isSupport:null!==(a=s.is_support)&&void 0!==a&&a,arts:s.arts.map(e=>({id:e.id,title:e.title,artType:e.art_type})),spendings:s.spendings.map(e=>{var t;return{isLitresBonus:null!==(t=e.is_litres_bonuses)&&void 0!==t&&t,money:new aw.W(e.money)}})}}}class aC extends aS{getSpecificDataByInfoFromBackend(e){let t=e.specific_data;return{money:new aw.W(t.money)}}}class aI extends aS{getSpecificDataByInfoFromBackend(e){var t,n;let i=e.specific_data;return{hasReceipt:null!==(t=i.has_receipt)&&void 0!==t&&t,money:new aw.W(i.money),paymentSystemId:null!==(n=i.payment_system_id)&&void 0!==n?n:null}}}class aA extends aS{getSpecificDataByInfoFromBackend(e){return{userId:e.specific_data.user_id}}}class aR extends aS{getSpecificDataByInfoFromBackend(e){var t;let n=e.specific_data,i="PROMOCODE_ACTIVATION"===e.specific_data.operation_type;return{code:null!==(t=n.code)&&void 0!==t?t:null,isActivation:i}}}class aO extends aS{getSpecificDataByInfoFromBackend(e){let t=e.specific_data,{library_id:n,valid_till:i}=t;return{event:t.event,arts:t.arts.map(e=>({id:e.id,title:e.title,artType:e.art_type})),validTill:i?new Date(i):null,libraryId:null!=n?n:null}}}class aD extends aS{getSpecificDataByInfoFromBackend(e){let t=e.specific_data;return{orderId:t.order_id,money:new aw.W(t.money)}}}class aL extends aS{getSpecificDataByInfoFromBackend(){return{}}}class aB extends aS{getSpecificDataByInfoFromBackend(e){let t=e.specific_data;return{money:new aw.W(t.money)}}}class aG extends aS{getSpecificDataByInfoFromBackend(e){let t=e.specific_data;return{money:new aw.W(t.money)}}}class aF extends aS{getSpecificDataByInfoFromBackend(e){let t=e.specific_data;return{money:new aw.W(t.money)}}}class aM extends aS{getSpecificDataByInfoFromBackend(e){var t,n,i,o,a,s;let r=e.specific_data,l="SUBSCRIPTION_PRODUCT_NEW"===e.specific_data.operation_type;return{product:r.product,hasReceipt:null!==(t=r.has_receipt)&&void 0!==t&&t,purchaseOrigin:null!==(n=r.purchase_origin)&&void 0!==n?n:null,tariffDuration:null!==(i=r.tariff_duration)&&void 0!==i?i:null,giftMonths:null!==(o=r.bonus_month_count)&&void 0!==o?o:null,isPurchase:l,isTrial:null!==(a=r.is_trial)&&void 0!==a&&a,isAppliedPromocode:null!==(s=r.is_applied_promocode)&&void 0!==s&&s}}}class aW extends aS{getSpecificDataByInfoFromBackend(e){var t;let n=e.specific_data;return{product:n.product,hasReceipt:null!==(t=n.has_receipt)&&void 0!==t&&t}}}let aU={SUCCESS_PAYMENT:aI,ART_ISSUANCE:aT,ART_RETURN:aC,SUBSCRIPTION_PRODUCT_NEW:aM,SUBSCRIPTION_PRODUCT_RENEW:aM,SUBSCRIPTION_PRODUCT_CANCELLATION:aW,ACCOUNTS_MERGE:aA,PROMOCODE_ACTIVATION:aR,PROMOCODE_PAYMENT:aR,LIBRARY_ART_EVENT:aO,OZON_ORDER:aD,ADVERTISING_OFF:aL,PARTNER_PAYMENT:aB,FRIENDS_PURCHASE:aG,REFERRAL_PAYMENT_REQUEST:aF};class aq{createHistoryOperation(e){return new(aU[e.specific_data.operation_type]||aP)(e)}constructor(e){this.operations=e.map(e=>this.createHistoryOperation(e))}}var az=n(55587),aV=n.n(az);let aK=e=>{let{operation:t,specificOperationUi:n}=e,{extraHeader:i,body:o}=n,{i18n:a}=(0,v.$G)();return(0,f.jsxs)("article",{className:aV().card,children:[(0,f.jsxs)("header",{className:aV().header,children:[(0,f.jsx)("h4",{className:aV().title,children:n.title}),i||null]}),!!o&&(0,f.jsx)("div",{className:aV().body,children:n.body}),(0,f.jsx)("footer",{className:aV().footer,children:(0,f.jsx)("time",{className:aV().date,children:t.date.toLocaleDateString(a.language)})})]})},aH=e=>{let{t}=(0,v.$G)();return(0,f.jsxs)(k.I,{href:"/pages/receipt/?mm=".concat(e.moneyMovementId),children:[t("Электронный чек")," >"]})};var aQ=n(20415),a$=n.n(aQ);let aY=e=>(0,f.jsx)("span",{className:a$().money,children:e.children}),aZ={title:function(){let{t:e}=(0,v.$G)();return(0,f.jsx)(f.Fragment,{children:e("Оплата")})},extraHeader:function(e){let{operation:t}=e;return(0,f.jsx)(aY,{children:t.specificData.money.toStringWithCurrency()})},body:function(e){let{operation:t}=e;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("p",{children:(0,f.jsx)(v.cC,{i18nKey:"Зачисление <moneyTag>+{money}</moneyTag> на счёт.",components:{moneyTag:(0,f.jsx)(aY,{})},values:{money:t.specificData.money.toStringWithCurrency()}})}),t.specificData.hasReceipt&&(0,f.jsx)(aH,{moneyMovementId:t.moneyMovementId})]})}};var aJ=n(77053),aX=n.n(aJ);let a0={title:function(e){let{operation:t}=e,{t:n}=(0,v.$G)(),i=function(e,t){let{isGift:n,isAppliedPromocode:i,isSupport:o,product:a}=e;return t(a&&"abonement"===a?"Получена книга по абонементу":a&&"litres_subscription"===a?"Получена книга по подписке":o?"Выдача книги администрацией":n||"4th_present"===a?"Получена книга по акции":i?"Покупка книги по промокоду":"Покупка книги")}(t.specificData,n);return(0,f.jsx)(f.Fragment,{children:i})},extraHeader:function(e){let{operation:t}=e;return(0,f.jsx)("ul",{className:aX().spendingsList,children:t.specificData.spendings.map((e,t)=>(0,f.jsx)("li",{className:aX().spendingsListItem,children:(0,f.jsx)("data",{value:e.money.value,className:aX().spendingMoney,children:e.isLitresBonus?(0,f.jsx)(a1,{bonuses:e.money.value}):e.money.toStringWithCurrency()})},t))})},body:function(e){let{operation:t}=e;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("ul",{className:aX().artsList,children:t.specificData.arts.map(e=>(0,f.jsxs)("li",{className:aX().art,children:[(0,f.jsx)(oq.uq,{wrapperClassName:aX().cover,imgTagClassName:aX().coverImage,artId:e.id,alt:e.title}),(0,f.jsx)("span",{className:aX().artTitle,children:(0,f.jsx)(k.I,{href:"/".concat(e.id),children:e.title})})]},e.id))}),t.specificData.hasReceipt&&(0,f.jsx)(aH,{moneyMovementId:t.moneyMovementId})]})}};function a1(e){let{bonuses:t}=e,{t:n}=(0,v.$G)();return(0,f.jsxs)(f.Fragment,{children:[t," ",(0,C.pd)(t,[n("бонус"),n("бонуса"),n("бонусов")])]})}let a3={title:function(){let{t:e}=(0,v.$G)();return(0,f.jsx)(f.Fragment,{children:e("Возврат средств")})},extraHeader:function(e){let{operation:t}=e,{specificData:n}=t;return(0,f.jsx)(aY,{children:n.money.toStringWithCurrency()})},body:function(e){let{operation:t}=e,{specificData:n}=t;return(0,f.jsx)("p",{children:(0,f.jsx)(v.cC,{i18nKey:"Возврат <moneyTag>+{money}</moneyTag> на счёт.",components:{moneyTag:(0,f.jsx)(aY,{})},values:{money:n.money.toStringWithCurrency()}})})}},a4={title:function(e){let{operation:t}=e,{t:n}=(0,v.$G)();return(0,f.jsxs)(f.Fragment,{children:[n("Операция")," #",t.getOperationId()]})},body:function(){let{t:e}=(0,v.$G)();return(0,f.jsx)("p",{children:e("Обратитесь в поддержку, если хотите знать подробности об операции.")})}},a9={title:function(){let{t:e}=(0,v.$G)();return(0,f.jsx)(f.Fragment,{children:e("Объединение аккаунтов")})},body:function(e){let{operation:t}=e;return(0,f.jsx)("p",{children:(0,f.jsx)(v.cC,{i18nKey:"Выполнено объединение с пользователем {userId}",values:{userId:t.specificData.userId}})})}},a5={title:function(e){let{operation:t}=e,{isActivation:n}=t.specificData,{t:i}=(0,v.$G)(),o=a2(n,i);return(0,f.jsx)(f.Fragment,{children:o})},body:function(e){let{operation:t}=e,{code:n,isActivation:i}=t.specificData,{t:o}=(0,v.$G)(),a=a2(i,o),s=n?" (".concat(n,")"):"";return(0,f.jsxs)("p",{children:[a,s]})}};function a2(e,t){return t(e?"Активация промокода":"Оплата промокодом")}function a8(e){let{specificData:t}=e,{event:n}=t;return(0,f.jsxs)("p",{children:[(0,f.jsx)(a7,{event:n}),(0,f.jsx)(a6,{event:n,libraryId:t.libraryId}),(0,f.jsx)(se,{event:n,validTill:t.validTill})]})}function a7(e){let{event:t}=e,{t:n}=(0,v.$G)(),i=function(e,t){switch(e){case"request":return t("Запрос книги в библиотеку");case"cancel":return t("Отмена запроса на книгу в библиотеку");case"reject":return t("Запрос на книгу отклонен библиотекой");case"refund":return t("Книга возвращена в библиотеку");case"issue":return t("Книга выдана библиотекой")}}(t,n);return(0,f.jsx)(f.Fragment,{children:i})}function a6(e){let{event:t,libraryId:n}=e;return n&&("reject"===t||"issue"===t)?(0,f.jsx)(f.Fragment,{children:" ".concat(n)}):null}function se(e){let{event:t,validTill:n}=e,{i18n:i}=(0,v.$G)();return n&&"issue"===t?(0,f.jsxs)(f.Fragment,{children:[" ",(0,f.jsx)(v.cC,{i18nKey:"до {validTill}",values:{validTill:n.toLocaleDateString(i.language)}})]}):null}var st=n(54767),sn=n.n(st);let si={title:function(e){let{operation:t}=e;return(0,f.jsx)(a8,{specificData:t.specificData})},body:function(e){let{operation:t}=e;return(0,f.jsx)("ul",{className:sn().artsList,children:t.specificData.arts.map(e=>(0,f.jsxs)("li",{className:sn().art,children:[(0,f.jsx)(oq.uq,{wrapperClassName:sn().cover,imgTagClassName:sn().coverImage,artId:e.id,alt:e.title}),(0,f.jsx)("span",{className:sn().artTitle,children:(0,f.jsx)(k.I,{href:"/".concat(e.id),children:e.title})})]},e.id))})}},so={title:function(){let{t:e}=(0,v.$G)();return(0,f.jsx)(f.Fragment,{children:e("Регистрация заказа Ozon")})},body:function(e){let{operation:t}=e,{orderId:n,money:i}=t.specificData;return(0,f.jsx)("p",{children:(0,f.jsx)(v.cC,{i18nKey:"Сумма: <moneyTag>+{money}</moneyTag>. Номер заказа: {orderId}.",components:{moneyTag:(0,f.jsx)(aY,{})},values:{money:i.toStringWithCurrency(),orderId:n}})})}},sa={title:function(){let{t:e}=(0,v.$G)();return(0,f.jsx)(f.Fragment,{children:e("Отключение рекламы")})},body:function(){let{t:e}=(0,v.$G)();return(0,f.jsx)("p",{children:e("Отключение рекламы в приложении \xabЧитай бесплатно\xbb.")})}},ss={title:function(){let{t:e}=(0,v.$G)();return(0,f.jsx)(f.Fragment,{children:e("Начисления по партнерской программе")})},extraHeader:function(e){let{operation:t}=e,{specificData:n}=t;return(0,f.jsxs)(aY,{children:["+",n.money.toStringWithCurrency()]})}},sr={title:function(){let{t:e}=(0,v.$G)();return(0,f.jsx)(f.Fragment,{children:e("Начисления за рекомендацию другу")})},extraHeader:function(e){let{operation:t}=e,{specificData:n}=t;return(0,f.jsxs)(aY,{children:["+",n.money.toStringWithCurrency()]})}},sl={title:function(){let{t:e}=(0,v.$G)();return(0,f.jsx)(f.Fragment,{children:e("Запрос на вывод средств")})},body:function(e){let{operation:t}=e,{specificData:n}=t;return(0,f.jsx)("p",{children:(0,f.jsx)(v.cC,{i18nKey:"Сумма заявки <moneyTag>{money}</moneyTag>.",components:{moneyTag:(0,f.jsx)(aY,{})},values:{money:n.money.toStringWithCurrency()}})})}};function s_(e){let{specificData:t}=e,{isAppliedPromocode:n,tariffDuration:i,purchaseOrigin:o}=t;return(0,f.jsxs)("p",{children:[(0,f.jsx)(sc,{specificData:t})," ",(0,f.jsx)(sm,{isAppliedPromocode:n})," ",(0,f.jsx)(sp,{purchaseOrigin:o})," ",(0,f.jsx)(sf,{tariffDuration:i})," ",(0,f.jsx)(sh,{giftMonths:t.giftMonths})]})}function sc(e){let{specificData:t}=e;return t.isPurchase?(0,f.jsx)(sd,{specificData:t}):(0,f.jsx)(su,{specificData:t})}function sd(e){let{specificData:t}=e,{product:n,isTrial:i}=t,{t:o}=(0,v.$G)();return"litres_subscription"===n&&i?(0,f.jsx)(f.Fragment,{children:o("Покупка пробной подписки")}):"abonement"===n?(0,f.jsx)(f.Fragment,{children:o("Покупка абонемента")}):(0,f.jsx)(f.Fragment,{children:o("Покупка подписки")})}function su(e){let{specificData:t}=e,{product:n}=t,{t:i}=(0,v.$G)();return"abonement"===n?(0,f.jsx)(f.Fragment,{children:i("Продление абонемента")}):(0,f.jsx)(f.Fragment,{children:i("Продление подписки")})}function sm(e){let{isAppliedPromocode:t}=e,{t:n}=(0,v.$G)();return(0,f.jsx)(f.Fragment,{children:t?n("по промокоду"):null})}function sp(e){let{purchaseOrigin:t}=e;return null==t||"integration"===t?null:(0,f.jsxs)(f.Fragment,{children:["(",t,")"]})}function sf(e){let{tariffDuration:t}=e;return t?(0,f.jsxs)(f.Fragment,{children:["(",(0,f.jsx)(v.cC,{i18nKey:"{duration} мес.",values:{duration:t}}),")"]}):null}function sh(e){let{giftMonths:t}=e;return t?(0,f.jsxs)(f.Fragment,{children:["+ ",(0,f.jsx)(v.cC,{i18nKey:"{giftMonths} мес. в подарок",values:{giftMonths:t}})]}):null}s_.Operation=sc;let sb={title:function(e){let{operation:t}=e,{specificData:n}=t;return(0,f.jsx)(s_.Operation,{specificData:n})},body:function(e){let{operation:t}=e;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(s_,{specificData:t.specificData}),t.specificData.hasReceipt&&(0,f.jsx)(aH,{moneyMovementId:t.moneyMovementId})]})}},sx={title:function(e){let{operation:t}=e,{specificData:n}=t,{t:i}=(0,v.$G)(),o=i("abonement"===n.product?"Абонемент отключен":"Подписка отключена");return(0,f.jsx)(f.Fragment,{children:o})}},sv=e=>{if(e instanceof aI)return{title:(0,f.jsx)(aZ.title,{}),extraHeader:(0,f.jsx)(aZ.extraHeader,{operation:e}),body:(0,f.jsx)(aZ.body,{operation:e})};if(e instanceof aT)return{title:(0,f.jsx)(a0.title,{operation:e}),extraHeader:(0,f.jsx)(a0.extraHeader,{operation:e}),body:(0,f.jsx)(a0.body,{operation:e})};if(e instanceof aM)return{title:(0,f.jsx)(sb.title,{operation:e}),body:(0,f.jsx)(sb.body,{operation:e})};if(e instanceof aA)return{title:(0,f.jsx)(a9.title,{}),body:(0,f.jsx)(a9.body,{operation:e})};if(e instanceof aR)return{title:(0,f.jsx)(a5.title,{operation:e}),body:(0,f.jsx)(a5.body,{operation:e})};if(e instanceof aO)return{title:(0,f.jsx)(si.title,{operation:e}),body:(0,f.jsx)(si.body,{operation:e})};if(e instanceof aW)return{title:(0,f.jsx)(sx.title,{operation:e})};if(e instanceof aC)return{title:(0,f.jsx)(a3.title,{}),extraHeader:(0,f.jsx)(a3.extraHeader,{operation:e}),body:(0,f.jsx)(a3.body,{operation:e})};if(e instanceof aD)return{title:(0,f.jsx)(so.title,{}),body:(0,f.jsx)(so.body,{operation:e})};if(e instanceof aL)return{title:(0,f.jsx)(sa.title,{}),body:(0,f.jsx)(sa.body,{})};if(e instanceof aB)return{title:(0,f.jsx)(ss.title,{}),extraHeader:(0,f.jsx)(ss.extraHeader,{operation:e})};if(e instanceof aG)return{title:(0,f.jsx)(sr.title,{}),extraHeader:(0,f.jsx)(sr.extraHeader,{operation:e})};if(e instanceof aF)return{title:(0,f.jsx)(sl.title,{}),body:(0,f.jsx)(sl.body,{operation:e})};if(e instanceof aP)return{title:(0,f.jsx)(a4.title,{operation:e}),body:(0,f.jsx)(a4.body,{})};throw Error("unknown operation")},sg=e=>{let{userHistory:t}=e;return(0,f.jsx)("section",{children:t.operations.map(e=>(0,f.jsx)(aK,{operation:e,specificOperationUi:sv(e)},e.moneyMovementId))})};var sj=n(48883),sN=n.n(sj);let sy=()=>{let{t:e}=(0,v.$G)();return(0,f.jsxs)("section",{className:sN().root,children:[(0,f.jsx)("h3",{className:sN().title,children:e("Пока ничего нет")}),(0,f.jsx)("p",{className:sN().description,children:e("Тут будет история ваших операций")})]})};var sk=n(36511),sE=n.n(sk);let sS=()=>{let{t:e}=(0,v.$G)(),{data:t,isLoading:n,isFetching:i,isError:o,pagination:a}=function(){var e;let t=(0,y.TL)(),[n,i]=(0,h.useState)(),{data:o,isLoading:a,isFetching:s,isError:r}=y.cM.useGetUserOperationsQuery({limit:50,offset:n});return(0,h.useEffect)(()=>()=>{setTimeout(()=>{t(y.cM.util.invalidateTags(["UserOperations"]))})},[t]),{data:(0,h.useMemo)(()=>{if(!o)return null;{let{data:e}=o;return new aq(e)}},[o]),isLoading:a,isFetching:s,isError:r,pagination:{isLastPage:(null==o?void 0:null===(e=o.pagination)||void 0===e?void 0:e.next_page)===null,onNextPage:()=>{var e;(null==o?void 0:null===(e=o.pagination)||void 0===e?void 0:e.next_page)&&i(function(e){let t=new URLSearchParams(e).get("offset");if(t)return parseInt(t,10)}(o.pagination.next_page))}}}}();return n?(0,f.jsx)(Q,{}):o||null==t?(0,f.jsx)(ee.b,{mode:ee.p.error,children:e("Не удалось загрузить историю")}):0===t.operations.length?(0,f.jsx)(sy,{}):(0,f.jsxs)("div",{children:[(0,f.jsx)(sg,{userHistory:t}),!a.isLastPage&&(0,f.jsx)("div",{className:sE().pagination,children:(0,f.jsx)(eA.z,{mode:"secondary",size:"medium",text:e("Показать ещё"),loading:i,fullWidth:!0,onClick:()=>{a.onNextPage()}})})]})};class sP{constructor(e){this.reward=new aw.W(e.reward,"RUB"),this.paidAt=new Date(e.paid_at),this.art=e.art}}class sw{constructor(e){this.items=e.map(e=>new sP(e))}}var sT=n(30743),sC=n.n(sT);let sI=e=>{let{referralInfo:t}=e,{t:n,i18n:i}=(0,v.$G)(),{reward:o,art:a,paidAt:s}=t;return(0,f.jsxs)("article",{className:sC().card,children:[(0,f.jsxs)("header",{className:sC().header,children:[(0,f.jsx)("h4",{className:sC().title,children:n("Друг купил книгу")}),(0,f.jsx)("span",{className:sC().money,children:(0,f.jsx)("data",{value:o.value,children:"+".concat(o.toStringWithCurrency())})})]}),(0,f.jsxs)("div",{className:sC().body,children:[(0,f.jsx)(oq.uq,{wrapperClassName:sC().cover,artId:a.id,alt:a.title}),(0,f.jsx)("span",{className:sC().artTitle,children:(0,f.jsx)(k.I,{href:"/".concat(a.id),children:a.title})})]}),(0,f.jsx)("footer",{className:sC().footer,children:(0,f.jsx)("time",{className:sC().time,children:s.toLocaleDateString(i.language)})})]})};var sA=n(28914),sR=n.n(sA);let sO=e=>{let{referralPurchaseHistory:t}=e,{t:n}=(0,v.$G)();return(0,f.jsxs)("section",{children:[(0,f.jsx)("p",{className:sR().description,children:n("История начислений за покупки друзей по вашей персональной ссылке")}),t.items.map(e=>(0,f.jsx)(sI,{referralInfo:e},e.art.id))]})};var sD=n(85834),sL=n.n(sD);let sB=()=>{let{t:e}=(0,v.$G)(),t=(0,W.Gc)("breakpoint-700");return(0,f.jsxs)("section",{className:sL().root,children:[(0,f.jsx)("h3",{className:sL().title,children:e("Пока ничего нет")}),(0,f.jsx)("p",{className:sL().description,children:e("Тут будет история начислений за покупки друзей по вашей персональной ссылке")}),(0,f.jsx)(eA.z,{className:sL().link,size:t?"small":"medium",mode:"secondary",text:e("Узнать подробности"),href:"/kniga-drugu/",targetBlank:!0})]})};var sG=n(1914),sF=n.n(sG);let sM=()=>{let{t:e}=(0,v.$G)(),{data:t,isLoading:n,isFetching:i,isError:o,pagination:a}=function(){var e;let t=(0,y.TL)(),[n,i]=(0,h.useState)(),{data:o,isLoading:a,isFetching:s,isError:r}=y.Lu.useGetFoundationUserReferralPurchaseQuery({limit:50,offset:n});return(0,h.useEffect)(()=>()=>{setTimeout(()=>{t(y.Lu.util.invalidateTags(["UserReferrals"]))})},[t]),{data:(0,h.useMemo)(()=>{if(!o)return null;{let{data:e}=o;return new sw(e)}},[o]),isLoading:a,isFetching:s,isError:r,pagination:{isLastPage:(null==o?void 0:null===(e=o.pagination)||void 0===e?void 0:e.next_page)===null,onNextPage:()=>{var e;(null==o?void 0:null===(e=o.pagination)||void 0===e?void 0:e.next_page)&&i(function(e){let t=new URLSearchParams(e).get("offset");if(t)return parseInt(t,10)}(o.pagination.next_page))}}}}();return n?(0,f.jsx)(Q,{}):o||null==t?(0,f.jsx)(ee.b,{mode:ee.p.error,children:e("Не удалось загрузить историю")}):0===t.items.length?(0,f.jsx)(sB,{}):(0,f.jsxs)("div",{children:[(0,f.jsx)(sO,{referralPurchaseHistory:t}),!a.isLastPage&&(0,f.jsx)("div",{className:sF().pagination,children:(0,f.jsx)(eA.z,{mode:"secondary",size:"medium",text:e("Показать ещё"),loading:i,fullWidth:!0,onClick:()=>{a.onNextPage()}})})]})};var sW=n(95568),sU=n(70736),sq=n.n(sU);let sz=()=>{let e=(0,M.useRouter)(),t=(0,to.n)();return(0,f.jsx)("div",{className:sq().wrapper,children:(0,f.jsx)(sW.a,{className:sq().deviceConnect,title:"Подключение устройства",description:"Введите код, который вы видите на экране вашего устройства",onConnectSuccess:()=>{t({mode:"success",title:"Устройство подключено",message:"Теперь вы можете читать и слушать книги на вашем устройстве",showIcon:!0,isFullWidth:!0}),e.replace("/me/devices/")}})})},sV=()=>{let{t:e}=(0,v.$G)(),t=(0,W.uH)(),n=(0,M.useRouter)(),i=(0,g.usePathname)(),[o,a]=n.query.slug,s=(0,y.CG)(e=>e.browser.headers["client-host"]),r={...(0,C.Sg)(s)?{[c.PROFILE]:{name:e("Вход и безопасность"),component:(0,f.jsx)(iW,{})}}:{[c.PROFILE]:{name:e("Главная"),component:(0,f.jsx)(tn,{}),eventName:d.openMain}},[c.PROFILE_EDIT]:{name:e("Редактировать профиль"),component:(0,f.jsx)(tw,{}),eventName:d.openEditAccount},[c.BONUSES]:{name:e("Бонусный счёт"),component:(0,f.jsx)(oF,{}),eventName:d.openBonuses},[c.SUBSCRIPTION]:{name:e("Управление подпиской"),component:(0,f.jsx)(nO,{})},[c.ABONEMENT]:{name:e("Управление абонементом"),component:(0,f.jsx)(ie,{})},[c.CREDENTIALS]:{name:e("Вход и безопасность"),component:(0,f.jsx)(iW,{})},[c.HELP]:{name:e("Помощь"),component:(0,f.jsx)(iK,{}),eventName:d.openSupport},[c.HELPDESK]:{name:e("Служба поддержки"),component:(0,f.jsx)(i1,{})},[c.LIBRARIES]:{name:e("Мои библиотеки"),component:(0,f.jsx)(on,{})},[c.NOTIFICATIONS]:{name:e("Уведомления"),component:(0,f.jsx)(o3,{}),headerLink:{text:e("Настройки рассылок"),href:c.NOTIFICATIONS_SETTINGS,icon:{name:"mail",size:16}},eventName:d.openNotifications},[c.NOTIFICATIONS_SETTINGS]:{name:e("Настройки рассылок"),component:(0,f.jsx)(o2,{})},[c.OFFERS]:{name:e("Промокоды и акции"),component:(0,f.jsx)(as,{}),eventName:d.openPromotions},[c.PAYMENT]:{name:e("Платежи"),component:(0,f.jsx)(aE,{}),eventName:d.openPayments},[c.PAYMENT_HISTORY]:{name:e("История операций"),component:(0,f.jsx)(sS,{})},[c.PAYMENT_REFERRAL]:{name:e("Покупки друзей"),component:(0,f.jsx)(sM,{})},[c.DEVICES]:{name:e("Мои устройства"),component:null},[c.CONNECT_DEVICE]:{name:e("Мои устройства"),component:(0,f.jsx)(sz,{})}},l=r[i],_={href:z(i,s),title:r[z(i,s)].name};return{rootPath:o,subPath:a,pushLocation:(e,i)=>{e.preventDefault(),t&&window.scrollTo({left:0,top:0,behavior:"smooth"}),n.push(i,void 0,{shallow:!0})},profileRoutes:r,currentRoute:l,linkBack:_}},sK=()=>{let{pushLocation:e,profileRoutes:t}=sV(),{userNameToDisplay:n,avatarURL:i,isAvatarPresent:o,userDescription:a,isSubscriptionActive:s,userSettings:r}=F(),l=(0,y.CG)(e=>e.foundationUser.id),_=(0,W.oh)({hasAvatar:o,size:500,hash:"",imageURL:null!=i?i:"",defaultIcon:tr,shouldShowAvatar:(null==r?void 0:r.profile_privacy)!=="closed",userId:l});return(0,f.jsxs)("div",{className:ts().block,children:[(0,f.jsx)("div",{className:N()(ts().block__avatar,{[ts().block__avatar_subscr]:s}),children:(0,f.jsx)("div",{className:ts().block__avatar__img,"data-testid":"profile__avatarMain",children:(0,f.jsx)("img",{src:_,alt:"User Picture"})})}),(0,f.jsxs)(k.I,{className:ts().block__content,href:c.PROFILE_EDIT,title:t[c.PROFILE_EDIT].name,onClick:t=>{e(t,c.PROFILE_EDIT)},children:[(0,f.jsxs)("div",{className:ts().block__name,children:[(0,f.jsx)("div",{className:ts().name,"data-testid":"profile__userNameMain",children:n}),(0,f.jsx)(E.uQ,{name:"chevronRight",size:16,className:ts().icon})]}),a&&(0,f.jsx)("div",{className:ts().block__descr,"data-testid":"profile__userDescriptionMain",children:a})]})]})},sH=()=>{let[e,{isLoading:t}]=y.iJ.useLogoutMutation(),[n,i]=(0,h.useState)(!1);return{handleLogout:(0,h.useCallback)(()=>{i(!0),e().unwrap().then(()=>{["last_search","user_id","LKS_LAST","LKS","BSK","BSK_LAST","safemode","cookie-agreement","SID","promocode","is_phone_asked","is_email_asked","is_email_confirm_asked","is_phone_confirm_asked","is_merge_users_asked","litres_adv_cookie"].forEach(e=>{(0,C.kT)(e)}),window.history.pushState(null,"","/auth/login/"),window.location.href="/"}).catch(e=>{(0,iT.N)("BackendInteractionError","Error during calling logout endpoint",{originalError:e}).emit()})},[e]),isLogoutLoading:t||n}};var sQ=n(9393),s$=n.n(sQ);let sY=()=>{let{t:e}=(0,v.$G)(),t=(0,g.usePathname)(),{handleLogout:n}=sH(),{pushLocation:i,profileRoutes:o}=sV(),a=J(),{analyticsParams:s,unreadNotificationsCount:r}=F(),l=q((0,y.CG)(e=>e.browser.headers["client-host"])),[_,u]=(0,h.useState)(!1),m=()=>{u(!1)};return(0,f.jsxs)("ul",{className:N()(s$().menuList,{[s$().menuList_mobile]:a}),"data-testid":"profile__menu--wrapper",children:[l.map(e=>(0,f.jsx)("li",{className:s$().menuList__item,"data-testid":"profile__menuItem",children:(0,f.jsxs)(k.I,{href:e,className:N()(s$().menuList__link,{[s$().menuList__link_active]:t.includes(e),[s$().menuList__link_main]:e===l[0]}),onClick:t=>{i(t,e)},children:[o[e].name,e===c.NOTIFICATIONS&&!!r&&(0,f.jsx)("div",{className:s$().countBubble,children:r>99?"99+":r}),(0,f.jsx)(E.uQ,{name:"chevronRight",size:24,className:s$().menuList__link__icon})]})},e)),(0,f.jsxs)("li",{className:s$().menuList__item,children:[(0,f.jsx)("button",{onClick:()=>{eX({eventType:d.openExit,params:s}),u(!0)},className:N()(s$().menuList__link,s$().menuList__link_logout),"data-testid":"profile__logout--button",children:e("Выход")}),(0,f.jsx)(ep.u_,{isOpen:_,onClose:m,title:e("Подтвердите"),closeOnClickOutside:!0,primaryButton:{label:e("Выйти"),onClick:n},secondaryButton:{label:e("Отмена"),onClick:m},e2eId:"profile__logoutModal--wrapper",children:e("Вы уверены, что хотите выйти из своего аккаунта?")})]},"logout")]})};var sZ=n(65642),sJ=n(29263),sX=n.n(sJ);let s0=()=>{let{t:e}=(0,v.$G)(),t=(0,g.usePathname)(),{isError:n,error:i}=y.r7.useGetFoundationUserDetailedInfoQuery(),{analyticsParams:o,isLoading:a}=F(),{pushLocation:s,linkBack:r,currentRoute:{name:l,component:_,headerLink:d,eventName:u}}=sV(),m=J(),p=q((0,y.CG)(e=>e.browser.headers["client-host"])),b=t===c.BONUSES;return((0,sZ.A)(),(0,h.useEffect)(()=>{u&&!a&&eX({eventType:u,params:o})},[u,a]),a)?(0,f.jsx)(Q,{}):n&&403===i.status?(0,f.jsx)(T,{}):(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(x(),{children:(0,f.jsxs)("title",{children:[e("Личный кабинет"),": ",l]})}),(0,f.jsxs)("div",{className:N()(sX().wrapper,{[sX().wrapper_main]:t===p[0],[sX().wrapper_mobile]:m}),children:[(0,f.jsx)("div",{className:sX().profile,children:(0,f.jsx)(sK,{})}),(0,f.jsxs)("div",{className:sX().content,children:[t!==p[0]&&!b&&(0,f.jsxs)("h2",{className:sX().content__title,"data-testid":"profile__help--title",children:[(0,f.jsx)(k.I,{className:sX().content__title__linkBack,href:r.href,title:r.title,onClick:e=>{s(e,r.href)},children:(0,f.jsx)(E.uQ,{name:"arrowBack",size:24})}),(0,f.jsx)("div",{className:sX().content__title__text,children:l}),d&&(0,f.jsx)("div",{className:sX().content__title__headerLink,children:(0,f.jsxs)(S.Fg,{href:d.href,onClick:e=>{s(e,d.href)},children:[d.icon&&(0,f.jsx)(E.uQ,{...d.icon,className:sX().content__title__headerLink__icon}),d.text]})})]}),(0,f.jsx)(to.J,{children:n?(0,f.jsx)(tO,{}):_})]}),(0,f.jsx)("nav",{className:sX().menu,"aria-label":e("Меню Личного кабинета"),children:(0,f.jsx)(sY,{})})]})]})};var s1=!0,s3=()=>{let{t:e}=(0,v.$G)();return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(x(),{children:(0,f.jsx)("title",{children:e("Личный кабинет")})}),(0,f.jsx)(s0,{})]})}},57628:function(e,t,n){"use strict";n.d(t,{U:function(){return d}});var i=n(31549),o=n(44194),a=n(51865),s=n.n(a),r=n(4438),l=n(99442),_=n.n(l);let c=e=>{let{children:t}=e;return(0,i.jsx)("div",{className:_().accordion,children:o.Children.map(t,e=>o.isValidElement(e)?o.cloneElement(e,{}):e)})};c.Item=e=>{let{title:t,children:n,classes:a={},manualToggleSettings:l,isOpenedByDefault:c=!1,chevronPosition:d="right",withCollapsingLogic:u=!0}=e,[m,p]=(0,o.useState)(c),f=()=>{p(!m)},h=l?l.isActive:m;return(0,i.jsxs)("div",{className:s()(_().accordion__item,null==a?void 0:a.root,{[_().notCollapsible]:!u}),onClick:function(e){u&&(l?l.onClick(e):f())},children:[(0,i.jsxs)("div",{className:s()(_().accordion__item__Header,{[_().accordion__item__Header_reverseOrder]:"left"===d}),children:[(0,i.jsx)("div",{className:s()(_().accordion__item__Title,a.title),"data-testid":"accordionItem__title",children:t}),(0,i.jsx)(r.uQ,{name:h?"chevronUp":"chevronDown",className:s()(_().chevronIcon,a.chevronIcon),size:16})]}),h&&(0,i.jsx)("div",{className:s()(_().accordion__item__Content,a.content),"data-testid":"accordionItem__content",children:n})]})};var d=c},72835:function(e,t,n){"use strict";n.d(t,{u:function(){return r}});var i=n(31549),o=n(39319);n(44194);var a=n(98467),s=n.n(a);let r=e=>(0,i.jsxs)("div",{className:s().empty,"data-testid":e.e2eId,children:[e.title&&(0,i.jsx)("h2",{className:s().empty__title,children:e.title}),(0,i.jsx)("div",{className:s().empty__content,children:e.children}),(e.mainButton||e.secondButton)&&(0,i.jsxs)("div",{className:s().empty__controls,children:[e.mainButton&&(0,i.jsx)(o.z,{mode:"secondary",size:"small",onClick:e.mainButton.onClick,href:e.mainButton.href,text:e.mainButton.label}),e.secondButton&&(0,i.jsx)(o.z,{mode:"tertiary",size:"small",onClick:e.secondButton.onClick,href:e.secondButton.href,text:e.secondButton.label})]})]})},8725:function(e,t,n){"use strict";n.d(t,{h:function(){return r}});var i=n(44194),o=n(79018),a=n.n(o);let s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{__html:a().sanitize(e,t)}},r=(0,i.forwardRef)((e,t)=>{let{tag:n="div",html:o,options:a,className:r,dataTestId:l}=e;return(0,i.createElement)(n,{ref:t,dangerouslySetInnerHTML:s(o,null!=a?a:{}),className:r,"data-testid":l})});r.displayName="SanitizeHTML"},51640:function(e,t,n){"use strict";n.d(t,{T:function(){return _}});var i=n(31549);n(44194);var o=n(51865),a=n.n(o),s=n(67308),r=n.n(s),l=n(67504);let _=e=>{let{checked:t=!1,disabled:n=!1,onChange:o,wrapperClassName:s,..._}=e,{t:c}=(0,l.b)();return(0,i.jsx)("div",{className:s,children:(0,i.jsxs)("div",{className:a()(r().toggleWrapper,{[r().toggleWrapper_checked]:t,[r().toggleWrapper_disabled]:n}),"data-testid":"filter_type--switcher",onClick:o,onKeyDown:e=>{" "!==e.key||(e.preventDefault(),e.stopPropagation(),n||null==o||o())},role:"switch","aria-checked":t,"aria-hidden":n,tabIndex:0,..._,children:[(0,i.jsx)("span",{role:"status","aria-live":"polite",className:r().hidden,children:c(t?"Выбран":"Не выбран")}),(0,i.jsx)("div",{className:r().toggle})]})})}},23704:function(e){e.exports={hidden:"DeviceConnect-module__ySD0Fa__hidden",field:"DeviceConnect-module__ySD0Fa__field",header:"DeviceConnect-module__ySD0Fa__header"}},37055:function(e){e.exports={form:"PromocodeActivation-module__sYTxeq__form"}},42161:function(e){e.exports={credentialButton:"CredentialItem-module__EnFOuG__credentialButton"}},49596:function(e){e.exports={heading:"ProfileLoginPage-module__45RBLa__heading",wrapper:"ProfileLoginPage-module__45RBLa__wrapper"}},94407:function(e){e.exports={networkItem__networkIcon:"SocialNetworks-module__iCtOaa__networkItem__networkIcon",networkItemWrapper:"SocialNetworks-module__iCtOaa__networkItemWrapper",networkItem__iconWrapper:"SocialNetworks-module__iCtOaa__networkItem__iconWrapper",networkItem:"SocialNetworks-module__iCtOaa__networkItem",networkItem__networkName:"SocialNetworks-module__iCtOaa__networkItem__networkName",networkItem__icon:"SocialNetworks-module__iCtOaa__networkItem__icon",addNetwork:"SocialNetworks-module__iCtOaa__addNetwork",networkItemWrapper__restrictedLabel:"SocialNetworks-module__iCtOaa__networkItemWrapper__restrictedLabel",networkItem__nameBonus:"SocialNetworks-module__iCtOaa__networkItem__nameBonus",bonusWrapper:"SocialNetworks-module__iCtOaa__bonusWrapper"}},13886:function(e){e.exports={credentialPlaceholder_mobileOrTablet:"UserCredentialPlaceholder-module__WhNNPG__credentialPlaceholder_mobileOrTablet",credentialPlaceholder:"UserCredentialPlaceholder-module__WhNNPG__credentialPlaceholder",credentialPlaceholder_desktop:"UserCredentialPlaceholder-module__WhNNPG__credentialPlaceholder_desktop"}},46735:function(e){e.exports={credentials__verification:"UserInformation-module__ck710q__credentials__verification",credentials__content:"UserInformation-module__ck710q__credentials__content",credentials__value:"UserInformation-module__ck710q__credentials__value",credentials__verification_notVerified:"UserInformation-module__ck710q__credentials__verification_notVerified",credentials__label:"UserInformation-module__ck710q__credentials__label",credentials__contentWrapper:"UserInformation-module__ck710q__credentials__contentWrapper",credentials__item:"UserInformation-module__ck710q__credentials__item",credentials__verification__value:"UserInformation-module__ck710q__credentials__verification__value"}},63066:function(e){e.exports={form__input_lastName:"ProfileEdit-module__cFTzDa__form__input_lastName",nickname:"ProfileEdit-module__cFTzDa__nickname",container:"ProfileEdit-module__cFTzDa__container",form__input_nickname:"ProfileEdit-module__cFTzDa__form__input_nickname",form__button:"ProfileEdit-module__cFTzDa__form__button",switcher__text:"ProfileEdit-module__cFTzDa__switcher__text",button:"ProfileEdit-module__cFTzDa__button",switcher__title:"ProfileEdit-module__cFTzDa__switcher__title",avatar:"ProfileEdit-module__cFTzDa__avatar",switcher:"ProfileEdit-module__cFTzDa__switcher",description:"ProfileEdit-module__cFTzDa__description",avatar__button:"ProfileEdit-module__cFTzDa__avatar__button",form__input_description:"ProfileEdit-module__cFTzDa__form__input_description",form__input_birthday:"ProfileEdit-module__cFTzDa__form__input_birthday",avatar__loader:"ProfileEdit-module__cFTzDa__avatar__loader",last_name:"ProfileEdit-module__cFTzDa__last_name",form__input:"ProfileEdit-module__cFTzDa__form__input",text:"ProfileEdit-module__cFTzDa__text",form__input_firstName:"ProfileEdit-module__cFTzDa__form__input_firstName",form:"ProfileEdit-module__cFTzDa__form",first_name:"ProfileEdit-module__cFTzDa__first_name",birthday:"ProfileEdit-module__cFTzDa__birthday"}},51208:function(e){e.exports={book:"FourthArtsOffer-module__Yb0qSq__book",divider:"FourthArtsOffer-module__Yb0qSq__divider",bookImage:"FourthArtsOffer-module__Yb0qSq__bookImage",info:"FourthArtsOffer-module__Yb0qSq__info",title:"FourthArtsOffer-module__Yb0qSq__title",books__card:"FourthArtsOffer-module__Yb0qSq__books__card",countdownWrapper:"FourthArtsOffer-module__Yb0qSq__countdownWrapper",description:"FourthArtsOffer-module__Yb0qSq__description",books:"FourthArtsOffer-module__Yb0qSq__books",countdownWrapper__button:"FourthArtsOffer-module__Yb0qSq__countdownWrapper__button",countdownWrapper__left:"FourthArtsOffer-module__Yb0qSq__countdownWrapper__left",container:"FourthArtsOffer-module__Yb0qSq__container",book_empty:"FourthArtsOffer-module__Yb0qSq__book_empty",countdownWrapper__right:"FourthArtsOffer-module__Yb0qSq__countdownWrapper__right",link:"FourthArtsOffer-module__Yb0qSq__link",countdown:"FourthArtsOffer-module__Yb0qSq__countdown"}},30536:function(e){e.exports={root:"SavedPaymentMethodLine-module__W1OckW__root",root__icon:"SavedPaymentMethodLine-module__W1OckW__root__icon",root__text:"SavedPaymentMethodLine-module__W1OckW__root__text",root__label:"SavedPaymentMethodLine-module__W1OckW__root__label"}},52010:function(e){e.exports={description:"CumulativeDiscountDescription-module__kDwlKW__description"}},24661:function(e){e.exports={errorMsg:"CumulativeDiscountDisclaimer-module__k0644G__errorMsg"}},6769:function(e){e.exports={discountList:"CumulativeDiscountProgress-module__TmnW4a__discountList",currentDiscount:"CumulativeDiscountProgress-module__TmnW4a__currentDiscount",discountList__item:"CumulativeDiscountProgress-module__TmnW4a__discountList__item",discount:"CumulativeDiscountProgress-module__TmnW4a__discount",discount__label:"CumulativeDiscountProgress-module__TmnW4a__discount__label",discount_current:"CumulativeDiscountProgress-module__TmnW4a__discount_current",discount__percent:"CumulativeDiscountProgress-module__TmnW4a__discount__percent"}},1312:function(e){e.exports={collection__amount:"AvailableArts-module__IKQ3wW__collection__amount",root:"AvailableArts-module__IKQ3wW__root",text__subtitle:"AvailableArts-module__IKQ3wW__text__subtitle",text__description:"AvailableArts-module__IKQ3wW__text__description",collection__button:"AvailableArts-module__IKQ3wW__collection__button"}},77053:function(e){e.exports={artsList:"ArtIssuanceOperationInfo-module__BZkwfG__artsList",artTitle:"ArtIssuanceOperationInfo-module__BZkwfG__artTitle",spendingsListItem:"ArtIssuanceOperationInfo-module__BZkwfG__spendingsListItem",coverImage:"ArtIssuanceOperationInfo-module__BZkwfG__coverImage",spendingMoney:"ArtIssuanceOperationInfo-module__BZkwfG__spendingMoney",art:"ArtIssuanceOperationInfo-module__BZkwfG__art",cover:"ArtIssuanceOperationInfo-module__BZkwfG__cover"}},54767:function(e){e.exports={art:"LibraryOperationInfo-module__7iqMAa__art",artsList:"LibraryOperationInfo-module__7iqMAa__artsList",cover:"LibraryOperationInfo-module__7iqMAa__cover",coverImage:"LibraryOperationInfo-module__7iqMAa__coverImage",artTitle:"LibraryOperationInfo-module__7iqMAa__artTitle"}},20415:function(e){e.exports={money:"Money-module__ye0oSW__money"}},55587:function(e){e.exports={money:"OperationCard-module__OTD2lG__money",header:"OperationCard-module__OTD2lG__header",card:"OperationCard-module__OTD2lG__card",body:"OperationCard-module__OTD2lG__body",date:"OperationCard-module__OTD2lG__date",footer:"OperationCard-module__OTD2lG__footer",title:"OperationCard-module__OTD2lG__title"}},54417:function(e){e.exports={header__subText:"ProfilePaymentSelector-module__hmIrjq__header__subText",alert:"ProfilePaymentSelector-module__hmIrjq__alert",header:"ProfilePaymentSelector-module__hmIrjq__header",header__label:"ProfilePaymentSelector-module__hmIrjq__header__label"}},90643:function(e){e.exports={root:"SavedPaymentMethodItem-module__vKl3Uq__root",deleteIcon:"SavedPaymentMethodItem-module__vKl3Uq__deleteIcon",root__actions:"SavedPaymentMethodItem-module__vKl3Uq__root__actions",savedPaymentMethodDetails:"SavedPaymentMethodItem-module__vKl3Uq__savedPaymentMethodDetails",root__data:"SavedPaymentMethodItem-module__vKl3Uq__root__data",linkingInfo:"SavedPaymentMethodItem-module__vKl3Uq__linkingInfo",root__message:"SavedPaymentMethodItem-module__vKl3Uq__root__message"}},40994:function(e){e.exports={noPaymentMethods:"SavedPaymentMethods-module__LB-NTa__noPaymentMethods",retryButton:"SavedPaymentMethods-module__LB-NTa__retryButton",icon:"SavedPaymentMethods-module__LB-NTa__icon"}},30743:function(e){e.exports={card:"ReferralPurchaseCard-module__EjJp9a__card",title:"ReferralPurchaseCard-module__EjJp9a__title",money:"ReferralPurchaseCard-module__EjJp9a__money",artTitle:"ReferralPurchaseCard-module__EjJp9a__artTitle",cover:"ReferralPurchaseCard-module__EjJp9a__cover",header:"ReferralPurchaseCard-module__EjJp9a__header",time:"ReferralPurchaseCard-module__EjJp9a__time",body:"ReferralPurchaseCard-module__EjJp9a__body",footer:"ReferralPurchaseCard-module__EjJp9a__footer"}},28914:function(e){e.exports={description:"ReferralHistory-module__QM98yq__description"}},74790:function(e){e.exports={discount:"Discount-module__YsGZcG__discount",discount_active:"Discount-module__YsGZcG__discount_active"}},92911:function(e){e.exports={cards_notActive:"SubscriptionProductMainInfo-module__A6iW_a__cards_notActive",cards__discount:"SubscriptionProductMainInfo-module__A6iW_a__cards__discount",cards:"SubscriptionProductMainInfo-module__A6iW_a__cards"}},10762:function(e){e.exports={card:"SubscriptionProductCard-module__hLU2kq__card",card__plan:"SubscriptionProductCard-module__hLU2kq__card__plan",card__description:"SubscriptionProductCard-module__hLU2kq__card__description",status:"SubscriptionProductCard-module__hLU2kq__status",card__actions:"SubscriptionProductCard-module__hLU2kq__card__actions",card__title:"SubscriptionProductCard-module__hLU2kq__card__title"}},51939:function(e){e.exports={button:"Action-module__hfcEWa__button",button_light:"Action-module__hfcEWa__button_light"}},77789:function(e){e.exports={status_active:"Status-module__NQ8oRq__status_active",status_active_in_grace:"Status-module__NQ8oRq__status_active_in_grace",status_off:"Status-module__NQ8oRq__status_off",status:"Status-module__NQ8oRq__status"}},52601:function(e){e.exports={link:"AbonementExclusives-module__J7FYwa__link",description:"AbonementExclusives-module__J7FYwa__description"}},30219:function(e){e.exports={payment__card:"AbonementPaymentMethod-module__9V6AAG__payment__card",payment__card__editBtn:"AbonementPaymentMethod-module__9V6AAG__payment__card__editBtn",payment__button:"AbonementPaymentMethod-module__9V6AAG__payment__button",payment__text:"AbonementPaymentMethod-module__9V6AAG__payment__text"}},71995:function(e){e.exports={title:"ArtsUserCanTake-module__6p0I8q__title",renewAtBlock:"ArtsUserCanTake-module__6p0I8q__renewAtBlock",renewAtBlock__text:"ArtsUserCanTake-module__6p0I8q__renewAtBlock__text",renewLink:"ArtsUserCanTake-module__6p0I8q__renewLink",renewAtBlock_autoRenew:"ArtsUserCanTake-module__6p0I8q__renewAtBlock_autoRenew",collection__amount:"ArtsUserCanTake-module__6p0I8q__collection__amount",anyArts:"ArtsUserCanTake-module__6p0I8q__anyArts",renewAtBlock__economy:"ArtsUserCanTake-module__6p0I8q__renewAtBlock__economy"}},13801:function(e){e.exports={renewAtBlock_autoRenew:"ArtsRenewAtBlock-module__mwgyfG__renewAtBlock_autoRenew",renewAtBlock__text:"ArtsRenewAtBlock-module__mwgyfG__renewAtBlock__text",renewAtBlock__economy:"ArtsRenewAtBlock-module__mwgyfG__renewAtBlock__economy",renewAtBlock:"ArtsRenewAtBlock-module__mwgyfG__renewAtBlock",renewLink:"ArtsRenewAtBlock-module__mwgyfG__renewLink"}},23901:function(e){e.exports={root:"ArtsUserCanTake-module__6Yug8W__root",wrapper:"ArtsUserCanTake-module__6Yug8W__wrapper"}},3107:function(e){e.exports={secondary:"PlanBadge-module__IDMaPW__secondary",badge:"PlanBadge-module__IDMaPW__badge"}},21042:function(e){e.exports={paperDiscount__description:"PaperDiscount-module__yPM1NG__paperDiscount__description",paperDiscount__button_small:"PaperDiscount-module__yPM1NG__paperDiscount__button_small",paperDiscount__button:"PaperDiscount-module__yPM1NG__paperDiscount__button",paperDiscount__image:"PaperDiscount-module__yPM1NG__paperDiscount__image"}},42146:function(e){e.exports={wink__activated__icon:"Wink-module__pepEPG__wink__activated__icon",wink__benefits:"Wink-module__pepEPG__wink__benefits",wink__activated:"Wink-module__pepEPG__wink__activated",errorMsg:"Wink-module__pepEPG__errorMsg"}},75999:function(e){e.exports={button:"SubscriptionGoToBooksButton-module__CbseoG__button",subtitle:"SubscriptionGoToBooksButton-module__CbseoG__subtitle",errorMsg:"SubscriptionGoToBooksButton-module__CbseoG__errorMsg"}},80053:function(e){e.exports={payment__card__editBtn:"SubscriptionPaymentMethod-module__GryqiG__payment__card__editBtn",payment__text:"SubscriptionPaymentMethod-module__GryqiG__payment__text",payment__card:"SubscriptionPaymentMethod-module__GryqiG__payment__card",payment__button:"SubscriptionPaymentMethod-module__GryqiG__payment__button"}},21622:function(e){e.exports={abonementPage__widget:"Abonement-module__-P_9Fa__abonementPage__widget",abonementPage:"Abonement-module__-P_9Fa__abonementPage",abonementPage__autoRenew:"Abonement-module__-P_9Fa__abonementPage__autoRenew",abonementAvailableArts:"Abonement-module__-P_9Fa__abonementAvailableArts",abonementPage__payment:"Abonement-module__-P_9Fa__abonementPage__payment",abonementPage__abonementAvailableArts:"Abonement-module__-P_9Fa__abonementPage__abonementAvailableArts",switcher:"Abonement-module__-P_9Fa__switcher",abonementPage__displayDiscount:"Abonement-module__-P_9Fa__abonementPage__displayDiscount",abonementBlock:"Abonement-module__-P_9Fa__abonementBlock",abonementPage__abonementBlock:"Abonement-module__-P_9Fa__abonementPage__abonementBlock",abonementPage_rebill_working:"Abonement-module__-P_9Fa__abonementPage_rebill_working",button:"Abonement-module__-P_9Fa__button",autoRenew:"Abonement-module__-P_9Fa__autoRenew",payment:"Abonement-module__-P_9Fa__payment",abonementPage__abonementExclusives:"Abonement-module__-P_9Fa__abonementPage__abonementExclusives",displayDiscount:"Abonement-module__-P_9Fa__displayDiscount",subtitle:"Abonement-module__-P_9Fa__subtitle",description:"Abonement-module__-P_9Fa__description",errorMsg:"Abonement-module__-P_9Fa__errorMsg",menuBlock__description:"Abonement-module__-P_9Fa__menuBlock__description",abonementExclusives:"Abonement-module__-P_9Fa__abonementExclusives",abonementPage_active:"Abonement-module__-P_9Fa__abonementPage_active",abonementPage_mobile:"Abonement-module__-P_9Fa__abonementPage_mobile",abonementPage__switcher:"Abonement-module__-P_9Fa__abonementPage__switcher"}},12619:function(e){e.exports={bonusStatus__statusSign:"BonusStatus-module__pnZSaW__bonusStatus__statusSign",bonusStatus__error:"BonusStatus-module__pnZSaW__bonusStatus__error",bonusStatus__content:"BonusStatus-module__pnZSaW__bonusStatus__content",bonusStatus__text:"BonusStatus-module__pnZSaW__bonusStatus__text",bonusStatus__subtext:"BonusStatus-module__pnZSaW__bonusStatus__subtext"}},89510:function(e){e.exports={bonuses__amount:"Bonuses-module__H3OJCG__bonuses__amount",bonuses__inner:"Bonuses-module__H3OJCG__bonuses__inner",bonuses__content_phoneVerified:"Bonuses-module__H3OJCG__bonuses__content_phoneVerified",bonuses__expiration:"Bonuses-module__H3OJCG__bonuses__expiration",bonuses__background:"Bonuses-module__H3OJCG__bonuses__background",bonuses__content:"Bonuses-module__H3OJCG__bonuses__content",bonuses__title:"Bonuses-module__H3OJCG__bonuses__title",bonuses__backLink:"Bonuses-module__H3OJCG__bonuses__backLink",bonuses__getBonuses:"Bonuses-module__H3OJCG__bonuses__getBonuses",bonuses__status:"Bonuses-module__H3OJCG__bonuses__status",bonuses__description:"Bonuses-module__H3OJCG__bonuses__description",bonuses__howItWorks:"Bonuses-module__H3OJCG__bonuses__howItWorks",bonuses__goToShoping:"Bonuses-module__H3OJCG__bonuses__goToShoping",bonuses__welcome:"Bonuses-module__H3OJCG__bonuses__welcome",bonuses:"Bonuses-module__H3OJCG__bonuses"}},58792:function(e){e.exports={bonusesTitle__backLink:"BonusesTitle-module__AgByWG__bonusesTitle__backLink",bonusesTitle:"BonusesTitle-module__AgByWG__bonusesTitle",bonusTitlePhoneVerified:"BonusesTitle-module__AgByWG__bonusTitlePhoneVerified",bonusesTitle__title:"BonusesTitle-module__AgByWG__bonusesTitle__title",bonusTitlePhoneVerified__title:"BonusesTitle-module__AgByWG__bonusTitlePhoneVerified__title"}},87073:function(e){e.exports={brands:"Brands-module__V2-yeq__brands"}},56260:function(e){e.exports={levelContainer:"Card-module__V0NDha__levelContainer",icon__none:"Card-module__V0NDha__icon__none",caption_title:"Card-module__V0NDha__caption_title",caption:"Card-module__V0NDha__caption",progressContainer:"Card-module__V0NDha__progressContainer",progress:"Card-module__V0NDha__progress",rangeContainer:"Card-module__V0NDha__rangeContainer",container:"Card-module__V0NDha__container",levelContainer_icon:"Card-module__V0NDha__levelContainer_icon",price:"Card-module__V0NDha__price",level:"Card-module__V0NDha__level",caption_description:"Card-module__V0NDha__caption_description",innactive:"Card-module__V0NDha__innactive"}},43846:function(e){e.exports={carousel:"CashbackCarousel-module__2Qd4cG__carousel",dot:"CashbackCarousel-module__2Qd4cG__dot",card:"CashbackCarousel-module__2Qd4cG__card",fakeBlock:"CashbackCarousel-module__2Qd4cG__fakeBlock"}},38913:function(e){e.exports={bonusesFAQ__subTitle:"FAQ-module__ikOELq__bonusesFAQ__subTitle",bonusesFAQ__wrap:"FAQ-module__ikOELq__bonusesFAQ__wrap",bonusesFAQ__title:"FAQ-module__ikOELq__bonusesFAQ__title",bonusesFAQ__flexColumn:"FAQ-module__ikOELq__bonusesFAQ__flexColumn"}},41782:function(e){e.exports={howItWorks__number:"HowItWorks-module__wCKl4W__howItWorks__number",howItWorks__steps:"HowItWorks-module__wCKl4W__howItWorks__steps",howItWorks__title:"HowItWorks-module__wCKl4W__howItWorks__title",howItWorks__step:"HowItWorks-module__wCKl4W__howItWorks__step"}},52234:function(e){e.exports={credentials__abonementBlock:"Credentitals-module__p8supG__credentials__abonementBlock",credentials__info:"Credentitals-module__p8supG__credentials__info",credentials__userInfo:"Credentitals-module__p8supG__credentials__userInfo",credentials__socialNetworks:"Credentitals-module__p8supG__credentials__socialNetworks",credentials__title:"Credentitals-module__p8supG__credentials__title"}},70736:function(e){e.exports={wrapper:"DeviceConnect-module__jE5eoG__wrapper",deviceConnect:"DeviceConnect-module__jE5eoG__deviceConnect"}},42054:function(e){e.exports={accordion:"Help-module__xYt-7W__accordion",accordion__item__description:"Help-module__xYt-7W__accordion__item__description",helpdesk:"Help-module__xYt-7W__helpdesk",accordion__title:"Help-module__xYt-7W__accordion__title",button:"Help-module__xYt-7W__button",helpData:"Help-module__xYt-7W__helpData",helpData__title:"Help-module__xYt-7W__helpData__title",helpdesk__title:"Help-module__xYt-7W__helpdesk__title",accordion__item__icon:"Help-module__xYt-7W__accordion__item__icon",accordion__item:"Help-module__xYt-7W__accordion__item"}},66309:function(e){e.exports={message__icon:"Helpdesk-module__SczwfW__message__icon",form__control:"Helpdesk-module__SczwfW__form__control",message:"Helpdesk-module__SczwfW__message",message__text:"Helpdesk-module__SczwfW__message__text",message_done:"Helpdesk-module__SczwfW__message_done",form:"Helpdesk-module__SczwfW__form",form__label:"Helpdesk-module__SczwfW__form__label",form__select:"Helpdesk-module__SczwfW__form__select",message_achtung:"Helpdesk-module__SczwfW__message_achtung"}},73160:function(e){e.exports={form:"Libraries-module__hRiQFW__form",reason:"Libraries-module__hRiQFW__reason",merge:"Libraries-module__hRiQFW__merge",library__mail:"Libraries-module__hRiQFW__library__mail",form__title:"Libraries-module__hRiQFW__form__title",reason__title:"Libraries-module__hRiQFW__reason__title",container:"Libraries-module__hRiQFW__container",openLibraryFund:"Libraries-module__hRiQFW__openLibraryFund",form__control:"Libraries-module__hRiQFW__form__control",reason__button:"Libraries-module__hRiQFW__reason__button",button:"Libraries-module__hRiQFW__button"}},600:function(e){e.exports={art__title:"Art-module__LkFB8G__art__title",cover:"Art-module__LkFB8G__cover",art:"Art-module__LkFB8G__art",art__annotation:"Art-module__LkFB8G__art__annotation"}},58242:function(e){e.exports={notification:"Notification-module__kgqhtG__notification",notification__content__text:"Notification-module__kgqhtG__notification__content__text",notification_isViewed:"Notification-module__kgqhtG__notification_isViewed",notification__title:"Notification-module__kgqhtG__notification__title",notification__content__dateStamp:"Notification-module__kgqhtG__notification__content__dateStamp",notification__content:"Notification-module__kgqhtG__notification__content"}},91657:function(e){e.exports={empty:"Notifications-module__pAgl9q__empty",notifications:"Notifications-module__pAgl9q__notifications"}},47443:function(e){e.exports={settings__loading:"NotificationsSettings-module__1zV3Iq__settings__loading",settings:"NotificationsSettings-module__1zV3Iq__settings",settings__title:"NotificationsSettings-module__1zV3Iq__settings__title",settings__block:"NotificationsSettings-module__1zV3Iq__settings__block",settings__block__row:"NotificationsSettings-module__1zV3Iq__settings__block__row",settings__title_innerBlock:"NotificationsSettings-module__1zV3Iq__settings__title_innerBlock",settings__block_innerBlock:"NotificationsSettings-module__1zV3Iq__settings__block_innerBlock",settings__language:"NotificationsSettings-module__1zV3Iq__settings__language",settings__block__info:"NotificationsSettings-module__1zV3Iq__settings__block__info",settings__info:"NotificationsSettings-module__1zV3Iq__settings__info",settings__language__list:"NotificationsSettings-module__1zV3Iq__settings__language__list",settings__channel:"NotificationsSettings-module__1zV3Iq__settings__channel"}},5043:function(e){e.exports={offers:"Offers-module__chuguG__offers",offer__title:"Offers-module__chuguG__offer__title",offers__count:"Offers-module__chuguG__offers__count",offers__block:"Offers-module__chuguG__offers__block",offer:"Offers-module__chuguG__offer",offer__count:"Offers-module__chuguG__offer__count",offer__title__icon:"Offers-module__chuguG__offer__title__icon",offers__list:"Offers-module__chuguG__offers__list",offers__list__fullwithlastchild:"Offers-module__chuguG__offers__list__fullwithlastchild",offers__block__title:"Offers-module__chuguG__offers__block__title"}},36511:function(e){e.exports={pagination:"OperationsHistory-module__tsa2dW__pagination"}},48883:function(e){e.exports={title:"OperationsHistoryEmpty-module__6u4Hga__title",root:"OperationsHistoryEmpty-module__6u4Hga__root",link:"OperationsHistoryEmpty-module__6u4Hga__link",description:"OperationsHistoryEmpty-module__6u4Hga__description"}},36552:function(e){e.exports={linkTo__title:"LinkTo-module__C5CfRa__linkTo__title",linkTo__content:"LinkTo-module__C5CfRa__linkTo__content",linkTo:"LinkTo-module__C5CfRa__linkTo",linkTo__content__chevronButton:"LinkTo-module__C5CfRa__linkTo__content__chevronButton"}},73116:function(e){e.exports={header__subText:"Payment-module___167qa__header__subText",menuBlock:"Payment-module___167qa__menuBlock",menuBlock__description:"Payment-module___167qa__menuBlock__description",header__label:"Payment-module___167qa__header__label",paymentSelector:"Payment-module___167qa__paymentSelector",header:"Payment-module___167qa__header"}},1914:function(e){e.exports={pagination:"ReferralHistory-module__S58-Pa__pagination"}},85834:function(e){e.exports={link:"ReferralHistoryEmpty-module__UTouFa__link",description:"ReferralHistoryEmpty-module__UTouFa__description",title:"ReferralHistoryEmpty-module__UTouFa__title",root:"ReferralHistoryEmpty-module__UTouFa__root"}},43688:function(e){e.exports={profileData_withotBonuses:"ProfileView-module__qnRwEW__profileData_withotBonuses",profileData__bonuses:"ProfileView-module__qnRwEW__profileData__bonuses",litresAccount__button:"ProfileView-module__qnRwEW__litresAccount__button",alert:"ProfileView-module__qnRwEW__alert",profileData__bonuses__description__text:"ProfileView-module__qnRwEW__profileData__bonuses__description__text",subscription:"ProfileView-module__qnRwEW__subscription",profileData__bonuses__description__text_blue:"ProfileView-module__qnRwEW__profileData__bonuses__description__text_blue",profileData__litresAccount:"ProfileView-module__qnRwEW__profileData__litresAccount",profileData__abonement:"ProfileView-module__qnRwEW__profileData__abonement",libraries__arrow:"ProfileView-module__qnRwEW__libraries__arrow",profileBonuses:"ProfileView-module__qnRwEW__profileBonuses",wrapper_mobile:"ProfileView-module__qnRwEW__wrapper_mobile",profileData__subscription:"ProfileView-module__qnRwEW__profileData__subscription",partnerStats:"ProfileView-module__qnRwEW__partnerStats",profileData__partnerStats__title:"ProfileView-module__qnRwEW__profileData__partnerStats__title",menuBlock__description:"ProfileView-module__qnRwEW__menuBlock__description",partnerStats__arrow:"ProfileView-module__qnRwEW__partnerStats__arrow",profileData__partnerStats:"ProfileView-module__qnRwEW__profileData__partnerStats",profileData__selfpub:"ProfileView-module__qnRwEW__profileData__selfpub",libraries:"ProfileView-module__qnRwEW__libraries",profileData__alert:"ProfileView-module__qnRwEW__profileData__alert",any:"ProfileView-module__qnRwEW__any",profileData__libraries:"ProfileView-module__qnRwEW__profileData__libraries",profileData__abonement__title:"ProfileView-module__qnRwEW__profileData__abonement__title",profileData__bonuses__description__text_bold:"ProfileView-module__qnRwEW__profileData__bonuses__description__text_bold",partnerStats__icon:"ProfileView-module__qnRwEW__partnerStats__icon",profileData__bonusAccount:"ProfileView-module__qnRwEW__profileData__bonusAccount",profileData__bonusAccountWithoutPhone:"ProfileView-module__qnRwEW__profileData__bonusAccountWithoutPhone",selfpub:"ProfileView-module__qnRwEW__selfpub",profileData:"ProfileView-module__qnRwEW__profileData",profileData__selfpub__title:"ProfileView-module__qnRwEW__profileData__selfpub__title",status:"ProfileView-module__qnRwEW__status",libraries__icon:"ProfileView-module__qnRwEW__libraries__icon",menuBlock:"ProfileView-module__qnRwEW__menuBlock",bonuses:"ProfileView-module__qnRwEW__bonuses",abonement:"ProfileView-module__qnRwEW__abonement",profileData__bonuses__description:"ProfileView-module__qnRwEW__profileData__bonuses__description",litresAccount:"ProfileView-module__qnRwEW__litresAccount"}},29263:function(e){e.exports={content:"ProfileWrapper-module__zwGTba__content",content__title__headerLink:"ProfileWrapper-module__zwGTba__content__title__headerLink",profile:"ProfileWrapper-module__zwGTba__profile",content__title__text:"ProfileWrapper-module__zwGTba__content__title__text",wrapper:"ProfileWrapper-module__zwGTba__wrapper",content__title__headerLink__icon:"ProfileWrapper-module__zwGTba__content__title__headerLink__icon",content__title:"ProfileWrapper-module__zwGTba__content__title",menu:"ProfileWrapper-module__zwGTba__menu",content__title__linkBack:"ProfileWrapper-module__zwGTba__content__title__linkBack",wrapper_mobile:"ProfileWrapper-module__zwGTba__wrapper_mobile",wrapper_main:"ProfileWrapper-module__zwGTba__wrapper_main"}},96842:function(e){e.exports={wink:"Subscription-module__TvwhKq__wink",payment:"Subscription-module__TvwhKq__payment",description:"Subscription-module__TvwhKq__description",subscriptionPage_rebill_working:"Subscription-module__TvwhKq__subscriptionPage_rebill_working",subscriptionPage:"Subscription-module__TvwhKq__subscriptionPage",subscriptionPage_active:"Subscription-module__TvwhKq__subscriptionPage_active",subscriptionPage_winkActivated:"Subscription-module__TvwhKq__subscriptionPage_winkActivated",autoRenew:"Subscription-module__TvwhKq__autoRenew",subscriptionPage__switcher:"Subscription-module__TvwhKq__subscriptionPage__switcher",errorMsg:"Subscription-module__TvwhKq__errorMsg",subscriptionPage__widget:"Subscription-module__TvwhKq__subscriptionPage__widget",subscriptionBlock:"Subscription-module__TvwhKq__subscriptionBlock",subscriptionPage__payment:"Subscription-module__TvwhKq__subscriptionPage__payment",subscriptionPage__chooseBooks:"Subscription-module__TvwhKq__subscriptionPage__chooseBooks",displayDiscount:"Subscription-module__TvwhKq__displayDiscount",subscriptionPage__displayDiscount:"Subscription-module__TvwhKq__subscriptionPage__displayDiscount",subscriptionPage__wink:"Subscription-module__TvwhKq__subscriptionPage__wink",subscriptionPage_mobile:"Subscription-module__TvwhKq__subscriptionPage_mobile",subscriptionPage__paperDiscount:"Subscription-module__TvwhKq__subscriptionPage__paperDiscount",subscriptionPage__autoRenew:"Subscription-module__TvwhKq__subscriptionPage__autoRenew",paperDiscount:"Subscription-module__TvwhKq__paperDiscount",switcher:"Subscription-module__TvwhKq__switcher",chooseBooks:"Subscription-module__TvwhKq__chooseBooks",subscriptionPage__subscriptionBlock:"Subscription-module__TvwhKq__subscriptionPage__subscriptionBlock"}},53899:function(e){e.exports={error:"ProfileError-module__gtQCGq__error"}},42824:function(e){e.exports={block__description:"ProfileInnerBlock-module__LWb0aW__block__description",block:"ProfileInnerBlock-module__LWb0aW__block",block__divider:"ProfileInnerBlock-module__LWb0aW__block__divider","block_bordered-accent":"ProfileInnerBlock-module__LWb0aW__block_bordered-accent",block_filled:"ProfileInnerBlock-module__LWb0aW__block_filled",block__title:"ProfileInnerBlock-module__LWb0aW__block__title"}},26832:function(e){e.exports={loading:"ProfileLoading-module__gQsULq__loading"}},9393:function(e){e.exports={menuList__link_logout:"ProfileMenu-module__S5KcWW__menuList__link_logout",menuList__link_main:"ProfileMenu-module__S5KcWW__menuList__link_main",menuList:"ProfileMenu-module__S5KcWW__menuList",menuList__item:"ProfileMenu-module__S5KcWW__menuList__item",menuList__link:"ProfileMenu-module__S5KcWW__menuList__link",countBubble:"ProfileMenu-module__S5KcWW__countBubble",menuList__link__icon:"ProfileMenu-module__S5KcWW__menuList__link__icon",menuList__link_active:"ProfileMenu-module__S5KcWW__menuList__link_active",menuList_mobile:"ProfileMenu-module__S5KcWW__menuList_mobile"}},59193:function(e){e.exports={block__avatar_large:"ProfileSmallCard-module__MAJCCa__block__avatar_large",block__descr:"ProfileSmallCard-module__MAJCCa__block__descr",block__avatar:"ProfileSmallCard-module__MAJCCa__block__avatar",block__avatar__img_large:"ProfileSmallCard-module__MAJCCa__block__avatar__img_large",icon:"ProfileSmallCard-module__MAJCCa__icon",block:"ProfileSmallCard-module__MAJCCa__block",block__content:"ProfileSmallCard-module__MAJCCa__block__content",name:"ProfileSmallCard-module__MAJCCa__name",block__avatar_subscr:"ProfileSmallCard-module__MAJCCa__block__avatar_subscr",block__name:"ProfileSmallCard-module__MAJCCa__block__name",block__avatar__img:"ProfileSmallCard-module__MAJCCa__block__avatar__img"}},82333:function(e){e.exports={switcher__button:"ProfileSubscriptionProductSwitcher-module__wG3qFq__switcher__button",switcher:"ProfileSubscriptionProductSwitcher-module__wG3qFq__switcher",switcher__button_active:"ProfileSubscriptionProductSwitcher-module__wG3qFq__switcher__button_active"}},99442:function(e){e.exports={chevronIcon:"Accordion-module__vZhvEG__chevronIcon",accordion__item__Title:"Accordion-module__vZhvEG__accordion__item__Title",accordion__item__Header:"Accordion-module__vZhvEG__accordion__item__Header",accordion__item__Header_reverseOrder:"Accordion-module__vZhvEG__accordion__item__Header_reverseOrder",accordion__item__Content:"Accordion-module__vZhvEG__accordion__item__Content",accordion__item:"Accordion-module__vZhvEG__accordion__item",notCollapsible:"Accordion-module__vZhvEG__notCollapsible",accordion:"Accordion-module__vZhvEG__accordion"}},98467:function(e){e.exports={empty__title:"EmptyState-module__Rus85q__empty__title",empty:"EmptyState-module__Rus85q__empty",empty__content:"EmptyState-module__Rus85q__empty__content",empty__controls:"EmptyState-module__Rus85q__empty__controls"}},67308:function(e){e.exports={toggleWrapper_checked:"Switcher-module__2W9gAa__toggleWrapper_checked",toggleWrapper:"Switcher-module__2W9gAa__toggleWrapper",toggleWrapper_disabled:"Switcher-module__2W9gAa__toggleWrapper_disabled",hidden:"Switcher-module__2W9gAa__hidden",toggle:"Switcher-module__2W9gAa__toggle"}}},function(e){e.O(0,[808,3981,7536,2052,1327,553,3631,8749,8505,6333,4123,1232,2982,4860,2699,6150,2888,9774,179],function(){return e(e.s=54353)}),_N_E=e.O()}]);
//# sourceMappingURL=[[...slug]]-26f0e996053f5f1c.js.map