!function(){try{var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="9b67aefc-e3bc-41fa-b3c3-2ff165024694",t._sentryDebugIdIdentifier="sentry-dbid-9b67aefc-e3bc-41fa-b3c3-2ff165024694")}catch(t){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2982],{92479:function(t,e,i){i.d(e,{r:function(){return n},i:function(){return p}});var n,s=i(2327),r=i(34871),o=i(89574),c=i(3224),a=i.n(c),u=i(81014),l=i(52887);class h{checkIfDiscountApplied(){return null!==this.withDiscountPrice}getTotalPrice(){var t;let e=this.standardPrice;return(null===(t=this.withDiscountPrice)||void 0===t?void 0:t.checkIfPositiveOrZero())&&(e=this.withDiscountPrice),e}calculateDiscountPercentage(t,e){return(null==t?void 0:t.name)===n.blackFriday?new l.$(60):this.totalPrice.checkIfZero()&&!e?(0,l.G)(this.bigFakePrice.value,this.prolongPrice.value):(0,l.G)(this.bigFakePrice.value,this.totalPrice.value)}constructor({infoFromBackend:t,currency:e,promoEvent:i,isCouponApplied:n}){this.bigFakePrice=new u.W(t.base_price,e),this.standardPrice=new u.W(t.price,e),this.withDiscountPrice=a()(t.special_price)?new u.W(t.special_price,e):null,this.prolongPrice=n?new u.W(t.base_price,e):new u.W(t.prolong_price||t.base_price,e),this.averageMonthPrice=new u.W(t.month_price||t.base_price,e),this.totalPrice=this.getTotalPrice(),this.discountPercentage=this.calculateDiscountPercentage(i,n),this.isBestPrice=t.is_best_price}}var d=i(17479);(n||(n={})).blackFriday="blackFriday";class p{getTotalFreeSubscriptionMonths(t){return this.appliedCoupon?this.appliedCoupon.freeMonthsCount:t?new o.C(1):null}static formatDate(t){let e=(0,s.K)("ru-RU");return(0,r.WU)(t,"d MMMM yyyy",{locale:e})}static checkIfSubscriptionClassHasCoupon(t){let{subscription_discount_type:e}=t;return e===d.H2.price||e===d.H2.discount}checkIfTrialPeriodAvailable(t){return t&&this.isFreeTrialPeriodAvailable}getProlongationsInfo(t){let{duration:e,prices:i,appliedCoupon:n}=this,s=this.checkIfTrialPeriodAvailable(t),r=new Date,o=new Date(r);o.setMonth(r.getMonth()+e.value);let c={date:p.formatDate(o),price:i.prolongPrice},a={firstProlongation:c,secondProlongation:null};if(!n&&i.totalPrice.equal(i.prolongPrice))return a;if(null==n?void 0:n.freeMonthsCount.checkIfPositive()){let t=new Date(r);return t.setMonth(t.getMonth()+n.duration.value),c.date=p.formatDate(t),a}if(s){let t=new Date(r);t.setMonth(t.getMonth()+1),c.date=p.formatDate(t)}if(!i.prolongPrice.equal(i.standardPrice)){let t=new Date(a.firstProlongation.date);t.setMonth(t.getMonth()+this.duration.value),a.secondProlongation={date:p.formatDate(t),price:i.standardPrice}}return a}getSubscriptionDurationThatShouldBeShownForUser(){return this.appliedCoupon&&this.appliedCoupon.bonusMonthsCount.checkIfPositive()?"".concat(this.duration.value," + ").concat(this.appliedCoupon.bonusMonthsCount.getValueAndMonthsText()):this.duration.getValueAndMonthsText()}constructor(t){var e,i;this.classId=t.class_id,this.currency=t.currency,this.progressiveDiscountForPPD=t.discount,this.promoCounter=t.promo_counter||0,this.promoEvent=t.promo_event?{name:null===(e=t.promo_event)||void 0===e?void 0:e.name}:null,this.duration=new o.C(t.duration),p.checkIfSubscriptionClassHasCoupon(t)&&this.duration.value===d.Mb?this.appliedCoupon=new d.b3({subscription_discount_type:t.subscription_discount_type,subscription_discount_value:t.subscription_discount_value||0,bonus_month_count:t.bonus_month_count||0}):this.appliedCoupon=null,this.prices=new h({infoFromBackend:t,currency:this.currency,promoEvent:this.promoEvent,isCouponApplied:null!==this.appliedCoupon}),this.isTrialAvailable=t.is_trial_available||!1,this.isFreeTrialPeriodAvailable=null===(i=t.is_free_trial_period_available)||void 0===i||i}}},17479:function(t,e,i){i.d(e,{H2:function(){return s},Mb:function(){return o},b3:function(){return c}});var n,s,r=i(89574);(n=s||(s={})).price="price",n.discount="discount";let o=1;class c{getTotalFreeCouponMonths(t){let e=new r.C(t||0);return this.checkIfFreeFirstMonth()&&(e=new r.C(e.value+1)),e}checkIfFreeFirstMonth(){if("discount"===this.discountType)return 1===this.discountCoefficient;if("price"===this.discountType)return 0===this.discountCoefficient;throw Error("Subscription Coupon: Unknown coupon type")}constructor(t){this.discountType=t.subscription_discount_type,this.discountCoefficient=t.subscription_discount_value||0,this.freeMonthsCount=this.getTotalFreeCouponMonths(t.bonus_month_count),this.bonusMonthsCount=new r.C(t.bonus_month_count||0),this.duration=this.checkIfFreeFirstMonth()?this.freeMonthsCount:new r.C(this.freeMonthsCount.value+o)}}},36675:function(t,e,i){i.d(e,{q:function(){return s}});var n=i(8364);class s extends n.I{constructor(t){super(t),this.isActive=t.is_active,this.startAt=t.start_at}}},8364:function(t,e,i){i.d(e,{I:function(){return s}});var n=i(52887);class s extends n.${constructor(t){super(t.value)}}},42982:function(t,e,i){i.d(e,{M:function(){return a}});var n=i(81014),s=i(89574),r=i(21092);class o{static getAvailableArtsInfo(t){let{planId:e}=t;if(null===e)return null;if(r._P.checkIfBookshelf(e)){let{tokens_left:e,token_max_price:i,token_refresh_at:s}=t;return null!=e&&null!=i?{amount:e,renewAt:s?new Date(s):null,maxPrice:new n.W(i,"RUB")}:null}return null}}var c=i(36675);class a{activateOptimisticallyOnClientSide(){this.isActive=!0,this.isActiveInGracePeriod=!1,this.isActiveWithoutGracePeriod=!0,this.dates={start:new Date().toISOString(),end:void 0},this.isActivatedOnClientSide=!0}checkIfPromotedSubscriptionClassHasDiscount(){return!!this.promotedSubscriptionClass&&this.promotedSubscriptionClass.prices.checkIfDiscountApplied()}getProlongationDateText(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ru-RU";return this.dates.end?new Date(this.dates.end).toLocaleDateString(t,{year:"numeric",month:"long",day:"numeric"}).replace(" г.",""):""}checkIfHasActiveSubscriptionInGracePeriod(){return!!this.isActive&&!0===this.isInGracePeriod}checkIfHasActiveSubscriptionWithoutGracePeriod(){return!!this.isActive&&!1===this.isInGracePeriod}getPromotedSubscriptionClass(){return this.availableSubscriptionClasses.bestPriceSubscriptionClass}getPurchaseOriginName(t){switch(t){case 3:return"Any";case 2:return"Google Play";case 1:return"AppStore";default:return"Web"}}checkIfBoughtByApp(){return!("AppStore"!==this.purchaseOrigin&&"Google Play"!==this.purchaseOrigin)}checkIfOneMonthTariff(){return 1===this.prolongDuration.value}getActiveCumulativeDiscount(){return this.cumulativeDiscountList.find(t=>t.isActive)||null}getStatus(){let t="off";return this.isActive&&(t="active"),this.isInGracePeriod&&(t="active_in_grace"),t}constructor(t,e){var i;this.id=(null==t?void 0:t.id)||0,this.classId=(null==t?void 0:t.class_id)||0,this.isActive=(null==t?void 0:t.is_active)||!1,this.isInGracePeriod=(null==t?void 0:t.is_grace_period_active)||!1,this.dates={start:(null==t?void 0:t.start_date)||"",end:(null==t?void 0:t.valid_till)||""},this.cumulativeDiscountList=(null==t?void 0:t.cumulative_discount_percentage)?t.cumulative_discount_percentage.map(t=>new c.q(t)).sort((t,e)=>t.value-e.value):[],this.isAutoRenewAvailable=(null==t?void 0:t.auto_renew_status)===1,this.rebillId=null==t?void 0:t.rebill_id,this.purchaseOrigin=this.getPurchaseOriginName(null==t?void 0:t.purchase_origin),this.isActiveInGracePeriod=this.checkIfHasActiveSubscriptionInGracePeriod(),this.isActiveWithoutGracePeriod=this.checkIfHasActiveSubscriptionWithoutGracePeriod(),this.isNewSubscriptionAvailable=!this.isActive&&!this.isInGracePeriod,this.availableSubscriptionClasses=e,this.canUserSelectSubscriptionClass=this.isNewSubscriptionAvailable&&this.availableSubscriptionClasses.items.length>1,this.isTrialAvailable=!t||t.is_trial_available,this.isTrialPeriod=!!(null==t?void 0:t.is_trial_period),this.promotedSubscriptionClass=this.getPromotedSubscriptionClass(),this.prolongClassId=(null==t?void 0:t.prolong_class_id)||this.classId,this.prolongPrice=new n.W((null==t?void 0:t.prolong_price)||0,(null==t?void 0:t.prolong_currency)||"RUB"),this.prolongDuration=new s.C((null==t?void 0:t.prolong_duration)||1),this.isActivatedOnClientSide=!1,this.loaded=!!t,this.status=this.getStatus(),this.plan=null!==(i=null==t?void 0:t.plan)&&void 0!==i?i:null,this.availableArts=o.getAvailableArtsInfo({planId:this.plan,tokens_left:null==t?void 0:t.tokens_left,token_max_price:null==t?void 0:t.token_max_price,token_refresh_at:null==t?void 0:t.token_refresh_at})}}},21092:function(t,e,i){i.d(e,{Ad:function(){return r},DV:function(){return s},KF:function(){return u},T1:function(){return c},_P:function(){return l},jk:function(){return o},mS:function(){return a}});var n=i(92479);let s={24:"Оптимальный",300:"Базовый",301:"Максимальный",302:"Легкое чтение",303:"Книжная полка"};class r extends n.i{constructor(t,e){super(t),this.key=e.key,this.planId=t.plan,this.label=e.label,this.description=e.description}}class o extends r{static checkIfOptimal(t){return 24===t}constructor(t){super(t,{key:"optimal",label:s[t.plan],description:"Для тех, кому важны все форматы"})}}class c extends r{static checkIfBase(t){return 300===t}constructor(t){super(t,{key:"basic",label:s[t.plan],description:"Для тех, кто читает электронные книги"})}}class a extends r{static checkIfMaximum(t){return 301===t}constructor(t){super(t,{key:"maximum",label:s[t.plan],description:"Для тех, кто хочет читать новинки раньше всех"})}}class u extends r{static checkIfEasyReading(t){return 302===t}constructor(t){super(t,{key:"easy-reading",label:s[t.plan],description:"Для тех, кто читает, чтобы отвлечься"})}}class l extends r{static checkIfBookshelf(t){return 303===t}constructor(t){super(t,{key:"bookshelf",label:s[t.plan],description:"Для тех, кто любит читать новинки и хочет сохранять книги навсегда"})}}},89574:function(t,e,i){i.d(e,{C:function(){return r}});var n=i(59838),s=i(5939);class r extends s.D{getValueAndMonthsText(){return"".concat(this.value," ").concat(this.getMonthsText())}getMonthsText(){return(0,n.pd)(this.value,["месяц","месяца","месяцев"])}}}}]);
//# sourceMappingURL=2982-3024bbeda9c7e4f2.js.map