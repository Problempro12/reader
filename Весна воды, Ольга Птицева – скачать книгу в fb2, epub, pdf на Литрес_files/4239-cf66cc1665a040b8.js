!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="323382ed-eefd-4e74-9c00-74e7df82f836",e._sentryDebugIdIdentifier="sentry-dbid-323382ed-eefd-4e74-9c00-74e7df82f836")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4239],{4506:function(e,t,r){"use strict";r.d(t,{k:function(){return y}});var i=r(31549),n=r(44194),o=r(48592),a=r(26249),s=r(3995),l=r(61794),c=r(62094),d=r(33098),_=r.n(d),u=r(56321),m=r(39319),p=r(20239),h=r(1818),b=r.p+"static/media/adult.53680b99.svg",v=r(81173),f=r.n(v),k=r(44731);let x=()=>{k.TM.sendEvent(["LITRES_TRACKER"],{eventType:"safemode_popup_view",params:{}})},g=()=>{k.TM.sendEvent(["LITRES_TRACKER"],{eventType:"safemode_popup_confirm",params:{}})},j=()=>{k.TM.sendEvent(["LITRES_TRACKER"],{eventType:"safemode_popup_cancel",params:{}})},y=e=>{let{onDecline:t}=e,r=(0,c.vI)("modalView"),{changeSafeMode:d,safeModeStatus:v}=(0,h.v)(),k=(0,c.uH)(),{t:y}=(0,o.$G)(),B=(0,a.useRouter)(),[S,C]=(0,n.useState)(v!==h.nT.disabled),[N]=l.r7.useSetSafemodeMutation(),T=(0,l.CG)(e=>e.foundationUser),w=(0,n.useMemo)(()=>T.id&&T.login,[T]);(0,n.useEffect)(()=>{k&&S&&x()},[k,S]);let P=e=>{N({is_safemode_enabled:e===h.Wb.hide}).unwrap().then(()=>{d(!!e)}).catch(e=>{var t;console.error("Ошибка",null===(t=e.error)||void 0===t?void 0:t.title)})};if(!k||!S)return null;let A=(0,i.jsx)(s.Z,{enabled:!0,children:(0,i.jsxs)("div",{className:_().modalView,role:"dialog",children:[(0,i.jsx)("div",{className:_().modalView__overlay}),(0,i.jsx)("div",{className:_().container,children:(0,i.jsx)("div",{className:_().content,children:(0,i.jsxs)("div",{className:f().adult,children:[(0,i.jsxs)("div",{className:f().head,children:[(0,i.jsx)("img",{src:b,className:f().img,alt:"18+"}),(0,i.jsx)("div",{className:f().title,children:(0,i.jsx)(o.cC,{i18nKey:"Ограничение взрослого контента"})}),(0,i.jsx)("div",{className:f().description,children:(0,i.jsx)(o.cC,{i18nKey:"Подтвердите, что вы старше 18 лет"})})]}),(0,i.jsxs)("div",{className:f().buttons,children:[(0,i.jsx)(m.z,{mode:"secondary",size:"large",text:y("Да, мне есть 18"),onClick:()=>{C(!1),g(),w?P(h.Wb.show):d(!1)}}),(0,i.jsx)(m.z,{mode:"secondary",size:"large",text:y("Мне нет 18"),onClick:()=>{j(),w?P(h.Wb.hide):d(!0),t?t():window.customReferrer?window.location.href=window.customReferrer:B.replace("/")}}),(0,i.jsx)("div",{className:f().policy,children:(0,i.jsx)(o.cC,{i18nKey:"Нажимая кнопку, вы соглашаетесь на обработку указанных данных в соответствии с <a>Политикой</a>",components:{a:(0,i.jsx)(p.I,{target:"_blank",href:"/static/litres/inc/ru/privacy_policy.html"})}})})]})]})})})]})});return r?u.createPortal(A,r):r}},67384:function(e,t,r){"use strict";r.d(t,{T:function(){return d}});var i=r(31549);r(44194);var n=r(51865),o=r.n(n),a=r(61794),s=r(55714),l=r(77507),c=r.n(l);let d=e=>{let{url:t,title:r,text:n,className:l}=e,d=(0,a.CG)(e=>e.browser.pda),{is_staff:_,isOfficeUser:u}=(0,a.CG)(e=>e.foundationUser);return!d&&(_||u)?(0,i.jsxs)("div",{className:o()(c().wrapper,l),children:[!u&&(0,i.jsx)("p",{className:c().title,children:r}),u&&t&&(0,i.jsx)(s.Fg,{href:t,target:"_blank",className:c().link,rel:"noreferrer",children:r}),(0,i.jsxs)("p",{className:c().text,children:["[",n,"]"]})]}):null}},41104:function(e,t,r){"use strict";r.d(t,{V:function(){return c}});var i=r(31549),n=r(51865),o=r.n(n),a=r(20239),s=r(28673),l=r.n(s);let c=e=>{let t=o()(l().tag,e.className);return e.href?(0,i.jsx)(a.I,{href:e.href,onClick:e.onClick,className:t,children:e.text}):(0,i.jsx)("div",{className:t,onClick:e.onClick,children:e.text})}},24810:function(e,t,r){"use strict";r.d(t,{v:function(){return c},G:function(){return l}});var i=r(31549),n=r(44194);let o={is_available_with_litres_subscription:!1,availability_with_partner_subscriptions:[],is_draft_full_free:!1,release_file_id:0,art_refresh_in_days:0,is_auto_speech:!1,audio_drm3_key:null,is_adult_content:!1,is_archived:!1,is_hidden:!1,is_referrable:!1,is_abonement_art:!1,is_available_with_abonement:!1,is_liked:!1,read_at:"",purchased_at:"",is_abonement_forbidden:!1,in_user_cart_status:"not_in_cart",is_discount_forbidden:!1,is_trusted_cover:!1,synchronized_arts:[{id:28907895}],id:28907894,uuid:"259a3f41-ff99-11e7-aa6b-0cc47a520474",title:"Свобода от тревоги. Справься с тревогой, пока она не расправилась с тобой",art_type:0,is_auto_speech_gift:!1,my_art_status:0,art_subscription_status_for_user:"no_subscription",labels:{is_new:!1,is_bestseller:!0,is_sales_hit:!1,is_litres_exclusive:!1},youtube_videos:[],contents_url:"pub/c/cover/28907894.xml",is_prohibited_for_sale:!1,additional_info:{registered_at:"2018-01-22T20:24:48",translated_at:"2018-01-01"},is_podcast_complete:!1,synchronizations:[],interacted_at:"",alternative_version:{id:123,link_type:"SYNCED"}},a={art:o,artIdOrSlug:o.id,isDesktop:!0,bookSubPath:"",isFinished:o.is_finished||!1,setIsFinished:()=>{}},s=(0,n.createContext)(a),l=()=>(0,n.useContext)(s),c=e=>{let{value:t,children:r}=e,[o,a]=(0,n.useState)(t.art.is_finished||!1);return(0,n.useEffect)(()=>{a(t.art.is_finished||!1)},[t.art.is_finished,t.art.id]),(0,i.jsx)(s.Provider,{value:{...t,isFinished:o,setIsFinished:a},children:r})}},46767:function(e,t,r){"use strict";r.d(t,{q:function(){return u}});var i=r(31549);r(44194);var n=r(61794),o=r(12649),a=r(55714),s=r(51865),l=r.n(s),c=r(62094),d=r(17090),_=r.n(d);let u=e=>{let{url:t,name:r,className:s=""}=e,d=(0,n.CG)(e=>e.browser.pda),u=(0,c.Gc)("breakpoint-700");return(0,i.jsx)(i.Fragment,{children:t?(0,i.jsx)(a.Fg,{className:l()(_().author__name,s),href:t,e2eId:"art__personName--link",children:(0,i.jsx)(o.k,{isKeepWords:!1,maxHeight:u?20:150,separator:"...",mode:d?"pda":"www",isCheckDocumentHeight:!0,children:(0,i.jsx)("span",{itemProp:"name",children:r})})}):(0,i.jsx)(o.k,{isKeepWords:!1,maxHeight:u?20:150,separator:"...",mode:d?"pda":"www",isCheckDocumentHeight:!0,children:(0,i.jsx)("span",{className:_().text_capitalize,itemProp:"name",children:r.toLowerCase()})})})}},34639:function(e,t,r){"use strict";r.d(t,{g:function(){return b}});var i=r(31549),n=r(44194),o=r(61794),a=r(91270),s=r(80930),l=r(17090),c=r.n(l),d=r(28061),_=r(48592);let u=e=>{let{t}=(0,_.$G)(),{authorId:r,authorAvatar:n,metaAvatarURL:o,name:a}=e;return(0,i.jsxs)("div",{className:c().author__avatar,children:[(0,i.jsx)(d.q,{id:r,imageURL:n,type:d.f.Author,containerSize:40,size:50,alt:t("Аватар автора {name}",{name:a})}),o&&(0,i.jsx)("meta",{itemProp:"image",content:o})]})};var m=r(46767);let p=e=>{var t;let{author:r,avatar:o,isSubscribed:a,metaAvatarURL:s,handleSubscribe:l}=e;return(0,n.useEffect)(()=>{let e=new URL(window.location.href);e.searchParams.has("force")&&"subscribeToAuthor"===e.searchParams.get("force")&&e.searchParams.has("authorId")&&e.searchParams.get("authorId")===String(r.id)&&!a&&(l(),e.searchParams.delete("force"),e.searchParams.delete("authorId"),window.history.pushState("",document.title,e.toString()))},[]),(0,i.jsxs)("div",{className:c().author,itemScope:!0,itemProp:"author",itemType:"https://schema.org/Person","data-testid":"book-author__avatarName",children:[(0,i.jsx)(u,{authorId:r.id,authorAvatar:o,metaAvatarURL:s,name:r.full_rodit}),(0,i.jsx)("div",{className:c().author__info,children:(0,i.jsx)(m.q,{url:null!==(t=r.url)&&void 0!==t?t:void 0,name:r.full_name})})]})},h=(e,t,r,i)=>{let n=(0,o.TL)(),{t:a}=(0,_.$G)(),[s]=o.g$.useSubscribeActionMutation();return()=>{r?(s({authorId:e,shouldSubscribe:!t}),i(e=>({followers:e.followers+Number(!e.isSubscribed),isSubscribed:!e.isSubscribed}))):n(o.hi.global.interfaceRequests.setLoginPopupError({isOpen:!0,errorText:a("Для подписки на e-mail Вы должны авторизоваться"),urlParams:{force:"subscribeToAuthor",authorId:e}}))}},b=e=>{var t;let{author:r}=e,{data:l}=o.g$.useGetAuthorQuery(r.id),[c,d]=(0,n.useState)({followers:0,isSubscribed:!1}),{id:_}=(0,a.useSelector)(e=>e.foundationUser),u=(0,n.useMemo)(()=>_>0,[_]),m=h(r.id,!!(null==l?void 0:l.is_subscribed),u,d);(0,n.useEffect)(()=>{l&&d({followers:l.total_followers||0,isSubscribed:l.is_subscribed})},[l]);let b=(null==l?void 0:l.image_url)?"".concat(s._n).concat(null==l?void 0:l.image_url):"";return(0,i.jsx)(p,{author:r,avatar:null!==(t=null==l?void 0:l.image_url)&&void 0!==t?t:void 0,followers:c.followers,isSubscribed:c.isSubscribed,metaAvatarURL:b,handleSubscribe:m})}},12245:function(e,t,r){"use strict";r.d(t,{a:function(){return h},d:function(){return p}});var i,n,o,a,s=r(97439);(i=o||(o={})).READ_ONLY_ON_LITRES="Читайте только на Литрес",i.LISTEN_ONLY_ON_LITRES="Слушайте только на Литрес",i.AUTOSPEECH="Озвучено роботом",i.DRAFT="Черновик",i.DRAFT_WITH_AUTOSPEECH="Черновик, озвученный роботом",i.DRAFT_WITH_AUTOSPEECH_ONLY_ON_LITRES="Черновик, озвученный роботом только для Литрес",i.DRAFT_PODCAST="Подкаст ещё записывается",(n=a||(a={})).DESCRIPTION_READ_ONLY_ON_LITRES="Книгу нельзя скачать файлом, но можно читать в нашем приложении или онлайн на сайте.",n.DESCRIPTION_LISTEN_ONLY_ON_LITRES="Книгу нельзя скачать файлом, но можно слушать в нашем приложении или онлайн на сайте.",n.DESCRIPTION_AUTOSPEECH="Озвучка книги с помощью технологий синтеза речи с естественной интонацией.",n.DESCRIPTION_DRAFT="Это незаконченная книга, которую автор пишет прямо сейчас, выкладывая новые части или главы по мере их завершения.",n.DESCRIPTION_DRAFT_SHORT="Автор пишет эту книгу прямо сейчас",n.DESCRIPTION_GIFT="Мы дарим эту книгу при покупке текстовой версии.",n.DESCRIPTION_GIFT_WITH_LINK='Мы дарим эту книгу при покупке <a href="{linkedArtLink}">текстовой версии</a>.',n.LINK_TO_DETAIL='<a href="{detailLink}">Подробнее</a>.',n.EMPTY="";let l=e=>{let t=e.has(s.SI.is_audio),r=e.has(s.SI.drm),i=e.has(s.SI.autospeech),n=e.has(s.SI.draft),o=e.has(s.SI.is_podcast_draft);return n&&r&&i?"Черновик, озвученный роботом только для Литрес":n?i?"Черновик, озвученный роботом":"Черновик":o?"Подкаст ещё записывается":i?"Озвучено роботом":t?"Слушайте только на Литрес":"Читайте только на Литрес"},c=(e,t)=>{let r=e.has(s.SI.is_audio),i=e.has(s.SI.drm),n=e.has(s.SI.autospeech),o=e.has(s.SI.draft),a=e.has(s.SI.is_gift),l=e.has(s.SI.is_podcast_draft),c=t?'Мы дарим эту книгу при покупке <a href="{linkedArtLink}">текстовой версии</a>.':"Мы дарим эту книгу при покупке текстовой версии.";if(o&&!l){let e=n&&i||!n;return[["Это незаконченная книга, которую автор пишет прямо сейчас, выкладывая новые части или главы по мере их завершения.",n?'<a href="{detailLink}">Подробнее</a>.':""],[n?"Озвучка книги с помощью технологий синтеза речи с естественной интонацией.":"",n&&a?c:""],[e&&r?"Книгу нельзя скачать файлом, но можно слушать в нашем приложении или онлайн на сайте.":"",e&&!r?"Книгу нельзя скачать файлом, но можно читать в нашем приложении или онлайн на сайте.":"",n?"":'<a href="{detailLink}">Подробнее</a>.']]}return n?[["Озвучка книги с помощью технологий синтеза речи с естественной интонацией.",a?c:""],[i&&r?"Книгу нельзя скачать файлом, но можно слушать в нашем приложении или онлайн на сайте.":""],[i&&!r?"Книгу нельзя скачать файлом, но можно читать в нашем приложении или онлайн на сайте.":""]]:i?[[r?"Книгу нельзя скачать файлом, но можно слушать в нашем приложении или онлайн на сайте.":"Книгу нельзя скачать файлом, но можно читать в нашем приложении или онлайн на сайте."]]:[[]]},d=e=>{let t=e.has(s.SI.draft),r=e.has(s.SI.is_podcast_draft);return t&&!r?"orange":t&&!r?null:"blue"},_=e=>e.map(e=>e.filter(e=>""!==e)).filter(e=>e.length>0),u="/popular/?only_drafts=true",m="/cms/chernoviki/",p=function(e,t,r){var i,n;let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"ru-RU",a=(null==r?void 0:null===(n=r.linked_arts)||void 0===n?void 0:null===(i=n[0])||void 0===i?void 0:i.url)||void 0;return{title:e(l(t)),descriptions:_(c(t,a)),textParams:{linkedArtLink:a,detailLink:"ru-RU"===o?m:u},typeBanner:d(t)}},h=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ru-RU";return{descriptions:[["Автор пишет эту книгу прямо сейчас",e&&t||!e?'<a href="{detailLink}">Подробнее</a>.'.substring(0,36):""]],textParams:{detailLink:"ru-RU"===r?m:u}}}},70145:function(e,t,r){"use strict";r.d(t,{o:function(){return b}});var i=r(31549),n=r(44194),o=r(51865),a=r.n(o),s=r(4438),l=r(55714),c=r(48592),d=r(97439),_=r(70608),u=r(12245);let m=e=>{let{i18n:t}=(0,c.$G)();return(0,n.useMemo)(()=>{let{is_draft:r,is_drm:i,is_auto_speech_gift:n,is_auto_speech:o}=e,a=(0,_.F0)(e),s=(0,_.M4)(e),l=new Set([r&&d.SI.draft,o&&d.SI.autospeech,i&&d.SI.drm,n&&d.SI.is_gift,a&&d.SI.is_audio,s&&d.SI.is_podcast_draft].filter(e=>!!e));return(0,u.d)(t.t,l,e,t.language)},[e,t])};var p=r(19586),h=r.n(p);let b=e=>{let{t}=(0,c.$G)(),{art:r,bookSubPath:o=""}=e,d=m(r);return(0,i.jsxs)("div",{className:a()(h().banner,{[h().banner_type_orange]:"orange"===d.typeBanner,[h().banner_type_blue]:"blue"===d.typeBanner,[h().banner_bookPages]:!!o}),"data-testid":"book-banner__wrapper",children:[(0,i.jsx)("div",{className:h().banner__icon,children:(0,i.jsx)(s.uQ,{name:"infoFilled",size:16})}),(0,i.jsxs)("div",{className:h().banner__content,children:[(0,i.jsx)("div",{className:h().banner__title,children:d.title}),(0,i.jsx)("div",{className:h().banner__text,children:d.descriptions.map(e=>(0,i.jsx)("p",{children:e.map(e=>(0,i.jsxs)(n.Fragment,{children:[(0,i.jsx)(c.cC,{t:t,i18nKey:e,values:d.textParams,components:{a:(0,i.jsx)(l.Fg,{})}})," "]},e))},e.join(" ")))})]})]})}},39925:function(e,t,r){"use strict";r.d(t,{g:function(){return i}});let i=e=>e?(Math.ceil(10*e)/10).toFixed(1).replace(".",","):"0,0"},62452:function(e,t,r){"use strict";r.d(t,{O:function(){return K}});var i=r(31549),n=r(61794),o=r(4438),a=r(44194),s=r(51865),l=r.n(s),c=r(48592),d=r(91270),_=r(34257),u=r(42852),m=r(47263),p=r(59838),h=r(55714),b=r(48689),v=r.n(b);let f=e=>{let{isActive:t,index:r,votesCount:n,rating:o,userVote:s}=e,c=o["voted".concat(r)],d=(0,a.useMemo)(()=>{let e=o["voted".concat(r)];return{width:"".concat(Math.round(100*e/n),"%")}},[n,o,r]);return(0,i.jsxs)("div",{className:v().stars_row,children:[(0,i.jsx)("div",{className:l()(v().star_small,{[v().non_chosen_rating]:0===s}),children:[...Array(r)].map((e,r)=>(0,i.jsx)(u.U,{isActive:t,theme:"green",pathClassName:v().svg_g},r))}),(0,i.jsx)("div",{className:v().filling,"data-testid":"popover__rating-progress-bar",children:(0,i.jsx)("div",{className:v().filled,style:d})}),(0,i.jsx)("div",{className:v().count,children:y(c)})]})},k=e=>{let{userVote:t,artId:r,votesAvg:o,votesCount:s,rating:_}=e,{t:b}=(0,c.$G)(),[k,{isLoading:x}]=n.qL.useAddArtRatingMutation(),[g,{isLoading:j}]=n.qL.useDeleteArtRatingMutation(),S=y(s),C=B(Math.ceil(10*o)/10),N=0!==t,[T,w]=(0,a.useState)(),P=(0,d.useSelector)(e=>e.foundationUser),A=(0,a.useMemo)(()=>P.id&&P.login,[P]),I=(0,n.TL)(),G=(0,a.useRef)(null);return(0,a.useEffect)(()=>{if(!x&&!j&&G.current&&void 0!==T){var e;null===(e=(0,p.zm)(G.current)[T])||void 0===e||e.focus(),w(0)}},[x,j]),(0,i.jsx)("div",{className:v().popup_wrapper,tabIndex:0,id:e.id,role:"dialog","aria-modal":"true","aria-label":_.isLiveLib?b("Рейтинг LiveLib"):b("Рейтинг книги"),ref:G,children:(0,i.jsxs)("div",{className:v().inside,children:[(0,i.jsxs)("div",{className:v().header,children:[(0,i.jsx)("div",{className:v().total,children:C}),(0,i.jsxs)("div",{className:v().count,children:[(0,i.jsx)("div",{className:v().count_text,children:b("Оценок:")}),(0,i.jsx)("div",{className:v().count_value,"data-testid":"popover__rating-counter",children:S})]})]}),(0,i.jsxs)("div",{className:v().stars_block,children:[(0,i.jsx)(f,{...e,index:5,isActive:5===t}),(0,i.jsx)(f,{...e,index:4,isActive:4===t}),(0,i.jsx)(f,{...e,index:3,isActive:3===t}),(0,i.jsx)(f,{...e,index:2,isActive:2===t}),(0,i.jsx)(f,{...e,index:1,isActive:1===t})]}),_.isLiveLib?(0,i.jsx)("div",{className:l()(v().user_review,v().user_review_center),children:(0,i.jsx)(h.Fg,{href:"/",className:v().link,children:b("Лучшие книги по рейтингу LiveLib")+" ›"})}):(0,i.jsx)("div",{children:(0,i.jsxs)("div",{className:v().user_review,role:"group","aria-labelledby":"rating-label",children:[(0,i.jsxs)("div",{id:"rating-label",className:v().user_review_text,children:[N?b("Ваша оценка:"):b("Оцените книгу:"),N&&(0,i.jsx)("div",{role:"status","aria-live":"polite",className:v().hidden,children:t})]}),x||j?(0,i.jsx)("div",{className:v().loader,role:"presentation",children:(0,i.jsx)(m.a,{mode:"dark"})}):(0,i.jsx)(u.t,{theme:"green",className:v().user_review_stars,starClassName:v().star_large,numberOfStars:5,clickHandler:i=>{if(w(i-1),!A){I(n.hi.global.interfaceRequests.setLoginPopupError({isOpen:!0,errorText:b("Чтобы оценить книгу, зарегистрируйтесь или войдите"),urlParams:{force:"userVote",rating:i,artId:r}}));return}t===i?(e.onClick(0),g({artId:Number(r)}),I(n.hi.global.arts.setUserRating(0))):(e.onClick(i),k({artId:Number(r),rating:i}),I(n.hi.global.arts.setUserRating(i)))},userVote:t,isHover:!0,isNoFill:!0})]})})]})})},x=e=>e.voted1+e.voted2+e.voted3+e.voted4+e.voted5,g=e=>1*e.voted1+2*e.voted2+3*e.voted3+4*e.voted4+5*e.voted5,j=e=>0===x(e)?0:g(e)/x(e),y=e=>{let t=+e;return t>9999?t.toLocaleString():t.toString()},B=e=>Number(e).toFixed(1).replace(".",","),S=(0,a.createContext)({votesAvg:"0",userVote:0,votesCount:"0"});var C=e=>{let{children:t,popoverOffset:r=[9,-61]}=e,[o,s]=(0,a.useState)(e.data.rating),[l,c]=(0,a.useState)(o.userVote),[d]=n.qL.useAddArtRatingMutation();(0,a.useEffect)(()=>{var t;s(e=>({...e,votesAvg:j(o)})),null===(t=e.onUserVote)||void 0===t||t.call(e,o.userVote,o.votesCount,j(o)),c(o.userVote)},[o.userVote]);let u=e=>{l>0?(e>0&&s(t=>({...t,["voted".concat(l)]:t["voted".concat(l)]-1,["voted".concat(e)]:t["voted".concat(e)]+1,userVote:e})),0===e&&s(t=>({...t,["voted".concat(l)]:t["voted".concat(l)]-1,votesCount:t.votesCount-1,userVote:e}))):e>0&&s(t=>({...t,["voted".concat(e)]:t["voted".concat(e)]+1,votesCount:t.votesCount+1,userVote:e}))},m=(0,a.useMemo)(()=>({votesAvg:B(o.votesAvg),userVote:o.userVote,votesCount:y(o.votesCount)}),[o.votesAvg,o.userVote,o.votesCount]),p=(0,a.useMemo)(()=>"function"==typeof t?t(m):t&&0!==a.Children.count(t)?a.Children.only(t):null,[t,m]),h=(0,n.TL)();return(0,a.useEffect)(()=>{let t=new URL(window.location.href);if(t.searchParams.has("force")&&"userVote"===t.searchParams.get("force")&&t.searchParams.has("artId")&&t.searchParams.get("artId")===String(e.data.artId)&&t.searchParams.has("rating")){let r=Number(t.searchParams.get("rating"));e.data.rating.userVote!==r&&(u(r),d({artId:Number(e.data.artId),rating:r}),h(n.hi.global.arts.setUserRating(r))),t.searchParams.delete("force"),t.searchParams.delete("artId"),t.searchParams.delete("rating"),window.history.pushState("",document.title,t.toString())}},[]),(0,i.jsx)(_.J,{placement:"bottom",strategy:"absolute",trigger:["click","hover"],offset:r,content:(0,i.jsx)(k,{...e.data,id:e.id,votesAvg:o.votesAvg,rating:o,userVote:o.userVote,votesCount:o.votesCount,onClick:u}),timer:9999999,contentClassName:v().rating,arrowClassName:v().inside_arrow,customCloseTriggers:["esc","lostIntersect"],children:(0,i.jsx)(S.Provider,{value:m,children:p})})},N=r(4031),T=r(73758),w=r(24810),P=r(70608),A=r(39925);let I=()=>(0,i.jsxs)("svg",{fill:"none",viewBox:"0 0 34 37",xmlns:"http://www.w3.org/2000/svg","data-testid":"livelib__popover-logo",children:[(0,i.jsxs)("g",{clipPath:"url(#clip0_16814_2890)",children:[(0,i.jsx)("path",{d:"m33.664 31.76c-0.2118-0.3982-0.5109-0.7219-0.8722-0.9459-0.3738-0.2365-0.7975-0.361-1.271-0.361-0.3738 0-0.7351 0.0872-1.0466 0.2365-0.1745 0.0872-0.3489 0.1992-0.4984 0.3236v-2.2404c0-0.1867-0.0623-0.336-0.1745-0.4605-0.1121-0.1245-0.2741-0.1618-0.4485-0.1618-0.1745 0-0.324 0.0622-0.4611 0.1742-0.1121 0.1121-0.1744 0.2739-0.1744 0.4606v4.319c0.0125 0.4979 0.1246 0.9584 0.3489 1.3567s0.5482 0.7219 0.947 0.9584c0.3987 0.224 0.8472 0.3485 1.3456 0.3485 0.4985 0 0.9595-0.112 1.3457-0.3485 0.3988-0.2365 0.7103-0.5601 0.9346-0.9584 0.2367-0.3983 0.3613-0.8588 0.3613-1.3567-0.0125-0.4979-0.1121-0.946-0.3364-1.3443zm-1.0965 2.116c-0.1246 0.224-0.2866 0.4107-0.4984 0.5352s-0.4486 0.1867-0.7227 0.1867c-0.2617 0-0.5109-0.0622-0.7227-0.1867-0.2118-0.1369-0.3738-0.3112-0.4984-0.5352s-0.1869-0.4854-0.1869-0.7717 0.0623-0.5477 0.1869-0.7717 0.2866-0.3983 0.4984-0.5228c0.2243-0.1369 0.4486-0.1991 0.7227-0.1991s0.5109 0.0622 0.7227 0.1991c0.2118 0.1245 0.3738 0.2988 0.4984 0.5228s0.1869 0.4854 0.1869 0.7717c0.0124 0.2863-0.0499 0.5477-0.1869 0.7717z",fill:"#3E99ED"}),(0,i.jsx)("path",{d:"m26.287 30.49c-0.1744 0-0.3239 0.0622-0.461 0.1742-0.1121 0.1121-0.1744 0.2739-0.1744 0.4606v4.0235c0 0.1742 0.0623 0.3236 0.1869 0.4605 0.1246 0.112 0.2741 0.1742 0.4485 0.1742 0.1869 0 0.3364-0.0622 0.461-0.1867 0.1122-0.1244 0.1745-0.2738 0.1745-0.448v-4.0235c0-0.1867-0.0623-0.3361-0.1745-0.4606-0.1246-0.112-0.2741-0.1742-0.461-0.1742z",fill:"#3E99ED"}),(0,i.jsx)("path",{d:"m26.288 28.262c-0.2119 0-0.3863 0.0746-0.5483 0.2364-0.1495 0.1494-0.2243 0.3237-0.2243 0.5352 0 0.2116 0.0748 0.3859 0.2243 0.5477 0.1495 0.1494 0.3364 0.224 0.5358 0.224 0.2118 0 0.3863-0.0746 0.5358-0.224s0.2367-0.3361 0.2367-0.5477c0-0.2115-0.0747-0.3858-0.2242-0.5352-0.1371-0.1493-0.324-0.2364-0.5358-0.2364z",fill:"#3E99ED"}),(0,i.jsx)("path",{d:"m23.61 34.539h-0.3108c-1.3157 0-1.6328-0.7985-1.6328-1.6195v-4.1466c0-0.1742-0.0623-0.3236-0.1744-0.4481-0.1246-0.112-0.2741-0.1742-0.4486-0.1742-0.1744 0-0.3239 0.0622-0.4485 0.1742-0.1122 0.1245-0.1745 0.2739-0.1745 0.4481v4.3333c0 1.9325 1.1392 2.6774 2.7918 2.6774h0.186c0.2118 0 0.3987-0.0497 0.5482-0.1618 0.162-0.112 0.2367-0.2738 0.2367-0.4605 0-0.1742-0.0498-0.3236-0.1619-0.4356-0.0997-0.1245-0.2492-0.1867-0.4112-0.1867z",fill:"#3E99ED"}),(0,i.jsx)("path",{d:"m17.703 30.789c-0.3614-0.2241-0.7975-0.3361-1.2959-0.3361s-0.9469 0.112-1.3457 0.3485c-0.3862 0.2241-0.6977 0.5352-0.922 0.946-0.2118 0.3983-0.324 0.8588-0.324 1.3691s0.1122 0.9709 0.3489 1.3816c0.2368 0.3983 0.5607 0.7095 0.9719 0.946 0.4112 0.224 0.8847 0.336 1.408 0.336 0.2866 0 0.5981-0.0498 0.9096-0.1618 0.324-0.112 0.5981-0.2489 0.8099-0.4232 0.1869-0.1369 0.2243-0.3111 0.2118-0.4232-0.0124-0.1493-0.0872-0.2987-0.2243-0.4231-0.0996-0.0872-0.2242-0.137-0.3613-0.137h-0.0249c-0.1371 0-0.2741 0.0498-0.3863 0.137-0.0997 0.0746-0.2492 0.1493-0.4236 0.2116-0.1745 0.0622-0.3365 0.0871-0.5109 0.0871-0.4112 0-0.7601-0.112-1.0342-0.3485-0.2243-0.1867-0.3738-0.4232-0.461-0.697h3.1773c0.162 0 0.2991-0.0498 0.4237-0.1619 0.1121-0.112 0.1619-0.2489 0.1619-0.4107 0-0.4979-0.0996-0.946-0.2865-1.3194-0.1745-0.3858-0.4611-0.697-0.8224-0.921zm-2.6416 1.7425c0.0748-0.2489 0.2119-0.4605 0.3988-0.6348 0.2367-0.2115 0.5482-0.3236 0.9469-0.3236 0.3614 0 0.6355 0.0996 0.8349 0.3236 0.1744 0.1743 0.2865 0.3859 0.3488 0.6348h-2.5294z",fill:"#3E99ED"}),(0,i.jsx)("path",{d:"m12.535 30.545c-0.0867-0.0381-0.1858-0.0634-0.2725-0.0634-0.062 0-0.1239 0.0127-0.1859 0.0253-0.1487 0.0507-0.2602 0.1522-0.3469 0.3043l-1.3753 3.0675-1.3877-3.0675c-0.07434-0.1395-0.18585-0.2409-0.33453-0.2916-0.06195-0.0253-0.1239-0.038-0.17346-0.038-0.08674 0-0.17347 0.0253-0.2602 0.0634-0.14868 0.076-0.26019 0.1901-0.32214 0.3295-0.04956 0.1395-0.04956 0.2916 0.02478 0.4437l1.8833 4.0689c0.16107 0.3296 0.40887 0.393 0.58237 0.393 0.1734 0 0.4212-0.0761 0.5699-0.4056l1.8833-4.069c0.062-0.1394 0.0744-0.3042 0.0248-0.4436-0.0619-0.1268-0.1611-0.2409-0.3098-0.3169z",fill:"#3E99ED"}),(0,i.jsx)("path",{d:"m5.8938 30.49c-0.17444 0-0.32397 0.0622-0.46103 0.1742-0.11214 0.1121-0.17444 0.2739-0.17444 0.4606v4.0235c0 0.1742 0.0623 0.3236 0.1869 0.4605 0.1246 0.112 0.27413 0.1742 0.44857 0.1742 0.1869 0 0.33642-0.0622 0.46102-0.1867 0.11214-0.1244 0.17444-0.2738 0.17444-0.448v-4.0235c0-0.1867-0.0623-0.3361-0.17444-0.4606-0.1246-0.112-0.27412-0.1742-0.46102-0.1742z",fill:"#3E99ED"}),(0,i.jsx)("path",{d:"m5.8936 28.262c-0.21182 0-0.38626 0.0746-0.54824 0.2364-0.14953 0.1494-0.22429 0.3237-0.22429 0.5352 0 0.2116 0.07476 0.3859 0.22429 0.5477 0.14952 0.1494 0.33642 0.224 0.53578 0.224 0.21182 0 0.38627-0.0746 0.53579-0.224s0.23674-0.3361 0.23674-0.5477c0-0.2115-0.07476-0.3858-0.22428-0.5352-0.13706-0.1493-0.32397-0.2364-0.53579-0.2364z",fill:"#3E99ED"}),(0,i.jsx)("path",{d:"m3.1896 34.539h-0.3108c-1.3157 0-1.6328-0.7985-1.6328-1.6195v-4.1466c0-0.1742-0.0623-0.3236-0.17444-0.4481-0.1246-0.112-0.27412-0.1742-0.44856-0.1742-0.17444 0-0.32396 0.0622-0.44856 0.1742-0.11214 0.1245-0.17444 0.2739-0.17444 0.4481v4.3333c0 1.9325 1.1392 2.6774 2.7918 2.6774h0.18595c0.21183 0 0.39873-0.0497 0.54825-0.1618 0.16198-0.112 0.23674-0.2738 0.23674-0.4605 0-0.1742-0.04984-0.3236-0.16198-0.4356-0.09968-0.1245-0.2492-0.1867-0.41118-0.1867z",fill:"#3E99ED"}),(0,i.jsx)("path",{d:"m18.593 24.067c3.2086-1.9175 7.4406-4.4572 8.9408-5.3482s2.4664-1.6254 2.4664-3.2655c0-1.64-0.0097-11.762-0.0097-13.178 0-1.4168-1.2912-2.3387-2.9161-1.3828-1.4141 0.83178-10.074 6.0248-10.074 6.0248s-8.4821-5.0874-10.073-6.0248c-1.591-0.93744-2.9163-0.061293-2.9163 1.3945 0 1.4558-0.00568 12.135-0.01119 13.164 0 1.665 1.0209 2.3857 2.4661 3.2683s5.6921 3.4393 8.9468 5.3482c0.2527 0.1482 0.7891 0.4334 1.5889 0.4334s1.366-0.299 1.591-0.4334z",fill:"url(#a)",clipRule:"evenodd",fillRule:"evenodd"})]}),(0,i.jsx)("defs",{children:(0,i.jsxs)("linearGradient",{id:"a",x1:"30",x2:"4",y1:"10.249",y2:"10.251",gradientUnits:"userSpaceOnUse",children:[(0,i.jsx)("stop",{offset:"0",stopColor:"#3E99ED"}),(0,i.jsx)("stop",{offset:"1",stopColor:"#59C7FF"})]})})]});var G=r(22589),R=r.n(G);let E=e=>e.replace(/\B(?=(\d{3})+(?!\d))/g,"\xa0"),W=e=>{let{count:t,votesCount:r,index:n}=e,o=(0,a.useMemo)(()=>({width:"".concat(Math.round(100*t/r),"%")}),[r,t]);return(0,i.jsxs)("div",{className:R().stars_row,children:[(0,i.jsx)("div",{className:l()(R().star_small),children:[...Array(n)].map((e,t)=>(0,i.jsx)(u.U,{isActive:!1,theme:"green",pathClassName:R().svg_g},t))}),(0,i.jsx)("div",{className:R().filling,children:(0,i.jsx)("div",{className:R().filled,style:o})}),(0,i.jsx)("div",{className:R().count,children:D(t)})]})},L=e=>{let{votesAvg:t,votesCount:r,rating:n,onClickLink:a}=e,{t:s}=(0,c.$G)(),l=D(r),d=M(Math.ceil(10*t)/10);return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:R().wrapper,tabIndex:0,id:e.id,role:"dialog","aria-modal":"true","aria-labelledby":"liveLibRatingTitle","aria-describedby":"liveLibRatingDescr",children:[(0,i.jsx)("div",{className:R().title,id:"liveLibRatingTitle",children:s("Рейтинг экспертов книжной социальной сети LiveLib")}),(0,i.jsxs)("div",{className:R().inside,id:"liveLibRatingDescr",children:[(0,i.jsxs)("div",{className:R().header,children:[(0,i.jsx)("div",{className:R().total,"data-testid":"livelib__popover-average-mark",children:d}),(0,i.jsx)(I,{}),(0,i.jsxs)("div",{className:R().count,children:[(0,i.jsx)("div",{className:R().count_text,children:s("Оценок:")}),(0,i.jsx)("div",{className:R().count_value,"data-testid":"livelib__popover-total-ratings",children:E(l)})]})]}),(0,i.jsx)("div",{className:R().stars_block,"data-testid":"livelib__popover-stars-rating-block",children:n.map((e,t)=>(0,i.jsx)(W,{votesCount:r,count:e,index:5-t},"".concat(e," + ").concat(t)))})]})]}),(0,i.jsx)("div",{className:R().footer,children:(0,i.jsxs)(h.Fg,{href:"/collections/knigi-ot-livelib/",onClick:a,e2eId:"livelib__popover-best-rating",children:[s("Лучшие книги по рейтингу LiveLib"),(0,i.jsx)(o.uQ,{name:"crumbArrow",height:10,width:6})]})})]})},D=e=>{let t=+e;return t>9999?t.toLocaleString():t.toString()},M=e=>Number(e).toFixed(1).replace(".",",");var F=e=>{let{children:t,popoverOffset:r=[9,-61]}=e;return(0,i.jsx)(_.J,{placement:"bottom",strategy:"absolute",trigger:["click","hover"],offset:r,content:(0,i.jsx)(L,{id:e.id,...e.data}),timer:9999999,contentClassName:R().rating,arrowClassName:R().inside_arrow,customCloseTriggers:["esc","lostIntersect"],children:t})},O=r(62725),z=r.n(O);let K=e=>{var t,r;let{t:s}=(0,c.$G)(),{art:_,bookSubPath:u}=(0,w.G)(),{quotesRef:m,reviewsRef:b}=e,{isDesktop:v}=(0,w.G)(),f=(0,d.useSelector)(e=>e.foundationUser.id),{headers:k,pda:x}=(0,n.CG)(e=>e.browser),g=(0,p.Ov)(k["client-host"]),j=!!u&&(0,P.s$)(u),y=!!u&&(0,P.$K)(u),B=!!u&&(0,P.kR)(u),S=!!u&&(0,P.KX)(u),I=!!u&&(0,P.D)(u),G=(0,P.Lx)(_),R=!u||j||y||B||S||I,E=!u||j||y||B||S||I,{rating:W,livelib_rated_avg:L,livelib_ratings:D,livelib_rated_count:M,reviews_count:O,quotes_count:K}=_,[q,U]=(0,a.useState)(null==W?void 0:W.user_rating),[V,X]=(0,a.useState)(null==W?void 0:W.rated_total_count),[Z,$]=(0,a.useState)(null==W?void 0:W.rated_avg),[Q,H]=(0,a.useState)(!1);(0,a.useEffect)(()=>{U(null==W?void 0:W.user_rating),X(null==W?void 0:W.rated_total_count),$(null==W?void 0:W.rated_avg)},[null==_?void 0:_.id,W]);let Y={userVote:(null==W?void 0:W.user_rating)||0,voted1:(null==W?void 0:W.rated_1_count)||0,voted2:(null==W?void 0:W.rated_2_count)||0,voted3:(null==W?void 0:W.rated_3_count)||0,voted4:(null==W?void 0:W.rated_4_count)||0,voted5:(null==W?void 0:W.rated_5_count)||0,votesAvg:(null==W?void 0:W.rated_avg)||0,votesCount:(null==W?void 0:W.rated_total_count)||0},J={artId:_.id,rating:Y,votesCount:(null===(t=_.rating)||void 0===t?void 0:t.rated_total_count)||0,votesAvg:(null===(r=_.rating)||void 0===r?void 0:r.rated_avg)||0,userVote:0,onClick:()=>{}},ee=(e,t,r)=>{f>0&&(U(e),X(t),$(r))},et=()=>{u||H(b||!1),T.TM.sendEvent(["LITRES_TRACKER"],{eventType:O?"book_card_reviews_сlick":"book_card_review_write_attempt_click",params:(0,P.Eb)({art:_,extra:O?{}:{facts:!0}})})},er=()=>{u||H(m||!1)},ei=e=>{if(e.current){let t=e.current.getBoundingClientRect().top+window.scrollY-(v?144:24);window.scrollTo({top:t,behavior:"smooth"}),H(!1),(0,p.su)(e.current)}};return(0,a.useEffect)(()=>{Q&&ei(Q)},[Q]),(0,i.jsxs)("div",{className:l()(z().block,{[z().block_bookPages]:!!u}),"data-testid":"book-factoids__wrapper",children:[(0,i.jsxs)("div",{...Y.votesCount>0?{itemProp:"aggregateRating",itemScope:!0,itemType:"https://schema.org/AggregateRating"}:{},className:l()(z().section,z().rating,{[z().grey]:!Z,[z().green]:q}),"data-testid":"book-factoids__rating",children:[Y.votesCount>0&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("meta",{itemProp:"worstRating",content:"1"}),(0,i.jsx)("meta",{itemProp:"bestRating",content:"5"}),(0,i.jsx)("meta",{itemProp:"ratingValue",content:(Math.ceil(10*Y.votesAvg)/10).toFixed(1)}),(0,i.jsx)("meta",{itemProp:"ratingCount",content:String(Y.votesCount)})]}),(0,i.jsx)(C,{id:"rating-popup",data:J,popoverOffset:[19,104],onUserVote:(e,t,r)=>{ee(e,t,r)},children:(0,i.jsxs)("div",{tabIndex:0,role:"button","aria-label":V?s("Открыть попап чтобы проставить оценку. Средний рейтинг {vote} на основе {count} оценок",{count:V,vote:(0,A.g)(Z)}):s("Открыть попап чтобы проставить оценку. "),"aria-haspopup":"dialog","aria-controls":"rating-popup",className:z().factoids__item,children:[(0,i.jsxs)("div",{className:z().primary,"data-testid":"book-factoids__total-rating",children:[(0,i.jsx)(o.uQ,{name:"rating",size:16,className:z().icon}),(0,A.g)(Z)]}),(0,i.jsx)("div",{className:l()(z().secondary,z().rating),"data-testid":"book-factoids__marks",children:V?(0,i.jsx)(i.Fragment,{children:"".concat(s("{count} оценка",{count:V}).replace(/\B(?=(\d{3})+(?!\d))/g,V.toString().length>4?" ":"").toLowerCase())}):(0,i.jsx)(h.Fg,{tabIndex:-1,children:s("Оцените книгу")})})]})})]}),!G&&!!M&&!g&&!u&&(0,i.jsx)("div",{className:l()(z().section,z().livelib),children:(0,i.jsx)(F,{id:"livelib-rating-popup",data:{rating:[(null==D?void 0:D.rating_5_count)||0,(null==D?void 0:D.rating_4_count)||0,(null==D?void 0:D.rating_3_count)||0,(null==D?void 0:D.rating_2_count)||0,(null==D?void 0:D.rating_1_count)||0],votesAvg:L||0,votesCount:M,onClickLink:()=>{T.TM.sendEvent(["LITRES_TRACKER"],{eventType:"book_card_livelib_rate_click",params:(0,P.Eb)({art:_})})}},popoverOffset:x?[19,90]:[19,104],children:(0,i.jsxs)("div",{"data-testid":"book-factoids__livelib",tabIndex:0,role:"button","aria-label":M?s("Рейтинг экспертов книжной социальной сети LiveLib. Средний рейтинг {vote} на основе {count} оценок",{count:M,vote:(0,A.g)(L)}):s("Рейтинг экспертов книжной социальной сети LiveLib. "),"aria-haspopup":"dialog","aria-controls":"livelib-rating-popup",className:z().factoids__item,children:[(0,i.jsxs)("div",{className:z().primary,children:[(0,i.jsx)(N.J,{name:"livelib16"}),(0,i.jsx)("span",{children:(0,A.g)(L)})]}),(0,i.jsx)("div",{className:z().secondary,children:"".concat(s("{count} оценка",{count:M})).replace(/\B(?=(\d{3})+(?!\d))/g,M.toString().length>4?" ":"").toLowerCase()})]})})}),R&&(0,i.jsx)("div",{className:l()(z().section,z().reviews,{[z().grey]:!O}),children:(0,i.jsxs)("div",{"data-testid":"book-factoids__reviews",tabIndex:0,onClick:et,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),e.stopPropagation(),et())},role:"button","aria-label":s("Отзывы"),className:z().factoids__item,children:[(0,i.jsx)("div",{className:z().primary,children:(0,i.jsx)("span",{children:O?(0,P.bf)(O):0})}),(0,i.jsx)("div",{className:z().secondary,children:(0,i.jsx)(h.Fg,{tabIndex:-1,href:u?"".concat(_.url,"otzivi/"):void 0,children:O?s((0,p.pd)(O,["Отзыв","Отзыва","Отзывов"])).toLowerCase():(0,i.jsx)(i.Fragment,{children:s("Оставить отзыв")})})})]})}),!!K&&E&&(0,i.jsx)("div",{className:l()(z().section,z().quotations),children:(0,i.jsxs)("div",{"data-testid":"book-factoids__quotations",tabIndex:0,onClick:er,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),e.stopPropagation(),er())},role:"button","aria-label":s("Цитаты"),className:z().factoids__item,children:[(0,i.jsx)("div",{className:z().primary,children:(0,P.bf)(K)}),(0,i.jsx)("div",{className:z().secondary,children:(0,i.jsx)(h.Fg,{tabIndex:-1,href:u?"".concat(_.url,"citaty/"):void 0,children:s((0,p.pd)(K,["Цитата","Цитаты","Цитат"])).toLowerCase()})})]})})]},_.id)}},56362:function(e,t,r){"use strict";r.d(t,{r:function(){return b},F:function(){return v}});var i=r(31549),n=r(44194),o=r(59838),a=r(61794),s=r(48376),l=r(48592),c=r(24810),d=r(68218),_=r(70608),u=r(15381),m=r(18370),p=r(97439);let h=e=>{let{data:t}=a.qL.useGetArtFilesQuery({artId:e.id},{skip:(0,_.Lx)(e)}),r=(0,n.useMemo)(()=>{if(!t)return{data:[],shouldExtractChapters:!1};switch(e.art_type){case m.lG.text:{let e=new Map;return t.forEach(t=>{if(t.extension){let r=t.extension;if(e.has(r)){let i=e.get(r);i&&i.id<t.id&&e.set(r,t)}else e.set(r,t)}}),{data:[...e.values()],shouldExtractChapters:!1}}case m.lG.audio:{let e=!1,r=!1,i=new Set,n=t.filter(t=>("zip_with_mp3"===t.encoding_type&&(e=!0),i.has(t.encoding_type)?r=!0:i.add(t.encoding_type),p.nv.includes(t.encoding_type)));return{data:e?n.filter(e=>p.ik.includes(e.encoding_type)):n,shouldExtractChapters:!e&&r}}case m.lG.pdf:return{data:t.filter(e=>p.hB.includes(e.encoding_type)),shouldExtractChapters:!1};case m.lG.epub:return{data:t.filter(e=>p.bl.includes(e.encoding_type)||p.XS.includes(e.extension)).sort((e,t)=>t.id-e.id).slice(0,1),shouldExtractChapters:!1};case m.lG.podcastEpisode:return{data:t.filter(e=>p.nv.includes(e.encoding_type)),shouldExtractChapters:!1};default:return{data:[],shouldExtractChapters:!1}}},[t,e.art_type]);return{get files(){return r.data},get shouldExtractChapters(){return r.shouldExtractChapters}}},b=(0,n.createContext)({openFilesModal:o.ZT,fullFiles:[]}),v=e=>{let{children:t}=e,r=(0,a.TL)(),{art:o}=(0,c.G)(),m=(0,a.CG)(e=>e.foundationUser),{t:p}=(0,l.$G)(),v=(0,u.t)(),[f,k]=(0,n.useState)(!1),{files:x,shouldExtractChapters:g}=h(o),j=()=>!!v||(r(a.hi.global.interfaceRequests.setLoginPopupError({isOpen:!0,errorText:"".concat(p("Для скачивания книги")," \xab").concat(o.title,"\xbb ").concat(p("зарегистрируйтесь или войдите"))})),!1),y=e=>()=>{j()&&k(e)};return(0,i.jsxs)(b.Provider,{value:{openFilesModal:y(!0),fullFiles:x},children:[t,x.length>0&&(0,i.jsx)(s.R,{isOpen:f,onClose:y(!1),isOnRightSide:!0,modalViewId:"filesModal",ariaLabel:p("Форматы для скачивания книги"),children:(0,i.jsx)(d.o,{art:o,files:x,shouldExtractChapters:g,hideUrl:(0,_.Kx)({art:o,user:m})})})]})}},22348:function(e,t,r){"use strict";r.d(t,{J:function(){return o}});var i=r(44194),n=r(56362);let o=()=>(0,i.useContext)(n.r)},76934:function(e,t,r){"use strict";r.d(t,{g:function(){return b}});var i=r(31549),n=r(44194),o=r(48592),a=r(62094),s=r(55714),l=r(59838),c=r(83235),d=r(41104),_=r(24810),u=r(70608),m=r(97439),p=r(19327),h=r.n(p);let b=n.memo(e=>{let{dataTestId:t}=e,{art:r}=(0,_.G)(),{t:p}=(0,o.$G)(),b=(0,u.kk)(r),v=(0,a.Gc)("breakpoint-1024"),f=(0,n.useMemo)(()=>{let e=[];return r.genres&&(e=e.concat(r.genres.map(e=>({...e,url:e.url?(0,l.xd)(e.url):e.url})))),r.tags&&(e=e.concat(...r.tags)),e.sort((e,t)=>{let{name:r}=e,{name:i}=t;return r.toUpperCase()<i.toUpperCase()?-1:r.toUpperCase()>i.toUpperCase()?1:0}),b&&(e=e.map(e=>e.url?{...e,url:e.url+m.DI.PODCAST}:e)),e},[r.tags,r.genres]);return f.length<0?null:(0,i.jsxs)("div",{"data-testid":t,children:[(0,i.jsx)("h4",{className:h().title,children:p("Жанры и теги")}),(0,i.jsx)("div",{className:h().genresList,children:v?(0,i.jsx)(c.K,{maxHeight:192,children:f.map(e=>{var t;return(0,i.jsx)(d.V,{text:(0,l.kC)(e.name),className:h().genresList__tags,href:null!==(t=e.url)&&void 0!==t?t:void 0},e.id)})}):(0,i.jsx)(i.Fragment,{children:f.map((e,t)=>{var r;return(0,i.jsxs)("div",{children:[(0,i.jsx)(s.Fg,{href:null!==(r=e.url)&&void 0!==r?r:void 0,className:h().genresList__item,children:(0,l.kC)(e.name)}),t<f.length-1&&(0,i.jsx)("span",{"aria-hidden":"true",children:", "})]},e.id)})})})]})})},29785:function(e,t,r){"use strict";r.d(t,{o:function(){return y}});var i=r(31549),n=r(44194),o=r(62094),a=r(24810),s=r(70608),l=r(34955),c=r(89798),d=r(48592),_=r(18370),u=r(59838),m=r(61794),p=r(73758),h=r(15381),b=r(97439),v=r(58749),f=r(71351),k=r.n(f);let x=()=>{let{t:e}=(0,d.$G)(),{art:t,bookSubPath:r}=(0,a.G)(),o=(0,h.t)(),l=(0,m.CG)(e=>e.foundationUser),f=(0,m.CG)(e=>e.browser.headers["client-host"]),x=(0,m.CG)(e=>e.face.language||"ru"),g=t.is_art_online_readable&&t.art_type===_.lG.text&&((0,s.Yg)(t)||(0,s.N9)({art:t,user:l})),j=(0,s.dV)({art:t,user:l}),y=!(0,s.Yg)(t)&&!j,B=o&&(0,s.Gs)(t)&&((0,s.Yg)(t)||j),S=(0,n.useMemo)(()=>{var r,i;if(B)return(0,u.qZ)({art:t,user:l,isLibrary:(0,u.Af)(f||""),isBookCard:!0,translator:e,lang:x});if(!g)return"";let n=(null===(r=t.url)||void 0===r?void 0:r.endsWith("/"))?t.url:"".concat(null!==(i=t.url)&&void 0!==i?i:"","/"),o="ru"===x?b.mW.readOnlineRu:b.mW.readOnlineGlobal;return"".concat(n).concat(o,"/")},[g,B,x,f,t,l,e]);return g?(0,i.jsx)(c.L,{className:k().bookReadOnline,href:S,onClick:()=>{B?p.TM.sendEvent(["LITRES_TRACKER"],{eventType:"read_click",params:(0,s.Eb)({art:t,extra:{source_internal:(0,s.bu)(r),art_type:(0,v.L)(t.art_type,t.is_draft),trial_flag:y}})}):p.TM.sendEvent(["LITRES_TRACKER"],{eventType:"book_card_read_online_view",params:(0,s.Eb)({art:t})})},size:"medium",analyticsId:t.is_free?"read-free-fragment-button":"read-fragment-button",e2eId:"read__fragment-button",children:e("Читать онлайн")}):null};var g=r(31643),j=r.n(g);let y=n.memo(e=>{let{dataTestId:t}=e,r=(0,o.Gc)("breakpoint-700"),{bookSubPath:n}=(0,a.G)(),c=(0,s.s$)(n);return(0,i.jsxs)("div",{className:j().innerFunctionalBlock,"data-testid":t,children:[(0,i.jsx)("div",{className:j().innerFunctionalBlock__item,children:(0,i.jsx)(l.T,{isMobile:r})}),(0,i.jsx)("div",{className:j().innerFunctionalBlock__item,children:!c&&(0,i.jsx)(x,{})})]})})},78496:function(e,t,r){"use strict";r.d(t,{X:function(){return m}});var i=r(31549),n=r(44194),o=r(48592),a=r(59838),s=r(58655),l=r(89798),c=r(24810),d=r(5665),_=r.n(d),u=r(40007);let m=()=>{let{art:{id:e,linked_arts:t,cover_ratio:r,title:d},bookSubPath:m}=(0,c.G)(),[p,h]=(0,n.useState)(!1),{t:b}=(0,o.$G)(),v=()=>{h(!0)};return t&&0!==t.length?(0,i.jsxs)(i.Fragment,{children:[m?(0,i.jsx)(l.L,{onClick:v,contentClassName:_().target,children:b("Ещё {count} ".concat((0,a.pd)(t.length,["версия","версии","версий"])," книги"),{count:t.length})}):(0,i.jsxs)("div",{onClick:v,className:_().button,"data-testid":"book__otherVersions--wrapper",children:[(0,i.jsxs)("div",{className:_().button__side,children:[(0,i.jsx)("h4",{className:_().button__title,children:b("Другие версии")}),(0,i.jsx)("div",{className:_().button__subtitle,"data-testid":"book__otherVersions--count",children:"".concat(t.length," ").concat(b((0,a.pd)(t.length,["книга","книги","книг"])))})]}),(0,i.jsx)("div",{className:_().button__cover__wrapper,children:(0,i.jsx)("div",{className:_().button__cover,children:(0,i.jsx)(s.uq,{artId:e,alt:d,loading:"lazy",height:68,width:68*(r&&r<=1?r:1),coverSizes:{desktopNormal:415,desktopHighDensity:415,mobileNormal:330,mobileHighDensity:330},wrapperClassName:_().button__cover__img})})})]}),(0,i.jsx)(u.Z,{isOpen:p,onClose:()=>{h(!1)}})]}):null}},40007:function(e,t,r){"use strict";r.d(t,{Z:function(){return f}});var i=r(31549),n=r(44194),o=r(48592),a=r(48376),s=r(24810),l=r(58655),c=r(4438),d=r(28637),_=r(59838),u=r(20239),m=r(44357),p=r(84233),h=r(74369),b=r.n(h);let v=e=>{var t,r,a,s,h,v,f,k,x;let{linkedArt:g,isSynchronized:j,enableImage:y,onCloseModal:B}=e,{t:S,i18n:C}=(0,o.$G)(),N=(0,n.useMemo)(()=>new m.p(g,j),[g,j]),T=(0,_.aS)(null===(t=g.prices)||void 0===t?void 0:t.cost_with_bonus,null===(r=g.prices)||void 0===r?void 0:r.currency,C.language),w=null===(a=g.persons)||void 0===a?void 0:a.find(e=>"reader"===e.role),P=(null===(s=g.prices)||void 0===s?void 0:s.full_price)!==(null===(h=g.prices)||void 0===h?void 0:h.cost_with_bonus),A=(0,_.aS)((null===(v=g.prices)||void 0===v?void 0:v.full_price)||0,null===(f=g.prices)||void 0===f?void 0:f.currency,C.language),I=S(N.isForListen?"Синхронизировано с текстовой версией":"Синхронизировано с аудио версией");return(0,i.jsxs)("div",{className:b().linkedArt,children:[(0,i.jsx)(u.I,{href:g.url,className:b().linkedArt__cover__wrapper,onClick:B,"data-testid":"book__otherVersionsModal--artCover",children:y?(0,i.jsx)(l.uq,{artId:g.id,alt:g.title,coverSizes:{mobileNormal:37,mobileHighDensity:95,desktopNormal:100,desktopHighDensity:200},unloaderSize:30,wrapperClassName:b().linkedArt__cover,imgTagClassName:b().linkedArt__cover__img}):g.title}),(0,i.jsxs)("div",{className:b().linkedArt__info,children:[(0,i.jsx)(u.I,{href:g.url,className:b().linkedArt__title,onClick:B,"data-testid":"book__otherVersionsModal--artName",children:g.title}),N.isForListen&&w&&(0,i.jsxs)(u.I,{href:w.url,className:b().linkedArt__reader,onClick:B,children:[S("Читает")," ",w.full_name]}),(0,i.jsx)("div",{className:b().linkedArt__label,"data-testid":"book-other-version-modal__lable",children:(0,i.jsx)(p.E,{type:"full",format:N})})]}),(0,i.jsxs)("div",{className:b().linkedArt__price,"data-testid":"book__otherVersionsModal--artPrice",children:[(0,i.jsx)("span",{className:b().linkedArt__price_final,"data-testid":"book__otherVersionsModal--artFinalPrice",children:g.is_free||(null==g?void 0:g.is_draft_full_free)?S("бесплатно"):T}),!(g.is_free||(null==g?void 0:g.is_draft_full_free))&&((null===(k=g.prices)||void 0===k?void 0:k.discount_percent)||P)&&(0,i.jsxs)("div",{className:b().linkedArt__price_full,"data-testid":"book__otherVersionsModal--artFullPrice",children:[A,(null===(x=g.prices)||void 0===x?void 0:x.discount_percent)&&(0,i.jsx)("div",{className:b().linkedArt__price__label,children:(0,i.jsx)(d.y,{text:"-".concat(g.prices.discount_percent,"%"),size:"xs",hasBorder:!1})})]})]}),j&&(0,i.jsxs)("div",{className:b().syncBlock,children:[(0,i.jsxs)("div",{className:b().syncBlock__title__wrapper,"data-testid":"book__otherVersionsModal--syncTitle",children:[(0,i.jsx)(c.uQ,{name:"syncFilled",size:16,className:b().syncBlock__icon}),(0,i.jsx)("span",{className:b().syncBlock__title,children:I})]}),(0,i.jsx)("p",{className:b().syncBlock__text,children:S("В этой версии книги вы можете с легкостью переключиться с электронной на аудиоверсию (или наоборот) и продолжить читать или слушать произведение с того места, на котором остановились ранее.")})]})]},g.id)};var f=e=>{let{isOpen:t,onClose:r}=e,{art:{linked_arts:n,synchronized_arts:l}}=(0,s.G)(),{t:c}=(0,o.$G)();if(!n||0===n.length)return null;let d=l.map(e=>e.id),_=n.reduce((e,t)=>(e[t.linked_art_group].push(t),e),{another_translate:[],art_parts:[],audio_arts:[],collection_with_art:[],re_releases:[],similar_arts:[],text_arts:[],unrecognized:[],prequel:[]});return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(a.R,{onClose:r,isOpen:t,title:c("Другие версии книги"),isOnRightSide:!0,testId:"book__otherVersionsModal--wrapper",modalViewId:"book-other-version-modal",e2eId:"book__otherVersionModal--title",children:(0,i.jsxs)("div",{className:b().container,children:[_.text_arts.length>0&&(0,i.jsxs)("div",{className:b().version,children:[(0,i.jsx)("span",{className:b().version__title,children:c("Текстовые книги")}),_.text_arts.map(e=>(0,i.jsx)(v,{linkedArt:e,isSynchronized:d.includes(e.id),enableImage:t,onCloseModal:r},e.id))]}),_.audio_arts.length>0&&(0,i.jsxs)("div",{className:b().version,"data-testid":"book-other-version-modal__art",children:[(0,i.jsx)("span",{className:b().version__title,children:c("Аудиокниги")}),_.audio_arts.map(e=>(0,i.jsx)(v,{linkedArt:e,isSynchronized:d.includes(e.id),enableImage:t,onCloseModal:r},e.id))]}),_.re_releases.length>0&&(0,i.jsxs)("div",{className:b().version,children:[(0,i.jsx)("span",{className:b().version__title,children:c("Переиздания")}),_.re_releases.map(e=>(0,i.jsx)(v,{linkedArt:e,isSynchronized:d.includes(e.id),enableImage:t,onCloseModal:r},e.id))]}),_.another_translate.length>0&&(0,i.jsxs)("div",{className:b().version,children:[(0,i.jsx)("span",{className:b().version__title,children:c("Другие переводы")}),_.another_translate.map(e=>(0,i.jsx)(v,{linkedArt:e,isSynchronized:d.includes(e.id),enableImage:t,onCloseModal:r},e.id))]}),_.collection_with_art.length>0&&(0,i.jsxs)("div",{className:b().version,children:[(0,i.jsx)("span",{className:b().version__title,children:c("Сборник с этой книгой")}),_.collection_with_art.map(e=>(0,i.jsx)(v,{linkedArt:e,isSynchronized:d.includes(e.id),enableImage:t,onCloseModal:r},e.id))]}),_.art_parts.length>0&&(0,i.jsxs)("div",{className:b().version,children:[(0,i.jsx)("span",{className:b().version__title,children:c("Части этой книги")}),_.art_parts.map(e=>(0,i.jsx)(v,{linkedArt:e,isSynchronized:d.includes(e.id),enableImage:t,onCloseModal:r},e.id))]}),_.similar_arts.length>0&&(0,i.jsxs)("div",{className:b().version,children:[(0,i.jsx)("span",{className:b().version__title,children:c("Похожие книги")}),_.similar_arts.map(e=>(0,i.jsx)(v,{linkedArt:e,isSynchronized:d.includes(e.id),enableImage:t,onCloseModal:r},e.id))]})]})})})}},97265:function(e,t,r){"use strict";r.d(t,{i:function(){return f}});var i,n,o=r(31549),a=r(44194),s=r(48592),l=r(61794),c=r(76791),d=r(70608),_=r(64009),u=r(21232),m=r(73758),p=r(52805);(i=n||(n={})).view="block_view",i.click="book_card_slider_click";let h=e=>{let{title:t,url:r,data:i,isLoading:s,analyticsData:c}=e,d=(0,l.CG)(e=>e.browser.pda),h=(0,a.useRef)(null),b=(0,_.S1)(h,{threshold:.3}),v=!!(null==b?void 0:b.isIntersecting),f=(0,a.useRef)(!0);(0,a.useEffect)(()=>{i.length>0&&v&&f.current&&(f.current=!1,m.TM.sendEvent(["LITRES_TRACKER"],{eventType:n.view,params:{...c.eventData,ids:i.map(e=>e.id).join(","),adv_arts:(0,p.aN)(i)}}))},[i,v,c]);let k=(0,a.useCallback)((e,t)=>({eventType:n.click,eventData:{...c.eventData,row_number:t}}),[c]);return s||0!==i.length?(0,o.jsx)("div",{ref:h,"data-testid":"slider--wrapper__other-arts",children:(0,o.jsx)(u.p,{url:r,title:t,data:i,isPDA:d,isSkeleton:s,handleClickTitle:()=>{m.TM.sendEvent(["LITRES_TRACKER"],{eventType:n.click,params:{...c.eventData,type:"header"}})},handleSeeAllClick:()=>{m.TM.sendEvent(["LITRES_TRACKER"],{eventType:n.click,params:{...c.eventData,type:"slider_button"}})},analyticsData:k,advAnalyticsData:{place_slug:"book_card"}})}):null};var b=r(96007),v=r.n(b);let f=e=>{var t;let{authorIdOrSlug:r,art:i,analyticsData:_}=e,{t:u}=(0,s.$G)(),m=(0,d.kk)(i),p=null==i?void 0:null===(t=i.persons)||void 0===t?void 0:t.find(e=>"author"===e.role),b=null!=r?r:p?p.id:0,{eventData:f={}}=_,{source_internal:k="book_card"}=f,x=(0,c.bi)("bookcard_adv_slider","true"),{data:g,isLoading:j}=l.qL.useGetSimilarArtsForRecommendationQuery({artIDorSlug:i.id,limit:10},{skip:m}),{data:y,isLoading:B}=l.qL.useGetAdvertisingSimilarArtsForRecommendationQuery({artIDorSlug:i.id,limit:10},{skip:!x}),{data:S,isLoading:C}=l.g$.useGetPersonArtsQuery({authorIdOrSlug:b,limit:10},{skip:m||!b}),N=(0,a.useMemo)(()=>{var e,t,r,o,a,s,l,c,_,h,b;if(m)return[];let v=u("Другие книги автора"),k=(0,d.Gs)(i)?u("С этой книгой читают"):u("С этой книгой слушают"),N={title:k,url:"".concat(i.url,"similar/"),data:null!==(a=null==g?void 0:g.data)&&void 0!==a?a:[],isLoading:j,analyticsData:{eventType:n.click,eventData:(0,d.Eb)({art:i,extra:{...f,block_name:"similar_arts",block_title:k,response_model_name:null!==(s=null==g?void 0:null===(e=g.recommendation_model_version)||void 0===e?void 0:e.response_model_name)&&void 0!==s?s:"",response_model_tag:null!==(l=null==g?void 0:null===(t=g.recommendation_model_version)||void 0===t?void 0:t.response_model_tag)&&void 0!==l?l:""}})}},T={title:v,url:(null==p?void 0:p.url)?p.url:"#",data:null!==(c=null==S?void 0:S.data)&&void 0!==c?c:[],isLoading:C,analyticsData:{eventType:n.click,eventData:(0,d.Eb)({art:i,extra:{...f,block_name:"author_arts",block_title:v}})}},w={title:u("Вам может понравиться"),data:null!==(_=null==y?void 0:y.data)&&void 0!==_?_:[],url:"",isLoading:B,analyticsData:{eventType:n.click,eventData:(0,d.Eb)({art:i,extra:{...f,block_name:"",response_model_name:null!==(h=null==y?void 0:null===(r=y.recommendation_model_version)||void 0===r?void 0:r.response_model_name)&&void 0!==h?h:"",response_model_tag:null!==(b=null==y?void 0:null===(o=y.recommendation_model_version)||void 0===o?void 0:o.response_model_tag)&&void 0!==b?b:""}})}};return x&&(null==y?void 0:y.data.length)?[N,w,T]:[N,T]},[i,f,g,j,S,C,x,y]);return(0,o.jsx)("section",{"aria-label":u("Рекомендации"),className:v().wrapper,"data-testid":"book-recommendations__wrapper",children:N.map(e=>(0,o.jsx)(h,{...e},"".concat(e.title,"_").concat(i.id,"_").concat(k)))})}},14923:function(e,t,r){"use strict";r.d(t,{k:function(){return r_}});var i=r(31549),n=r(44194),o=r(48592),a=r(61794),s=r(59838),l=r(26249),c=r(76791),d=r(24810),_=r(17051),u=r(70608),m=r(71956),p=r(34270),h=r(51865),b=r.n(h);let v=e=>{let{userEmail:t,art:r}=e,i=!t,{t:s}=(0,o.$G)(),l=6===Number(r.availability)||2===Number(r.availability),c=(0,u.c4)(r),d=(0,u.R4)(r),_=(0,u.eU)(r,!0),m=r.update_events&&"all"===r.update_events[0],[p,h]=(0,n.useState)(m),[b]=a.r7.useSetUserEmailMutation(),[v]=a.BT.useCreateNotificationMutation(),f=()=>{switch(!0){case l:return s("Сообщим о поступлении книги в продажу на {userEmail}",{userEmail:t});case c:return s("Сообщим о появлении новых выпусков на {userEmail}",{userEmail:t});case d:return s("Сообщим о выходе новых глав и завершении черновика на {userEmail}",{userEmail:t});case _:return s("Сообщим о поступлении книги в продажу на {userEmail}",{userEmail:t});default:return""}},k=p?s("Не смогли отписаться от обновлений. Попробуйте еще раз"):s("Не смогли подписаться на обновления. Попробуйте еще раз");return{artType:(()=>{switch(!0){case l:return"preorder";case c:return"podcast";case d:return"draft";case _:return"preorder";default:return}})(),updateEvent:p?"none":"all",isSubscribed:p,informingText:(()=>{if(t)return f();switch(!0){case l:return s("Сообщим о поступлении книги в продажу");case c:return s("Сообщим о появлении новых выпусков");case d:return s("Сообщим о выходе новых глав и завершении черновика");case _:return s("Сообщим о поступлении книги в продажу");default:return""}})(),isShowInputEmail:i,requestTextError:k,setIsSubscribed:h,triggerSaveEmail:b,triggerNotification:v}};var f=r(79988),k=r.n(f),x=r(39319),g=r(1653),j=r(76996),y=r(17385);let B=e=>{var t,r;let{userEmail:n,informingText:a,subscribeNotification:s,saveEmailAndSubscribe:l,isShowInputEmail:c,isLoading:d}=e,{t:_}=(0,o.$G)(),{handleSubmit:u,control:m,formState:{errors:p}}=(0,j.cI)({shouldFocusError:!1,defaultValues:{email:null!=n?n:""}}),h=(null==p?void 0:null===(t=p.email)||void 0===t?void 0:t.type)==="required"||(null==p?void 0:null===(r=p.email)||void 0===r?void 0:r.type)==="validate";return(0,i.jsx)("div",{className:k().notificationSubscription__subscribe,children:(0,i.jsxs)("form",{onSubmit:u(e=>{let{email:t}=e;n?s():l(t)}),children:[c&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j.Qr,{rules:{required:_(y.J),validate:e=>(0,y.D)(e)||y.J},name:"email",control:m,render:e=>{let{field:t}=e;return(0,i.jsx)(g.F5,{...t,className:k().email,controlMode:g.S1.text,placeholder:_("Электронная почта"),error:h?" ":null,autoComplete:"one-time-code"})}}),h&&(0,i.jsx)("div",{className:k().error,children:_(y.J)})]}),(0,i.jsx)(x.z,{loading:d,className:k().button,text:_("Подписаться на обновления"),size:"medium",mode:"secondary",type:"submit"}),(0,i.jsx)("div",{children:a})]})})};var S=r(55714),C=r(91249);let N=e=>{let{unsubscribeNotification:t,informingText:r,isLoading:n}=e,{t:a}=(0,o.$G)();return(0,i.jsxs)("div",{className:k().notificationSubscription__unsubscribe,children:[(0,i.jsxs)("div",{className:k().title,children:[(0,i.jsx)("img",{src:C}),(0,i.jsx)("div",{children:a("Вы подписаны")})]}),(0,i.jsxs)("div",{className:k().description,children:[r,". ",(0,i.jsx)(S.Fg,{href:"#",onClick:e=>{n||(e.preventDefault(),t())},children:a("Отписаться")})]})]})},T=()=>{let{t:e}=(0,o.$G)(),{art:t,isDesktop:r}=(0,d.G)(),[s,l]=(0,n.useState)(!1),[c,_]=(0,n.useState)(!1),u=(0,n.useRef)(null),m=(0,a.TL)(),h=(0,a.CG)(e=>e.foundationUser),f=h.profile.email,[x,g]=(0,n.useState)(f),j=h.id,{artType:y,updateEvent:S,isSubscribed:C,informingText:T,isShowInputEmail:w,requestTextError:P,setIsSubscribed:A,triggerSaveEmail:I,triggerNotification:G}=v({art:t,userEmail:x}),R=()=>{l(!0)},E=()=>{_(!0)},W=()=>{_(!1)};if(!y)return(0,i.jsx)(i.Fragment,{});let L=()=>{E(),G({item_id:t.id,item_type:y,update_events:[S]}).unwrap().then(()=>{A(!C),W()}).catch(()=>{R(),W()})};return(0,i.jsx)("div",{ref:u,className:k().notificationSubscription,onClick:()=>{j||m(a.hi.global.interfaceRequests.setLoginPopupError({isOpen:!0,errorText:e("Чтобы подписаться на обновления, зарегистрируйтесь или войдите")}))},children:(0,i.jsxs)("div",{className:b()(k().notificationSubscription__wrapper,{[k().notificationSubscription__wrapper_isAnon]:!j}),children:[!C&&(0,i.jsx)(B,{informingText:T,isShowInputEmail:w,subscribeNotification:L,saveEmailAndSubscribe:e=>{E(),I({email:e}).unwrap().then(()=>{g(e),L()}).catch(()=>{R(),W()})},userEmail:x,isLoading:c}),C&&(0,i.jsx)(N,{informingText:T,unsubscribeNotification:L,isLoading:c}),(0,i.jsx)(p.P,{isOpen:s,isMobile:!r,mode:"error",title:"",message:P,onClose:()=>{l(!1)},alignElRef:r?u:void 0,isFullWidth:!r,verticalAlign:r?"bottom":"top",showIcon:!0})]})})};var w=r(15159),P=r.n(w);let A=()=>(0,i.jsx)("div",{className:P().saleBlockNotificationSubscription,children:(0,i.jsx)(T,{})});var I=r(97439),G=r(73758);let R=()=>{var e,t,r,c,_;let m=(0,a.TL)(),{art:h,isDesktop:v}=(0,d.G)(),f=(0,a.CG)(e=>e.foundationUser.profile.birthday),[k,g]=(0,n.useState)(!1),j=(0,n.useRef)(null),{t:y}=(0,o.$G)(),{reload:B}=(0,l.useRouter)(),S=h.library_information?h.library_information.biblio_selfservice:null,[C,N]=(0,n.useState)(S),[T,w]=(0,n.useState)(null!==(_=null===(e=h.library_information)||void 0===e?void 0:e.arts_in_biblio_queue_size)&&void 0!==_?_:0),A="requested"===C,R=(0,n.useMemo)(()=>{switch(C){case"instant":return y(I.f9.INSTANT);case"requested":return I.f9.REQUESTED;default:return I.f9.DELAYED}},[C]),E=()=>{g(!0)},W=()=>{if(f){let e=(0,u.Ux)(f);if(h.min_age&&h.min_age>e){E();return}}if((!f||!h.min_age)&&h.is_adult_content){E();return}},L=()=>{if("delayed"===C){N("requested"),w(e=>e+1);return}if("requested"===C){N("delayed"),w(e=>e-1);return}B()};return(0,i.jsxs)("div",{className:b()(P().block,P().block_library),"data-testid":"book-sale-block__library--wrapper",children:[(0,i.jsxs)("div",{className:P().block__info,children:[(0,i.jsxs)("div",{className:P().block__info__row,children:[(0,i.jsx)("strong",{children:null===(t=h.library_information)||void 0===t?void 0:t.arts_in_biblio_fund_count}),(0,i.jsxs)("span",{children:[y((0,s.pd)((null===(r=h.library_information)||void 0===r?void 0:r.arts_in_biblio_fund_count)||0,["Экземпляр","Экземпляра","Экземпляров"])).toLowerCase()," ",y("В библиотеке").toLowerCase()]})]}),(0,i.jsxs)("div",{className:P().block__info__row,children:[(0,i.jsx)("strong",{children:null===(c=h.library_information)||void 0===c?void 0:c.arts_in_biblio_busy_count}),(0,i.jsx)("span",{children:y("На руках").toLowerCase()})]}),(0,i.jsxs)("div",{className:P().block__info__row,children:[(0,i.jsx)("strong",{children:T}),(0,i.jsxs)("span",{children:[y((0,s.pd)(T||0,["читатель","читателя","читателей"]))," ",y("в очереди")]})]})]}),(0,i.jsx)("div",{className:P().button,"data-testid":"book-sale-block__library--button",ref:j,children:(0,i.jsx)(x.z,{mode:A?"secondary":"primary",type:"button",size:"large",text:R,fullWidth:!0,onClick:()=>{W(),A?(G.TM.sendEvent(["LITRES_TRACKER"],{eventType:"cancel_request_from_library",params:(0,u.Eb)({art:h})}),m(a.hi.foundationUser.cancelRequestBiblioArt({art:h.id,onSuccess:L}))):(G.TM.sendEvent(["LITRES_TRACKER"],{eventType:"delayed"===C?"request_from_library":"take_from_library",params:(0,u.Eb)({art:h})}),m(a.hi.foundationUser.requestBiblioArt({art:h.id,onSuccess:L})))}})}),(0,i.jsx)("div",{className:P().block__caption,children:(0,u.Gs)(h)?y("Читайте библиотечную книгу онлайн на сайте или в мобильных приложениях"):y("Слушайте библиотечную книгу онлайн на сайте или в мобильных приложениях")}),(0,i.jsx)(p.P,{isOpen:k,isMobile:!v,mode:"info",title:y("Сообщение"),message:y("Ваш возраст не соответствует возрастному рейтингу этой книги. Выберите другую книгу."),onClose:()=>{g(!1)},alignElRef:v?j:void 0,isFullWidth:!v,verticalAlign:v?"bottom":"top"})]})};var E=r(4438);let W=e=>{let{title:t,description:r,isLibrary:n}=e;return(0,i.jsxs)("div",{className:b()(P().saleBlockInfo,{[P().saleBlockInfo_isLibrary]:n}),children:[(0,i.jsx)("div",{className:P().saleBlockInfo__icon,children:(0,i.jsx)(E.uQ,{name:"infoFilled",size:16})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:P().saleBlockInfo__title,children:t}),r&&(0,i.jsx)("div",{className:P().saleBlockInfo__description,children:r})]})]})};var L=r(42533);function D(e,t){return e.includes("/popular/")?"litresread://content/r/pb":e.includes("/new/")?"litresread://content/r/rb":e.includes("book")||e.includes("webtoon")?"litresread://content/b/".concat(t):"litresread://"}function M(e){let{url:t,id:r}=e,{utm_source:i,utm_campaign:n,utm_content:o,utm_term:a,sub1:l,sub2:c,sub3:d,sub4:_,sub5:u,keyword:m,pathname:p}=function(e){let t=new URL(e);return{...(0,L.parse)(t.search.slice(1)),pathname:t.pathname}}(t);if("advcake"===i||"admitad"===i){let e=D(p,r);return"https://litres.onelink.me/1566260005?pid=advcake_int&c=".concat(n||"default","&af_siteid=").concat(o||"","&af_ad=").concat(a||"","&clickid=").concat(a||"","&af_sub1=").concat(l||"","&af_sub2=").concat(c||"","&af_sub3=").concat(d||"","&af_sub4=").concat(_||"","&af_sub5=").concat(u||"","&af_adset=").concat(m||"","&is_retargeting=true&af_dp=").concat(e,"&af_reengagement_window=30d&af_click_lookback=7d")}if("true"===(0,s.ej)("deeplink_utm_active_flag")){let e=JSON.parse((0,s.ej)("deeplink_utm_data")||"{}"),t=D(p,r);return"https://litres.onelink.me/1566260005?pid=advcake_int&c=".concat(e.utm_campaign||"default","&af_siteid=").concat(e.utm_content||"","&af_ad=").concat(e.utm_term||"","&clickid=").concat(e.utm_term||"","&af_sub1=").concat(e.sub1||"","&af_sub2=").concat(e.sub2||"","&af_sub3=").concat(e.sub3||"","&af_sub4=").concat(e.sub4||"","&af_sub5=").concat(e.sub5||"","&af_adset=").concat(e.keyword||"","&is_retargeting=true&af_dp=").concat(t,"&af_reengagement_window=30d&af_click_lookback=7d")}}var F=r(92244),O=r.n(F),z=r(44731);let K=e=>{z.TM.sendEvent(["LITRES_TRACKER"],e)},q=e=>{K({eventType:"button_listen_in_app_click",params:(0,u.Eb)({art:e})})},U=e=>{K({eventType:"button_read_in_app_click",params:(0,u.Eb)({art:e})})},V=e=>"https://click.litres.ru/1566260005?af_xp=custom&pid=Web_to_app_card&af_dp=litresread://content/b/".concat(e,"&af_click_lookback=30d&c=Card_new&is_retargeting=true&af_reengagement_window=30d"),X=e=>{let{art:t,isListenable:r,withBottomMargin:a}=e,{t:l}=(0,o.$G)(),[c,d]=(0,n.useState)(""),{id:_}=t,u=(0,n.useCallback)(()=>{(r?q:U)(t)},[r,t]);return(0,n.useEffect)(()=>{if(s.Ym){var e;let t=M({id:_,url:null===(e=window)||void 0===e?void 0:e.location.href});d(null!=t?t:V(_))}else d(V(_))},[_,s.Ym]),(0,i.jsx)(x.z,{className:b()(O().buttonWrapper,{[O().buttonWrapper_withBottomMargin]:a}),size:"large",fullWidth:!0,text:l(r?"Слушать в приложении":"Читать в приложении"),mode:"secondary",href:c,onClick:u})};var Z=r(9524),$=r(20239),Q=r.p+"static/media/percent-lable.f7eee5c3.svg",H=r(58931),Y=r(47263),J=r(62094),ee=r(80930),et=r(44357),er=r(84233);let ei=()=>{var e,t,r,l;let{art:c}=(0,d.G)(),{i18n:_}=(0,o.$G)(),{origin:m}=(0,J.TH)(),p=(0,a.CG)(e=>e.face.language),{data:h,isLoading:b}=a.qL.useGetArtUrlReferralQuery({artId:c.id}),v=m||ee._n,f="".concat(v,"/").concat((null==h?void 0:h.referral_url)||""),k=null===(e=c.persons)||void 0===e?void 0:e.find(e=>"author"===e.role),x=(0,s.aS)((0,u.kC)(c),null===(t=c.prices)||void 0===t?void 0:t.currency,null==_?void 0:_.language),g=(0,n.useMemo)(()=>new et.p(c),[c]);return b?(0,i.jsx)(Y.a,{}):(0,i.jsx)(H.Wu,{type:"book",isSocnetTitle:!1,sharing:{title:c.title,lang:p||"ru",url:f,onItemClick:e=>{let{name:t}=e,r=t===H.K3.COPY_LINK?"book_card_referal_copy_link":"book_card_click_shared";G.TM.sendEvent(["LITRES_TRACKER"],{eventType:r,params:(0,u.Eb)({art:c})})}},popupContentTop:{contentBottom:c.title||"",contentTop:(null==k?void 0:k.full_name)||"",coverByWidth:{alt:c.title||"",bookId:c.id,ratio:c.cover_ratio||.62,width:89,type:c.art_type},label:(0,i.jsx)(er.E,{type:"midi",format:g})},popupContentBottom:{type:"book",bookReferralData:{artFullPrice:(0,s.aS)(null===(r=c.prices)||void 0===r?void 0:r.full_price,null===(l=c.prices)||void 0===l?void 0:l.currency,_.language)||"",referralBenefit:x||""}},e2eid:"popup__content--wrapper"})},en=()=>{var e;let{art:t}=(0,d.G)(),{t:r,i18n:l}=(0,o.$G)(),c=(0,a.TL)(),_=(0,a.CG)(e=>e.foundationUser).id,m=(0,a.CG)(e=>e.face.language||"ru"),p=(0,a.CG)(e=>e.browser.headers["client-host"]),h=(0,s.s7)(m),[b,v]=(0,n.useState)(!1),f=()=>{c(a.hi.global.interfaceRequests.setLoginPopupError({isOpen:!0,errorText:r("Чтобы посоветовать книгу друзьям, зарегистрируйтесь или войдите")}))},k=(0,s.aS)((0,u.kC)(t),null===(e=t.prices)||void 0===e?void 0:e.currency,null==l?void 0:l.language);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:P().referralBlock,"data-testid":"referral-block__wrapper",children:[(0,i.jsx)("div",{className:P().referralBlock__icon,children:(0,i.jsx)("img",{src:Q})}),(0,i.jsxs)("div",{className:"content",children:[(0,i.jsx)("div",{className:P().referralBlock__title,children:r("Подарите скидку 10%")}),(0,i.jsxs)("div",{className:P().referralBlock__content,suppressHydrationWarning:!0,children:[(0,i.jsx)(o.cC,{t:r,i18nKey:"<a>Посоветуйте</a> эту книгу и получите {bonus} с покупки её другом.",values:{bonus:k},components:{a:(0,i.jsx)(S.Fg,{className:P().referralBlock__btn,e2eId:"referral-block__link",onClick:()=>{if(!_){f();return}v(!0),G.TM.sendEvent(["LITRES_TRACKER"],{eventType:"advise_item_click",params:(0,u.Eb)({art:t,extra:{source_internal:"book_card",item_type:"art"}})})},role:"button"})}}),h&&(0,i.jsx)("div",{className:P().referralBlock__info,children:(0,i.jsx)($.I,{href:"https://".concat(p,"/kniga-drugu/"),children:r("Подробнее")})})]})]})]}),(0,i.jsx)(Z.u_,{isOpen:b,onClose:()=>{v(!1)},closeOnClickOutside:!0,e2eId:"referral-block__modal",title:r("Посоветуйте книгу"),children:(0,i.jsx)(ei,{})})]})};var eo=r(52805);let ea=e=>{var t;let{isReceived:r}=e,{art:n}=(0,d.G)(),o=null===(t=n.library_information)||void 0===t?void 0:t.valid_till_at;if(!r||!o)return(0,i.jsx)(i.Fragment,{});let a="Книга выдана до ".concat((0,eo.EX)(o,!0)," включительно");return(0,i.jsx)("div",{className:P().block__libraryInfo,"data-testid":"book-sale-block__library-info",children:(0,i.jsx)(W,{title:a,isLibrary:!0})})};var es=r(3933),el=r(22348),ec=r(96881),ed=r.n(ec);let e_=()=>{let e=(0,a.TL)(),t=(0,a.CG)(e=>e.foundationUser.id),{t:r}=(0,o.$G)(),{art:n}=(0,d.G)(),{openFilesModal:s,fullFiles:l}=(0,el.J)(),c=(0,J.uH)();if(!l.length)return null;let _=()=>!!t||(e(a.hi.global.interfaceRequests.setLoginPopupError({isOpen:!0,errorText:"".concat(r("Для скачивания книги")," \xab").concat(n.title,"\xbb ").concat(r("зарегистрируйтесь или войдите"))})),!1);if(!l.length)return null;let u=l.length>1;return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:ed().downloadButton,"data-testid":"book__downloadButton--wrapper",children:[(0,i.jsx)(E.uQ,{size:16,name:"export","aria-hidden":!0}),u?(0,i.jsx)(eu,{onClick:s}):(0,i.jsx)(em,{link:(0,es.Ru)(n,l[0],c),format:(0,es.y6)(n,l[0]),onClick:e=>{_()||e.preventDefault()}})]})})},eu=e=>{let{onClick:t}=e,{t:r}=(0,o.$G)(),{art:n}=(0,d.G)();return(0,i.jsxs)("div",{children:[(0,i.jsx)(S.Fg,{className:ed().downloadButton__link,onClick:t,onKeyDown:e=>{"Enter"===e.key&&t(e)},"data-analytics-id":n.is_free?"download-free-book-button-modal":void 0,role:"link",tabIndex:0,children:r("Скачать")})," ",r("файл книги")]})},em=e=>{let{link:t,format:r,onClick:n}=e,{t:a}=(0,o.$G)(),{art:s}=(0,d.G)();return(0,i.jsxs)("div",{children:[a("Скачать")," ",(0,i.jsx)(S.Fg,{className:ed().downloadButton__link,href:t,onClick:n,"data-analytics-id":s.is_free?"download-free-book-button":"download-button",role:"link",tabIndex:0,children:r})]})},ep=()=>(0,i.jsx)("div",{className:P().block__download,children:(0,i.jsx)(e_,{})});var eh=r(15381),eb=r(8976);let ev=()=>{let{art:e}=(0,d.G)(),{t}=(0,o.$G)(),r=(0,a.TL)(),[s,l]=(0,n.useState)(!1),c=(0,n.useRef)(null),{data:_}=a.Ce.useGetFourArtOfferQuery(),m=(0,eh.t)(),h=()=>{l(!0)},v=()=>{r(a.UY.util.invalidateTags([{type:"Art",id:e.id}]))},f=()=>{if(!m){r(a.hi.global.header.auth.setAuthPopupVisibility(!0));return}r(a.hi.foundationUser.decrUserGifts_CSRF({artId:e.id,onSuccess:v,onError:h}))},k=()=>{r(a.hi.foundationUser.getPresentBook_CSRF({artId:e.id,subId:_.offer_detail.offer_id,onSuccess:v,onError:h}))};return(0,u.Bw)(e)&&(null==_?void 0:_.offer_status)==="ACTIVE"?(0,i.jsxs)("div",{className:b()(P().block,P().block_gift),children:[(0,i.jsxs)("div",{className:P().fourArtsGift,children:[(0,i.jsxs)("div",{className:P().fourArtsGift__banner,children:[(0,i.jsx)(eb.g.Title,{}),(0,i.jsx)(eb.g.Books,{isBookCard:!0}),(0,i.jsx)(eb.g.Terms,{})]}),(0,i.jsx)(eb.g.Countdown,{className:P().fourArtsGift__countdown})]}),(0,i.jsxs)("div",{className:P().button,ref:c,children:[(0,i.jsx)(x.z,{mode:"primary",type:"button",size:"large",text:t("Получить подарок"),fullWidth:!0,onClick:k}),(0,i.jsx)(p.P,{isOpen:s,onClose:()=>{l(!1)},alignElRef:c,horizontalAlign:"right",verticalAlign:"bottom",mode:"info",title:t("Техническая ошибка"),message:t((0,u.kk)(e)?"Не удалось взять подкаст":"Не удалось взять книгу"),button:{label:t("Попробовать ещё раз"),onClick:k}})]})]}):(0,u.O3)(e)?(0,i.jsx)("div",{className:P().block,children:(0,i.jsxs)("div",{className:P().button,ref:c,children:[(0,i.jsx)(x.z,{mode:"primary",type:"button",size:"large",text:t("Взять себе"),fullWidth:!0,onClick:f}),(0,i.jsx)(p.P,{isOpen:s,onClose:()=>{l(!1)},alignElRef:c,horizontalAlign:"right",verticalAlign:"bottom",mode:"info",title:t("Техническая ошибка"),message:t((0,u.kk)(e)?"Не удалось взять подкаст":"Не удалось взять книгу"),button:{label:t("Попробовать ещё раз"),onClick:f}})]})}):null};var ef=r(56469);let ek=()=>(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"16",viewBox:"0 0 20 16",fill:"none",children:[(0,i.jsx)("g",{clipPath:"url(#clip0_288_21852)",children:(0,i.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.0036 2L3 2C2.44772 2 2 2.44772 2 3L2 13C2 13.5523 2.44771 14 3 14H16.0036C16.8277 14 17.298 13.0591 16.8036 12.4L14.8535 9.80023C14.0532 8.73348 14.0532 7.26654 14.8534 6.19979L16.8036 3.60008L17.1514 3.86097L17.5 4L17.1175 3.83556L16.8036 3.60008C17.2981 2.94084 16.8277 2 16.0036 2ZM3 1.01328e-06L16.0036 0C18.4759 0 19.8869 2.82256 18.4035 4.80021L16.4534 7.39991C16.1866 7.75549 16.1866 8.24447 16.4533 8.60007L18.4034 11.1998C19.887 13.1775 18.4759 16 16.0036 16H3C1.34316 16 1.01328e-06 14.6569 1.01328e-06 13L0 3C0 1.34315 1.34315 1.01328e-06 3 1.01328e-06Z",fill:"#13192E"})}),(0,i.jsx)("defs",{children:(0,i.jsx)("clipPath",{id:"clip0_288_21852",children:(0,i.jsx)("rect",{width:"20",height:"16",fill:"white"})})})]});var ex=r(19997);let eg=e=>{let{t}=(0,o.$G)(),r=(0,a.TL)(),{art:s}=(0,d.G)(),{query:c}=(0,l.useRouter)(),[_,m]=(0,n.useState)(!1),h=(0,n.useRef)(null),b=()=>{(function(e){let t=(0,ex.ps)(e);if(!t)return;let r=(0,ex.Ae)({advertisingDataFromUrl:t,mmType:z.a4.abonement_take,price:0});r&&(0,ex.xG)(r)})(c),r(a.UY.util.invalidateTags([{type:"Art",id:s.id}]))},v=()=>{m(!0)},f=()=>{r(a.hi.foundationUser.getPresentBook_CSRF({artId:s.id,subId:e.offerId,onSuccess:b,onError:v}))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x.z,{fullWidth:!0,mode:"primary",size:"large",text:t("Взять по абонементу"),onClick:()=>{f()},ref:h}),(0,i.jsx)(p.P,{isOpen:_,onClose:()=>{m(!1)},alignElRef:h,horizontalAlign:"right",verticalAlign:"bottom",mode:"info",title:t("Техническая ошибка"),message:t((0,u.kk)(s)?"Не удалось взять подкаст по абонементу":"Не удалось взять книгу по абонементу"),button:{label:t("Попробовать ещё раз"),onClick:f}})]})};var ej=r(28637),ey=r(92249),eB=r(42699),eS=r(57628),eC=r(95232),eN=r.n(eC);let eT=(0,n.forwardRef)((e,t)=>{let{isGoingToNewPaymentFrame:r,titleText:o,discountPercentage:a,bigBuyButtonText:s,smallBuyButtonText:l,secondaryText:c,profits:d,extraAction:_,extraInfo:u,canContentBeCollapsed:m,isExpandedByDefault:p,onBuyButtonClick:h,buyActionMode:v,buyActionSize:f="small",className:k}=e,[g,j]=(0,n.useState)(p||!m),y=o;return g||(y=(0,i.jsx)(ew,{buyButtonMode:v,buyButtonText:l,isGoingToPayment:r,titleText:o,shouldShowDiscountLabel:!!(null==a?void 0:a.checkIfPositive()),onBuyButtonClick:h,ref:t})),(0,i.jsx)(eS.U,{children:(0,i.jsx)(eS.U.Item,{classes:{root:b()(eN().widget,k,{[eN().notExpanded]:!g}),title:eN().title,chevronIcon:eN().title__chevronIcon},title:y,isOpenedByDefault:!0,chevronPosition:"left",manualToggleSettings:{isActive:g,onClick:()=>{m&&j(!g)}},withCollapsingLogic:m,children:(0,i.jsxs)(i.Fragment,{children:[d,(0,i.jsxs)("div",{className:eN().actions,children:[(0,i.jsxs)("div",{className:eN().action,children:[(0,i.jsx)(x.z,{className:b()(eN().buyAction,{[eN().secondary]:"secondary"===v}),text:s,secondaryText:c,size:f,mode:v,fullWidth:!0,onClick:h,loading:r,disabled:r,ref:g?t:null}),!!(null==a?void 0:a.checkIfPositive())&&(0,i.jsx)(ej.y,{containerClass:eN().discount,text:"-".concat(null==a?void 0:a.toStringWithSymbol()),size:"xs",hasBorder:!1})]}),null!=_?_:null]}),null!=u?u:null]})})})});eT.displayName="SaleBlockDetailedInfoWidget";let ew=(0,n.forwardRef)((e,t)=>{let{titleText:r,buyButtonMode:n,buyButtonText:o,isGoingToPayment:a,onBuyButtonClick:s,shouldShowDiscountLabel:l}=e;return(0,i.jsxs)(i.Fragment,{children:[r,(0,i.jsx)(x.z,{className:b()(eN().buyAction,{[eN().secondary]:"secondary"===n}),text:o,size:"very-small",mode:n,onClick:s,loading:a,disabled:a,ref:t}),l&&(0,i.jsx)(ej.y,{containerClass:eN().title_discountLabel,text:"%",size:"xxs",hasBorder:!1})]})});ew.displayName="CollapsedWidgetTitle";var eP=r(81014),eA=r(76878),eI=r.n(eA);let eG=e=>{let{userAbonement:t,saleBlockExperimentGroupName:r,cameToPaymentFromSourceData:n}=e,{art:o}=(0,d.G)(),{goToPayment:a,isGoingToNewPaymentFrame:l,paymentEntryPointControlRef:c}=(0,ey.o)(),_=t.getTheOnlyPlanOneMonthTariff();return _?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eR,{isGoingToNewPaymentFrame:l,oneMonthTariff:_,saleBlockExperimentGroupName:r,handleGoToAbonementPaymentClick:()=>{z.TM.sendEvent(["LITRES_TRACKER"],{eventType:"abonement_button_click",params:(0,u.Eb)({art:o})}),(0,s.m8)({abonement_ref_url:window.location.href}),a()}}),(0,i.jsx)(eB.L,{ref:c,cameFromSource:n.cameFromSource,cameFromSourcePayload:n.cameFromSourcePayload,artUrl:o.url})]}):null},eR=e=>{let{saleBlockExperimentGroupName:t}=e;return"control"===t?(0,i.jsx)(eE,{...e}):"buttons-short-info"===t?(0,i.jsx)(eW,{...e}):"widgets-detailed-info-collapsible"===t||"widgets-detailed-info"===t?(0,i.jsx)(eL,{...e}):null},eE=e=>{let{t}=(0,o.$G)(),{oneMonthTariff:r,isGoingToNewPaymentFrame:n,handleGoToAbonementPaymentClick:a}=e,{prices:{discount:s,priceWithoutDiscount:l,totalPrice:c}}=r;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:P().block__price,children:s?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("strong",{className:P().block__price__final,children:c.toStringWithCurrency()}),(0,i.jsxs)("div",{className:P().block__price__discount,children:[(0,i.jsx)("span",{className:P().block__price__full,children:l.toStringWithCurrency()}),(0,i.jsx)("div",{className:P().block__price__discount__label,children:(0,i.jsx)(ej.y,{text:"-".concat(r.calculateDiscountPercentage().toStringWithSymbol()),size:"xs",hasBorder:!1})})]})]}):(0,i.jsx)("strong",{className:P().block__price__default,children:c.toStringWithCurrency()})}),(0,i.jsx)(x.z,{fullWidth:!0,mode:"primary",size:"large",text:t("Взять по абонементу"),loading:n,disabled:n,onClick:a})]})},eW=e=>{let{t}=(0,o.$G)(),{oneMonthTariff:r,isGoingToNewPaymentFrame:n,handleGoToAbonementPaymentClick:a}=e,{prices:{totalPrice:s}}=r;return(0,i.jsx)(x.z,{text:t("Скачать по абонементу"),size:"large",mode:"primary",secondaryText:s.toStringWithCurrency(),fullWidth:!0,onClick:a,loading:n,disabled:n})},eL=e=>{let{t}=(0,o.$G)(),{oneMonthTariff:r,isGoingToNewPaymentFrame:n,handleGoToAbonementPaymentClick:a,saleBlockExperimentGroupName:s}=e;return(0,i.jsx)(eT,{className:eI().abonementWidget,bigBuyButtonText:"".concat(r.prices.totalPrice.toStringWithCurrency()," в месяц"),canContentBeCollapsed:"widgets-detailed-info-collapsible"===s,onBuyButtonClick:a,isExpandedByDefault:!0,isGoingToNewPaymentFrame:n,profits:(0,i.jsxs)("ul",{className:eI().profits_list,children:[(0,i.jsxs)("li",{children:[(0,i.jsx)(E.uQ,{name:"archive",size:16,className:eI().profitIcon_book}),t("Раз в месяц вы можете скачать любую книгу до {price}",{price:new eP.W(u.TX,"RUB").toStringWithCurrency()}),(0,i.jsx)("br",{})]}),(0,i.jsxs)("li",{children:[(0,i.jsx)(E.uQ,{name:"discount",size:16,className:eI().profitIcon_discount}),t("Скидка до 30% на весь каталог")]})]}),smallBuyButtonText:r.prices.totalPrice.toStringWithCurrency(),titleText:(0,i.jsx)("span",{children:t("Скачать по абонементу")}),buyActionMode:"primary"})},eD=e=>{var t;let{art:r}=(0,d.G)(),{data:n}=(0,ef.Z)();if(!n)return null;let o=n.getStatus();return(0,i.jsxs)("div",{className:b()(P().block,{[P().experimental]:"control"!==e.saleBlockExperimentGroupName,[P().withDetailedInfoWidget]:"widgets-detailed-info"===e.saleBlockExperimentGroupName||"widgets-detailed-info-collapsible"===e.saleBlockExperimentGroupName}),"data-testid":"book-sale-block__abonement--wrapper",children:[(0,i.jsx)("div",{"data-testid":"book-sale-block__abonement--button",children:"active"===o?(0,i.jsx)(eg,{offerId:(null===(t=n.activeSubscription)||void 0===t?void 0:t.offerId)||0}):(0,i.jsx)(eG,{userAbonement:n,saleBlockExperimentGroupName:e.saleBlockExperimentGroupName,cameToPaymentFromSourceData:e.cameToPaymentFromSourceData})}),r.is_exclusive_abonement&&(0,i.jsx)(eM,{})]})},eM=()=>{let{t:e}=(0,o.$G)();return(0,i.jsxs)("div",{className:P().exclusiveAbonement,children:[(0,i.jsx)("div",{className:P().exclusiveAbonement__icon,children:(0,i.jsx)(ek,{})}),(0,i.jsxs)("div",{className:P().exclusiveAbonement__text,children:[(0,i.jsx)("strong",{children:e("Эксклюзивно в Абонементе")}),(0,i.jsx)(S.Fg,{href:"https://www.litres.ru/abonement/",children:e("Подробнее")})]})]})};var eF=r(88302),eO=r(73385),ez=r(52613),eK=r(34257);let eq=e=>{let{statusSubscription:t,user:r,art:i}=e,[o,s]=(0,n.useState)([]),l=(0,eF.f)(),[c]=a.c.useLazyGetBrandIdentityByIDQuery(),{data:d}=a.c.useGetBrandIdentityQuery(void 0,{skip:!l}),_="active"===t?r.partner_subscriptions.has_active:(0,u.Ln)(r),m=()=>{if(_){let e;let n=r.partner_subscriptions.subscriptions;e="active"===t?n.filter(e=>i.availability_with_partner_subscriptions.find(t=>t.id===e.sub_id&&e.is_active)):n.filter(e=>i.availability_with_partner_subscriptions.find(t=>t.id===e.sub_id&&e.is_in_grace_period));let o={};e.forEach(e=>{o[e.token]||(o[e.token]=e)}),Promise.all(Object.values(o).map(e=>c({subId:e.sub_id}))).then(e=>{let t=e.map(e=>e.data).filter(e=>e);if(d){s(t.filter(e=>(null==e?void 0:e.name)===d.name));return}s(t)})}};return(0,n.useEffect)(()=>{m()},[r.partner_subscriptions]),{partnerBrandIdentities:o,partner:d}},eU=e=>{let{isIdentityPartner:t=!1}=e,r=(0,a.CG)(e=>e.foundationUser),{art:n}=(0,d.G)(),{partnerBrandIdentities:o,partner:s}=eq({statusSubscription:"active",user:r,art:n}),l=t?s?[s]:[]:o;return l.length?(0,i.jsxs)(i.Fragment,{children:[(null==l?void 0:l.length)>1&&(0,i.jsx)("div",{className:b()(P().block__caption,P().block_subscription__name),children:(0,i.jsx)(eK.J,{trigger:"hover",closeOnClick:!0,placement:"bottom",contentClassName:P().block__partnerSubscriptions,content:(0,i.jsx)(eV,{partners:l.slice(1)}),padding:16,children:(0,i.jsx)(eX,{partner:l[0],countSubs:l.length-1})})}),(null==l?void 0:l.length)===1&&(0,i.jsx)(eX,{partner:l[0]})]}):(0,i.jsx)(i.Fragment,{})},eV=e=>{let{partners:t}=e,{t:r}=(0,o.$G)();return(0,i.jsxs)(i.Fragment,{children:[r("Эта книга доступна по подписке")," ",null==t?void 0:t.map((e,r)=>{var n;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{style:{color:null!==(n=e.primary_color_text)&&void 0!==n?n:void 0,fontWeight:500},children:e.name_ru},r),t[r+1]?", ":""]})})]})},eX=e=>{var t;let{partner:r,countSubs:n}=e,{t:a}=(0,o.$G)();return(0,i.jsxs)("div",{className:P().block__caption,children:[a("подписка")," ",(0,i.jsxs)("span",{style:{color:null!==(t=r.primary_color_text)&&void 0!==t?t:void 0,fontWeight:500},children:[r.name_ru," "]}),n?a("и еще {number}",{number:n}):null]})};var eZ=r(65032),e$=r(51738);let eQ=e=>{let{text:t,onPlay:r}=e,{art:n,bookSubPath:l}=(0,d.G)(),{t:c}=(0,o.$G)(),_=(0,a.TL)(),m=(0,a.CG)(e=>e.foundationUser.id),p=()=>(0,u.kk)(n)?c("Для прослушивания подкаста \xab{name}\xbb, зарегистрируйтесь или войдите",{name:n.title}):c("Для прослушивания аудиокниги \xab{name}\xbb, зарегистрируйтесь или войдите",{name:n.title}),{scheduleEvent:h}=(0,e$.G)(n),b=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.ZT;if(h({source_internal:(0,u.bu)(l)}),!m&&!((0,u.kk)(n)&&n.is_free)){_(a.hi.global.interfaceRequests.setLoginPopupError({isOpen:!0,errorText:p()}));return}null==r||r(),e()};return(0,i.jsx)(eZ.J,{children:e=>{let{togglePlay:r}=e;return(0,i.jsx)(x.z,{text:t,size:"large",mode:"primary",fullWidth:!0,onClick:()=>{b(r)},analyticsId:n.is_free?"read-free-fragment-button":void 0,e2eId:"saleBlock__readListen--button"})}})};var eH=r(58749);let eY=()=>{let{art:e,bookSubPath:t}=(0,d.G)(),{t:r}=(0,o.$G)(),{query:n}=(0,l.useRouter)(),c=(0,a.CG)(e=>e.foundationUser),_=(0,a.CG)(e=>e.browser.headers["client-host"]),m=(0,a.CG)(e=>e.face.language||"ru");return(0,u.Gs)(e)?(0,i.jsx)(x.z,{text:r("Читать по подписке"),size:"large",mode:"primary",fullWidth:!0,onClick:()=>{(0,u.Gs)(e)&&(G.TM.sendEvent(["LITRES_TRACKER"],{eventType:"read_click",params:(0,u.Eb)({art:e,extra:{book_id:e.id,source_internal:(0,u.bu)(t),art_type:(0,eH.L)(e.art_type,e.is_draft),trial_flag:!1}})}),eJ(n),window.location.href=(0,s.qZ)({art:e,user:c,isLibrary:(0,s.Af)(_||""),isBookCard:!0,isAvailableByAnySubscriptions:!0,lang:m}))}}):(0,i.jsx)(eQ,{text:r("Слушать по подписке"),onPlay:()=>eJ(n)})};function eJ(e){let t=(0,ex.ps)(e);if(!t)return;let r=(0,ex.Ae)({advertisingDataFromUrl:t,mmType:z.a4.subscription_take,price:0});if(!r)return null;(0,ex.xG)(r)}var e0=r(4974),e1=r(88396),e4=r(11659),e2=r.n(e4);let e3=e=>{let{isAudioArtBookCard:t,cameToPaymentFromSourceData:r,oneMonthSubscriptionClass:n,saleBlockExperimentGroupName:o}=e,{art:s}=(0,d.G)(),l=(0,eF.f)(),{data:c}=a.c.useGetBrandIdentityQuery(void 0,{skip:!l}),{goToPayment:_,isGoingToNewPaymentFrame:m,paymentEntryPointControlRef:p}=(0,ey.o)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e6,{isAudioArtBookCard:t,isGoingToNewPaymentFrame:m,handleGoToSubscriptionPaymentClick:e=>{e.stopPropagation(),e.preventDefault(),z.TM.sendEvent(["LITRES_TRACKER"],{eventType:"subscription_button_click",params:(0,u.Eb)({art:s})}),(null==c?void 0:c.url_to_landing)?window.location.href=c.url_to_landing:_()},oneMonthSubscriptionClass:n,saleBlockExperimentGroupName:o}),n&&(0,i.jsx)(e0.Y,{selectedSubscriptionClass:n,ref:p,cameFromSource:r.cameFromSource,cameFromSourcePayload:r.cameFromSourcePayload})]})},e6=e=>{let{saleBlockExperimentGroupName:t,oneMonthSubscriptionClass:r}=e,n=r.prices.totalPrice,o=r.prices.totalPrice.toStringWithCurrency();return(n.checkIfZero()&&(o="Бесплатно"),"control"===t)?(0,i.jsx)(e9,{totalPriceText:o,...e}):"buttons-short-info"===t?(0,i.jsx)(e8,{totalPriceText:o,...e}):"widgets-detailed-info-collapsible"===t||"widgets-detailed-info"===t?(0,i.jsx)(e7,{totalPriceText:o,...e}):null},e9=e=>{let{t}=(0,o.$G)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:P().block__price,children:(0,i.jsx)("strong",{className:P().block__price__default,children:e.totalPriceText})}),(0,i.jsx)(x.z,{text:t(e.isAudioArtBookCard?"Слушать по подписке":"Читать по подписке"),size:"large",mode:"primary",fullWidth:!0,onClick:e.handleGoToSubscriptionPaymentClick,loading:e.isGoingToNewPaymentFrame,disabled:e.isGoingToNewPaymentFrame})]})},e8=e=>{let{t}=(0,o.$G)();return(0,i.jsx)(x.z,{text:t(e.isAudioArtBookCard?"Слушать по подписке":"Читать по подписке"),size:"large",mode:"primary",secondaryText:e.totalPriceText,fullWidth:!0,onClick:e.handleGoToSubscriptionPaymentClick,loading:e.isGoingToNewPaymentFrame,disabled:e.isGoingToNewPaymentFrame})},e7=e=>{let{t}=(0,o.$G)(),{oneMonthSubscriptionClass:r,handleGoToSubscriptionPaymentClick:n,isGoingToNewPaymentFrame:a,saleBlockExperimentGroupName:s}=e,l="".concat(r.prices.totalPrice.toStringWithCurrency()," в месяц");r.prices.totalPrice.checkIfZero()&&(l="30 дней бесплатно");let c=!r.prices.totalPrice.equal(r.prices.prolongPrice),d=(0,i.jsx)("span",{children:t(e.isAudioArtBookCard?"Слушать по подписке":"Читать по подписке")});return(0,i.jsx)(eT,{className:e2().subscriptionWidget,bigBuyButtonText:l,canContentBeCollapsed:"widgets-detailed-info-collapsible"===s,onBuyButtonClick:n,isExpandedByDefault:!0,isGoingToNewPaymentFrame:a,buyActionMode:"primary",profits:(0,i.jsxs)("ul",{className:e2().profits_list,children:[(0,i.jsxs)("li",{children:[(0,i.jsx)(E.uQ,{name:"archive",className:e2().profitIcon_book,size:16}),t("Доступ к {numberOfItemsInSubscription} книг,",{numberOfItemsInSubscription:e1.wN}),(0,i.jsx)("br",{}),t("аудиокниг и подкастов")]}),(0,i.jsxs)("li",{children:[(0,i.jsx)(E.uQ,{name:"discount",size:16,className:e2().profitIcon_discount}),t("Скидка до 30% на каталог Литрес"),(0,i.jsx)("br",{}),t("и бумажные книги в Читай-городе")]})]}),smallBuyButtonText:r.prices.totalPrice.toStringWithCurrency(),titleText:d,extraInfo:c?(0,i.jsx)("p",{className:e2().nextPriceText,children:t("Далее {price} в месяц",{price:e.oneMonthSubscriptionClass.prices.prolongPrice.toStringWithCurrency()})}):null})};var e5=r(64009);class te{static writerToQuery(e){let{cameFromSource:t,planIds:r}=e,i=new URLSearchParams({from:t}),n=JSON.stringify(e.cameFromSourcePayload);return i.append("payload",n),r.forEach(e=>{i.append("plan",String(e))}),i.toString()}}let tt=(0,n.memo)(e=>{let{cameFromSource:t,cameFromSourcePayload:r,planIds:o}=e,[a,s]=(0,n.useState)(!1),c=(0,l.useRouter)().push,d=(0,n.useCallback)(()=>{try{var e;let i=(e={cameFromSource:t,cameFromSourcePayload:r,planIds:o},"/subscription/plans/?".concat(te.writerToQuery(e)));s(!0),c(i)}catch(e){console.error(e)}},[t,r,o,c]),_=(0,n.useMemo)(()=>({goToPage:d,isGoingToPage:a}),[d,a]);return(0,i.jsx)(i.Fragment,{children:e.render(_)})});tt.displayName="SubscriptionPlansPageEntryPoint";var tr=r(39169),ti=r(36278),tn=r(21092),to=r(35474),ta=r.n(to);function ts(e){let{availablePlanIds:t}=e,r=t.length,n=function(e){switch(e){case 1:return"Книга доступна только по тарифу";case 2:return"Книга доступна в тарифах";default:return"Книга доступна во все тарифах подписки"}}(r);return(0,i.jsxs)("div",{className:ta().root,children:[(0,i.jsx)("p",{className:ta().description,children:n}),r<=2&&(0,i.jsx)("ul",{className:ta().plans,children:t.map(e=>{let t=tn.DV[e],r=tn.mS.checkIfMaximum(e),n=tn._P.checkIfBookshelf(e);return(0,i.jsx)(ti.C,{text:t,type:r||n?"secondary":"primary",size:"small"},e)})})]})}var tl=r(79583);function tc(e){return{source_internal:tl.l.bookCard,enable_subscription_plan:e.join(", ")}}let td=function(e){G.TM.sendEvent(["LITRES_TRACKER"],{eventType:"subscription_saleblock_view",params:tc(e)})},t_=function(e){G.TM.sendEvent(["LITRES_TRACKER"],{eventType:"subscription_button_click",params:tc(e)})},tu=e=>{let{subscriptionTariffs:t,userSubscription:r,cameToPaymentFromSourceData:n}=e,{art:o}=(0,d.G)(),a=o.is_available_with_litres_subscription_plans;(0,e5.qR)(()=>{td(a)});let s=(0,tr.S)(e.subscriptionTariffs,{experiments:e.experiments,anySubscriptionPlanIds:a,areNeedSortByActiveExperimentOrder:!0}),{bestPriceSubscriptionTariff:l}=t;return(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:P().block__price,children:l&&(0,i.jsx)(tm,{bestPriceTariff:l,isTrialAvailable:r.isTrialAvailable})}),(0,i.jsx)(tt,{planIds:s,cameFromSource:n.cameFromSource,cameFromSourcePayload:n.cameFromSourcePayload,render:e=>{let{goToPage:t,isGoingToPage:r}=e;return(0,i.jsx)(x.z,{text:"Читать по подписке",size:"large",mode:"primary",loading:r,disabled:r,fullWidth:!0,onClick:()=>{t_(a),t()}})}}),(0,i.jsx)(ts,{availablePlanIds:s}),(0,i.jsx)($.Z,{href:"/litres_subscription",className:ta().link,children:"Подробнее о тарифах"})]})};function tm(e){let{bestPriceTariff:t,isTrialAvailable:r}=e,{prices:n}=t,o="от ".concat(n.averageMonthPrice.toStringWithCurrency()," в месяц");return r&&(o="Бесплатно"),(0,i.jsx)("strong",{className:P().block__price__default,children:o})}let tp=e=>{let{art:t}=(0,d.G)(),r=(0,a.CG)(e=>e.foundationUser),n=(0,u.dV)({art:t,user:r}),o=(0,eF.f)(),{data:s}=(0,eO.Z)(),l=s.availableSubscriptionClasses,c=l.getOneMonthClass(),_=(null==c?void 0:c.prices.totalPrice.checkIfZero())&&o,m=n||_;return(0,i.jsxs)("div",{className:b()(P().block,{[P().experimental]:"control"!==e.saleBlockExperimentGroupName,[P().withDetailedInfoWidget]:"widgets-detailed-info"===e.saleBlockExperimentGroupName||"widgets-detailed-info-collapsible"===e.saleBlockExperimentGroupName}),"data-testid":"book-sale-block__subscription-wrapper",children:[(0,i.jsx)(th,{...e,isAudioArtBookCard:(0,u.F0)(t),oneMonthSubscriptionClass:c,isArtAvailableByMySubscription:n,subscriptionTariffs:l.tariffs,userSubscription:s,isPartnerDomain:o}),m&&(0,i.jsx)(eU,{isIdentityPartner:_})]})},th=e=>{let{subscriptionTariffs:t,isPartnerDomain:r}=e,{isShowingSubscriptionPlans:n,experiments:o}=(0,ez.TN)(e.subscriptionTariffs);return e.isArtAvailableByMySubscription?(0,i.jsx)(eY,{}):!r&&n&&t.shouldShowSubscriptionTariffs()?(0,i.jsx)(tu,{subscriptionTariffs:e.subscriptionTariffs,userSubscription:e.userSubscription,experiments:o,cameToPaymentFromSourceData:e.cameToPaymentFromSourceData}):e.oneMonthSubscriptionClass?(0,i.jsx)(e3,{isAudioArtBookCard:e.isAudioArtBookCard,cameToPaymentFromSourceData:e.cameToPaymentFromSourceData,oneMonthSubscriptionClass:e.oneMonthSubscriptionClass,saleBlockExperimentGroupName:e.saleBlockExperimentGroupName}):null},tb=()=>{let{t:e}=(0,o.$G)(),{art:t}=(0,d.G)(),r=(0,a.CG)(e=>e.foundationUser),n=(0,u.dV)({art:t,user:r})?e("Чтобы читать новые книги, продлите её"):e("Чтобы начать читать эту и другие новые книги, продлите её"),{partnerBrandIdentities:s}=eq({statusSubscription:"grace",user:r,art:t});return s.length?(0,i.jsx)(i.Fragment,{children:s.map((t,r)=>{var o;return(0,i.jsxs)("div",{className:P().saleBlockPartnerSubGracePeriod,children:[(0,i.jsx)("div",{className:P().saleBlockPartnerSubGracePeriod__title,children:e("Подписка остановлена")}),(0,i.jsx)("div",{className:P().saleBlockPartnerSubGracePeriod__description,children:n}),(0,i.jsxs)("div",{className:P().saleBlockPartnerSubGracePeriod__partner,style:{color:null!==(o=t.primary_color)&&void 0!==o?o:void 0},children:[(0,i.jsx)("div",{className:P().partnerName,children:t.name_ru}),t.url_to_landing&&(0,i.jsx)(x.z,{text:e("Продлить"),mode:"primary",size:"small",href:t.url_to_landing,className:P().saleBlockPartnerSubGracePeriod__button})]})]},r)})}):(0,i.jsx)(i.Fragment,{})};var tv=r(91270),tf=r(52535);let tk=e=>{var t,r;let c=(0,l.useRouter)(),{t:_}=(0,o.$G)(),{art:m,bookSubPath:p}=(0,d.G)(),h=(0,a.TL)(),{size:v="large",hasIcon:f=!0}=e,k=(0,a.CG)(e=>e.foundationUser),g=(0,a.CG)(e=>e.browser.headers),j=!k.id,y=k.BSK,B=(0,n.useMemo)(()=>j?y.includes(String(m.id)):(0,u.kW)(m),[y,j,m]),[S,{isLoading:C}]=a.wk.useAddToCartMutation(),[N,T]=(0,n.useState)(B),{data:w}=a.Ce.useGetFourArtOfferQuery();(0,n.useEffect)(()=>{T(B)},[m.id,B]);let A=()=>{T(!0),G.TM.sendEvent(["LITRES_TRACKER"],{eventType:"card_add_item",params:(0,u.Eb)({art:m,extra:{source_internal:(0,u.bu)(p)}})}),h(a.UY.util.invalidateTags([{type:"Art",id:m.id}])),(null==w?void 0:w.offer_status)!=="NOT_ACTIVE"||k.abonement.is_active||k.subscription.is_active||(G.TM.sendEvent(["LITRES_TRACKER"],{eventType:"fourth_gifted_banner_view",params:(0,u.Eb)({art:m,extra:{source_internal:"book_card"}})}),R(!0))},[I,R]=(0,n.useState)(!1);return(0,u.zt)({art:m,user:k})?(0,i.jsxs)("div",{className:b()(P().button,null===(t=e.classes)||void 0===t?void 0:t.buttonWrapper),children:[B?(0,i.jsx)(x.z,{mode:"secondary",type:"button",size:v,text:_("В корзине"),secondaryText:_("Перейти"),className:b()(null===(r=e.classes)||void 0===r?void 0:r.button),onClick:e=>{e.stopPropagation(),e.preventDefault(),c.push(tf.nV.CART)},fullWidth:"large"===v,e2eId:"book__goToCartButton"}):(0,i.jsx)(x.z,{mode:"secondary",type:"button",size:v,text:"large"===v?_("Добавить в корзину"):_("В корзину"),icon:f?(0,i.jsx)(E.uQ,{name:"cart",size:24}):null,onClick:e=>{var t,r;e.stopPropagation(),e.preventDefault(),s.BK.sendEcommerceEventWithArts({event:s.uK.ADD_TO_CART,payload:{currency:g["ui-currency"]||"RUB",value:null!==(r=null===(t=m.prices)||void 0===t?void 0:t.final_price)&&void 0!==r?r:0,arts:[m]}},k.is_tester),j&&y.length>15?h(a.hi.global.interfaceRequests.setLoginPopupError({isOpen:!0,errorText:_("В вашей корзине уже 16 книг, авторизуйтесь, чтобы отложить больше")})):S({artIds:[m.id]}).unwrap().then(A)},loading:C||N,disabled:N,fullWidth:"large"===v,e2eId:"book__addToCartButton"}),(0,i.jsx)(Z.u_,{isOpen:I,onClose:()=>{R(!1)},closeOnClickOutside:!0,noGutters:!0,ariaLabel:_("Купите три книги одновременно и выберите четвёртую в подарок"),children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:P().giftModal,children:[(0,i.jsx)("h3",{className:P().giftModal__title,children:_("Купите три книги одновременно и выберите четвёртую в подарок")}),(0,i.jsx)(eb.g.BooksEmpty,{}),(0,i.jsx)(eb.g.Terms,{onTermsClick:()=>{G.TM.sendEvent(["LITRES_TRACKER"],{eventType:"fourth_gifted_banner_click",params:(0,u.Eb)({art:m,extra:{source_internal:"book_card"}})})}})]}),(0,i.jsx)("p",{className:P().giftModal__text,children:_("Чтобы воспользоваться акцией, добавьте нужные книги в корзину.")})]})})]}):null};var tx=r.p+"static/media/litresLogo.37bcf8ef.svg",tg=r(47902);let tj=()=>{var e,t,r,n,a,l,c,_;let{art:u}=(0,d.G)(),m=u.is_auto_speech_gift&&u.linked_arts?u.linked_arts[0]:u,{t:p,i18n:h}=(0,o.$G)();return(0,i.jsxs)("div",{className:P().detailedReceipt,children:[!!(null===(e=m.prices)||void 0===e?void 0:e.discount_percent)&&(0,i.jsxs)("div",{className:b()(P().detailedReceipt__row,P().detailedReceipt__discount),children:[(0,i.jsxs)("div",{className:P().title,children:[p("Скидка {discount}% от",{discount:m.prices.discount_percent}),(0,i.jsx)("img",{src:tx,alt:"Литрес",className:P().logo})]}),(0,i.jsxs)("div",{className:P().cost,suppressHydrationWarning:!0,children:["−",(0,s.aS)(((null===(t=m.prices)||void 0===t?void 0:t.full_price)||0)-((null===(r=m.prices)||void 0===r?void 0:r.final_price)||0),null===(n=m.prices)||void 0===n?void 0:n.currency,h.language)]})]}),!!(null===(a=m.prices)||void 0===a?void 0:a.account_money)&&(0,i.jsxs)("div",{className:b()(P().detailedReceipt__row,P().detailedReceipt__account),children:[(0,i.jsx)("div",{className:P().title,children:p("Со счёта Литрес")}),(0,i.jsxs)("div",{className:P().cost,suppressHydrationWarning:!0,children:["−",(0,s.aS)((null===(l=m.prices)||void 0===l?void 0:l.can_be_paid_by_account_money)?m.prices.cost_with_bonus:null===(c=m.prices)||void 0===c?void 0:c.account_money,null===(_=m.prices)||void 0===_?void 0:_.currency,h.language)]})]})]})},ty=e=>{let{offeredArt:t,isSaleBlockExperimentApplied:r}=e,{t:n}=(0,o.$G)(),l=(0,a.CG)(e=>e.face.language||s.pF.ru),c=(0,s.s7)(l);return(0,i.jsxs)("div",{className:P().detailedReceipt,children:[t.accountMoneyInTotalPrice.checkIfPositive()&&(0,i.jsxs)("div",{className:b()(P().detailedReceipt__row,P().detailedReceipt__account),children:[(0,i.jsx)("div",{className:P().title,children:n("Спишем с Литрес-счёта")}),(0,i.jsx)("div",{className:P().cost,suppressHydrationWarning:!0,children:t.accountMoneyInTotalPrice.toStringWithCurrency()})]}),r&&c&&(null==t?void 0:t.earnedBonusesAmount)>0&&(0,i.jsx)(tg.U,{bonus:t.earnedBonusesAmount})]})};var tB=r(63475),tS=r(14120),tC=r(1178);let tN=r.n(tC)()(()=>Promise.all([r.e(9266),r.e(1903)]).then(r.bind(r,41903)),{loadableGenerated:{webpack:()=>[41903]},ssr:!1});var tT=r(81220),tw=r.n(tT);function tP(e,t){let r=t("Купить и скачать");return e.isDrm&&(r=t("audio"===e.type?"Купить аудиокнигу":"Купить текстовую книгу")),"podcast-part"===e.type&&(r=t("Купить выпуск подкаста")),"podcast"===e.type&&(r="Купить ".concat(e.podcastsLeftToBuy," ").concat((0,s.pd)(e.podcastsLeftToBuy,["выпуск","выпуска","выпусков"]))),e.canBeFullyPaidByAccountMoney&&(r=t("Оплатить со счёта Литрес")),e.isDraft&&(r=t("Получить доступ к черновику")),e.isArtForPreorder&&(r=t("Сделать предзаказ")),e.isAutoSpeechGift&&(r=t("Купить текстовую версию")),r}let tA=e=>{var t,r,n,o;let{art:a}=(0,d.G)(),s=a.is_auto_speech_gift&&a.linked_arts?a.linked_arts[0]:a,l=new tB.J(s);return(0,i.jsxs)("div",{className:b()(P().block,{[P().experimental]:"control"!==e.saleBlockExperimentGroupName,[P().withDetailedInfoWidget]:"widgets-detailed-info"===e.saleBlockExperimentGroupName||"widgets-detailed-info-collapsible"===e.saleBlockExperimentGroupName}),"data-testid":"book-sale-block__PPD--wrapper",itemProp:"offers",itemScope:!0,itemType:"https://schema.org/Offer",children:[(0,i.jsx)("meta",{itemProp:"priceCurrency",content:null!==(n=null===(t=s.prices)||void 0===t?void 0:t.currency)&&void 0!==n?n:"RUB"}),(0,i.jsx)("meta",{itemProp:"price",content:(null!==(o=null===(r=s.prices)||void 0===r?void 0:r.cost_with_bonus)&&void 0!==o?o:0).toFixed(2)}),(0,i.jsx)(tI,{offeredArt:l,...e})]})},tI=e=>{var t;let{offeredArt:r,ppdModelPriority:o}=e,_=(0,l.useRouter)(),{art:m,bookSubPath:p}=(0,d.G)(),h=(0,eh.t)(),b=(0,tv.useDispatch)(),v=(0,a.CG)(e=>e.browser.headers),f=(0,a.CG)(e=>e.foundationUser.is_tester),k=(0,a.CG)(e=>e.foundationUser.abonement.is_active),x=(0,a.CG)(e=>e.foundationUser.subscription.is_active),[g,j]=(0,n.useState)(!1),[y,B]=(0,n.useState)(!1),S=["upsale10","upsale20"].includes((0,c.rb)("feature_web_epic2220")),C=["10","20"].includes((null===(t=_.query.presale)||void 0===t?void 0:t.toString())||""),{data:N,isFetching:T}=a.C9.useGetPresaleArtsQuery({artId:m.id},{skip:!g}),{goToPayment:w,isGoingToNewPaymentFrame:P,paymentEntryPointControlRef:A}=(0,ey.o)(),I=(0,n.useRef)(null),R=(e,t)=>{if(t){var r,i;s.BK.sendEcommerceEventWithArts({event:s.uK.PURCHASE,payload:{transactionId:t,currency:v["ui-currency"]||"RUB",value:null!==(i=null===(r=m.prices)||void 0===r?void 0:r.final_price)&&void 0!==i?i:0,arts:[m]}},f)}_.reload()};return(0,n.useEffect)(()=>{let e=new URL(window.location.href);e.searchParams.has("force")&&"openPresale"===e.searchParams.get("force")&&(j(!0),e.searchParams.delete("force"),window.history.pushState("",document.title,e.toString()))},[]),(0,n.useEffect)(()=>{g&&!T&&(N&&0!==N.length||w())},[T]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tG,{offeredArt:r,ppdModelPriority:o,saleBlockExperimentGroupName:e.saleBlockExperimentGroupName,handleGoToPaymentClick:e=>{var t;!S&&!C||k||x||(null===(t=m.prices)||void 0===t?void 0:t.can_be_paid_by_account_money)?w(e):h?(j(!0),B(!0)):b(a.hi.global.interfaceRequests.setLoginPopupError({isOpen:!0,errorText:"Авторизуйтесь для покупки",urlParams:{force:"openPresale"}}))},isGoingToNewPaymentFrame:P||T,ref:I}),(0,i.jsx)(tS.n,{offeredArt:r,alignNotificationRef:I,onSuccessPaymentViaAccount:R,onRetryGoingToPayment:w,onGoingToPayment:()=>{G.TM.sendEvent(["LITRES_TRACKER"],{eventType:"book_card_click_buy",params:(0,u.Eb)({art:m,extra:{source_internal:(0,u.bu)(p)}})})},cameFromSourceData:e.cameToPaymentFromSourceData,afterPaymentRedirectParams:{successRedirectUrl:"",failRedirectUrl:"",backUrl:s.Ym?window.location.pathname:""},ref:A}),g&&!T&&!!(null==N?void 0:N.length)&&N.length>0&&(0,i.jsx)(tN,{handleSuccessPaymentViaAccount:R,cameFromSourceData:e.cameToPaymentFromSourceData,isOpenExternal:y,setOpenExternal:B})]})},tG=(0,n.forwardRef)((e,t)=>{let{saleBlockExperimentGroupName:r}=e;return"control"===r?(0,i.jsx)(tR,{...e,ref:t}):"buttons-short-info"===r?(0,i.jsx)(tE,{...e,ref:t}):"widgets-detailed-info-collapsible"===r||"widgets-detailed-info"===r?(0,i.jsx)(tW,{...e,ref:t}):null});tG.displayName="BuyArtActionUi";let tR=(0,n.forwardRef)((e,t)=>{let{offeredArt:r}=e,{t:n}=(0,o.$G)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:P().block__price,children:[(0,i.jsxs)("div",{className:P().block__price__inner,children:[(0,i.jsx)("strong",{className:r.discountPercentage.checkIfPositive()?P().block__price__final:P().block__price__default,"data-testid":"book__saleBlock--discountPrice",children:r.totalPrice.toStringWithCurrency()}),r.discountPercentage.checkIfPositive()&&(0,i.jsxs)("div",{className:P().block__price__discount,children:[(0,i.jsx)("span",{className:P().block__price__full,"data-testid":"book__saleBlock--fullPrice",children:r.fullPrice.toStringWithCurrency()}),(0,i.jsx)("div",{className:P().block__price__discount__label,children:(0,i.jsx)(ej.y,{text:"-".concat(r.discountPercentage.toStringWithSymbol()),size:"xs",hasBorder:!1})})]})]}),(null==r?void 0:r.priceWithBonus.checkIfPositive())&&(0,i.jsx)("div",{className:P().block__price__with_bonus,children:"".concat(r.priceWithBonus.toStringWithCurrency()," – цена при оплате бонусами")}),(null==r?void 0:r.earnedBonusesAmount)>0&&(0,i.jsx)(tg.j,{bonus:r.earnedBonusesAmount})]}),(0,i.jsx)("div",{className:P().button,"data-testid":"book-sale-block__price--button",children:(0,i.jsx)(x.z,{ref:t,mode:"primary",type:"button",size:"large",text:tP(r,n),fullWidth:!0,className:P().ppdButton,loading:e.isGoingToNewPaymentFrame,disabled:e.isGoingToNewPaymentFrame,onClick:e.handleGoToPaymentClick})}),(0,i.jsx)(tk,{}),r.isPriceReducedByAccountMoneyOrBonuses&&(0,i.jsx)(tj,{})]})});tR.displayName="BuyArtButtonControlVariant";let tE=(0,n.forwardRef)((e,t)=>{let{offeredArt:r,ppdModelPriority:n}=e,{t:a}=(0,o.$G)(),s=r.totalPrice.toStringWithCurrency();return r.discountPercentage.checkIfPositive()&&(s=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:tw().fullPrice,"data-testid":"book__saleBlock--fullPrice",children:r.fullPrice.toStringWithCurrency()})," ",(0,i.jsx)("span",{"data-testid":"book__saleBlock--fullPrice",children:r.totalPrice.toStringWithCurrency()})]})),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:b()(P().button,tw().shortInfoButtonContainer),"data-testid":"book-sale-block__price--button",children:[(0,i.jsx)(x.z,{ref:t,mode:n,type:"button",size:"large",text:tP(r,a),secondaryText:s,fullWidth:!0,className:P().ppdButton,loading:e.isGoingToNewPaymentFrame,disabled:e.isGoingToNewPaymentFrame,onClick:e.handleGoToPaymentClick}),r.discountPercentage.checkIfPositive()&&(0,i.jsx)(ej.y,{containerClass:tw().shortInfoButton__discountLabel,text:"-".concat(r.discountPercentage.toStringWithSymbol()),size:"xs",hasBorder:!1})]}),(0,i.jsx)(tk,{}),(r.discountPercentage.checkIfPositive()||r.isPriceReducedByAccountMoneyOrBonuses)&&(0,i.jsx)(ty,{offeredArt:r,isSaleBlockExperimentApplied:"control"!==e.saleBlockExperimentGroupName})]})});tE.displayName="BuyArtButtonShortInfoVariant";let tW=(0,n.forwardRef)((e,t)=>{let{t:r}=(0,o.$G)(),{offeredArt:n,ppdModelPriority:a,isGoingToNewPaymentFrame:s,handleGoToPaymentClick:l,saleBlockExperimentGroupName:c}=e,d="",_="small";return n.discountPercentage.checkIfPositive()&&(d=(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("span",{className:tw().fullPrice,"data-testid":"book__saleBlock--fullPrice",children:n.fullPrice.toStringWithCurrency()})}),_="medium"),(0,i.jsx)(eT,{className:tw().ppdWidget,bigBuyButtonText:n.totalPrice.toStringWithCurrency(),secondaryText:d,canContentBeCollapsed:"widgets-detailed-info-collapsible"===c,onBuyButtonClick:l,buyActionMode:a,isExpandedByDefault:"primary"===a,buyActionSize:_,discountPercentage:n.discountPercentage,isGoingToNewPaymentFrame:s,profits:(0,i.jsx)("p",{className:tw().profits_description,children:r("Книга останется у вас навсегда и будет доступна на любом устройстве")}),smallBuyButtonText:n.totalPrice.toStringWithCurrency(),titleText:(0,i.jsx)("span",{children:r("Купить и скачать")}),extraAction:(0,i.jsx)(tk,{size:_,classes:{button:tw().actions_cartButton},hasIcon:!1}),extraInfo:n.discountPercentage.checkIfPositive()||n.isPriceReducedByAccountMoneyOrBonuses?(0,i.jsx)(ty,{offeredArt:n,isSaleBlockExperimentApplied:"control"!==e.saleBlockExperimentGroupName}):null,ref:t})});tW.displayName="BuyPpdWidgetDetailedInfoVariant";var tL=r(61647),tD=r(12169),tM=r(3827);let tF=()=>{var e,t;let{art:r}=(0,d.G)(),o=(0,l.useRouter)(),a=new eP.W((null===(e=r.paper_book)||void 0===e?void 0:e.external_price)||0,"RUB").toStringWithCurrency(),s="1"===(0,c.rb)("paper_books")||"1"===o.query.paper_books;return(0,n.useEffect)(()=>{var e;G.TM.sendEvent(["LITRES_TRACKER"],{eventType:"buy_paperbook_button_view",params:{id:r.id,url:null===(e=r.paper_book)||void 0===e?void 0:e.referral_link}})},[]),(0,i.jsx)("div",{className:b()(P().block),children:(0,i.jsxs)("div",{children:[s&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h4",{children:"Бумажная книга"}),!!(null===(t=r.paper_book)||void 0===t?void 0:t.external_price)&&(0,i.jsx)("div",{className:b()(P().block__price,P().paperPrice),children:(0,i.jsx)("div",{className:P().block__price__inner,children:(0,i.jsx)("strong",{className:P().block__price__default,children:a})})})]}),(0,i.jsx)(x.z,{mode:"primary",type:"button",size:"large",text:s?"Купить в Читай-город":"Купить бумажную книгу",fullWidth:!0,className:P().ppdButton,onClick:()=>{var e,t;window.open(null===(e=r.paper_book)||void 0===e?void 0:e.referral_link,"_blank"),G.TM.sendEvent(["LITRES_TRACKER"],{eventType:"buy_paperbook_button_click",params:{id:r.id,url:null===(t=r.paper_book)||void 0===t?void 0:t.referral_link}})}}),(0,i.jsx)("p",{className:P().profits_description,children:"Вы можете приобрести бумажную версию этой книги на сайте Читай-город"})]})})};var tO=r(77485),tz=r(35087),tK=r(76103),tq=r(43764),tU=r.n(tq);let tV=e=>{let{subText:t,mainText:r,icon:n}=e;return(0,i.jsxs)("div",{className:tU().boughtBookLine,children:[(0,i.jsx)(E.uQ,{...n,className:tU().icon}),(0,i.jsxs)("div",{className:tU().textBlock,children:[(0,i.jsx)("div",{className:tU().mainText,children:r}),t&&(0,i.jsx)("div",{className:tU().subText,children:t})]})]})};var tX=r(97237),tZ=r.n(tX);let t$=()=>{let{t:e}=(0,o.$G)(),t=(0,J.uH)(),r=(0,a.CG)(e=>e.foundationUser),{art:s}=(0,d.G)(),{addMaterialsData:l}=a.qL.useGetArtFilesQuery({artId:s.id},{selectFromResult:e=>{var t,r;return{addMaterialsData:null!==(r=null===(t=e.currentData)||void 0===t?void 0:t.filter(e=>{let{is_additional:t}=e;return t}))&&void 0!==r?r:[]}}}),c=(0,n.useMemo)(()=>{var e;return null!==(e=l.map(e=>{let i=(0,tK.TG)(e),n=(0,eo.qm)(s.id,e.id,e.filename.endsWith(null!=i?i:"")?e.filename:"".concat(e.filename).concat(i),t,(0,u.dV)({art:s,user:r}));return{id:e.id,fileName:e.filename.endsWith(".".concat(i))?e.filename.replace(".".concat(i),""):e.filename,format:null!=i?i:"",url:n,size:(0,u.qb)(e.size,"firstLetterUpper",!1)}}))&&void 0!==e?e:[]},[l,t,s,r]);return c.length?1===c.length?(0,i.jsx)(tV,{icon:{name:"addMaterials",size:16},mainText:(0,i.jsx)(o.cC,{i18nKey:"<a>Скачать</a> дополнительные материалы",components:{a:(0,i.jsx)(S.Fg,{href:c[0].url,download:!0})}}),subText:"".concat(c[0].format.toUpperCase(),", ").concat(c[0].size)}):(0,i.jsx)(tV,{icon:{name:"addMaterials",size:16},mainText:e("Дополнительные материалы"),subText:(0,i.jsx)("div",{className:tZ().materials,children:c.map(e=>(0,i.jsxs)("span",{className:tZ().materials__line,children:[(0,i.jsx)(S.Fg,{href:e.url,download:!0,children:"".concat(e.fileName,".").concat(e.format).toLowerCase()}),e.size]},e.id))})}):null},tQ=()=>(0,i.jsx)("div",{className:P().block__addMaterialsDownload,children:(0,i.jsx)(t$,{})});var tH=r.p+"static/media/headphones.7a12138b.svg",tY=r.p+"static/media/book.045c76c4.svg",tJ=r(98505);let t0=e=>{var t;let{offeredBundle:r,cameToPaymentFromSourceData:a}=e,{t:l}=(0,o.$G)(),c=(0,n.useRef)(null),{art:_}=(0,d.G)(),{goToPayment:m,isGoingToNewPaymentFrame:p,paymentEntryPointControlRef:h}=(0,ey.o)();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:P().bundleBlock,children:(0,i.jsxs)("div",{className:P().bundleBlock__title,children:[(0,i.jsx)("p",{children:l("Cразу два формата")}),(0,i.jsxs)("div",{className:P().bundleBlock__iconWrapper,children:[(0,i.jsx)(tY,{}),(0,i.jsx)(tH,{})]})]})}),(0,i.jsx)("p",{className:P().bundleBlock__caption,children:l("Переключайтесь с текста на аудио и\xa0продолжайте слушать с\xa0того же места")}),(0,i.jsxs)("div",{className:P().bundleBlock__priceWrapper,children:[(0,i.jsx)("span",{className:P().bundleBlock__newPrice,children:r.realMoneyInTotalPrice.toStringWithCurrency()}),(0,i.jsx)("span",{className:P().bundleBlock__oldPrice,children:r.fullPrice.toStringWithCurrency()}),(0,i.jsx)(ej.y,{text:"-".concat(null===(t=r.discountPercentage)||void 0===t?void 0:t.toStringWithSymbol()),size:"xs",hasBorder:!1})]}),(0,i.jsx)(x.z,{size:"medium",mode:"secondary",text:l("Купить текст и аудио"),loading:p,disabled:p,onClick:e=>{e.stopPropagation(),m()}}),(0,i.jsx)(tJ.S,{ppdOffer:r,alignNotificationRef:c,cameFromSourcePayload:a.cameFromSourcePayload,onGoingToPayment:()=>{z.TM.sendEvent(["LITRES_TRACKER"],{eventType:"book_card_bundle_buy_click",params:(0,u.Eb)({art:_,extra:{source_internal:(0,s.bu)()}})})},cameFromSource:a.cameFromSource,afterPaymentRedirectParams:{successRedirectUrl:"",failRedirectUrl:"",backUrl:s.Ym?window.location.pathname:""},ref:h}),r.canAccountMoneyBeUsedForPayment&&r.accountMoneyInTotalPrice.lesserThen(r.totalPrice)&&(0,i.jsx)("div",{className:P().detailedReceipt,children:(0,i.jsxs)("div",{className:b()(P().detailedReceipt__row,P().detailedReceipt__account),children:[(0,i.jsx)("div",{className:P().title,children:l("Со счёта Литрес")}),(0,i.jsxs)("div",{className:P().cost,suppressHydrationWarning:!0,children:["−",r.accountMoneyInTotalPrice.toStringWithCurrency()]})]})})]})};var t1=r(31645),t4=r(99824),t2=r(78814),t3=r.n(t2);let t6=e=>{let{t}=(0,o.$G)(),{art:r,isDesktop:a,isFree:l}=e,{id:c}=r,[d,_]=(0,n.useState)(""),[m,p]=(0,n.useState)(""),h=(0,t1.N)(c),{value:b,setTrue:v,setFalse:f}=(0,e5.kt)(!1),k=(0,n.useCallback)(()=>{z.TM.sendEvent(["LITRES_TRACKER"],{eventType:l?"read_in_app_click":"buy_in_app_click",params:(0,u.Eb)({art:r,extra:{source_internal:"book_card"}})}),a&&v()},[a,r]);return((0,n.useEffect)(()=>{var e;let t=M({id:c,url:null===(e=window)||void 0===e?void 0:e.location.href});p(null!=t?t:h)},[c,s.Ym]),(0,n.useEffect)(()=>{b&&m&&(async()=>{_(await (0,t1.E)(m))})()},[b,m]),a)?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Z.u_,{isOpen:b,onClose:f,closeOnClickOutside:!0,children:(0,i.jsxs)("div",{className:t3().modal__content,children:[(0,i.jsx)("h3",{children:t("Читайте вебтуны в приложении")}),(0,i.jsx)("p",{children:t("Наведите камеру телефона на QR-код для скачивания")}),(0,i.jsx)(t4.U,{qr:d})]})}),(0,i.jsx)(x.z,{size:"large",fullWidth:!0,text:t(l?"Читать в приложении":"Купить в приложении"),mode:"primary",onClick:k,e2eId:l?"webtoon__readInApp--button":"webtoon__buyInApp--button"})]}):(0,i.jsx)(x.z,{size:"large",fullWidth:!0,text:t(l?"Читать в приложении":"Купить в приложении"),mode:"primary",href:m,onClick:k,e2eId:l?"webtoon__readInApp--button":"webtoon__buyInApp--button"})};var t9=r(91979);let t8=()=>{let e=(0,a.CG)(e=>e.browser.pda),{art:t}=(0,d.G)(),{t:r}=(0,o.$G)(),{hasFreeChapter:n}=(0,t9.a)(t);return(0,i.jsxs)("div",{className:P().block,children:[n&&(0,i.jsx)("div",{className:P().button,children:(0,i.jsx)(tL.X,{text:r("Читать бесплатные главы"),mode:"primary",size:"large",fullWidth:!0,isFragment:!0})}),(0,i.jsx)("div",{className:P().button,children:(0,i.jsx)(t6,{isDesktop:!e,art:t})}),n&&(0,i.jsx)("p",{className:P().price__caption,children:r("Все главы доступны в приложении")}),(0,i.jsx)("div",{className:P().saleBlockBonuses,children:(0,i.jsx)(tO.g,{})})]})};var t7=r(56321),t5=r(36123),re=r.n(t5);let rt=e=>{let{message:t}=e;return(0,i.jsx)("div",{className:re().container,children:(0,i.jsx)("div",{className:b()(re().message,{[re().fadeOut]:t.isRemoving,[re().fadeIn]:!t.isRemoving}),children:(0,i.jsx)("span",{children:t.text})})})},rr=e=>new Promise(t=>{setTimeout(()=>{e(),t()},300)}),ri=()=>{let[e,t]=(0,n.useState)(null),r=(0,n.useRef)(null),i=(0,n.useCallback)(async()=>{r.current&&(clearTimeout(r.current.timerId),await r.current.removeFn())},[]);return(0,n.useEffect)(()=>()=>{i()},[i]),{message:e,addMessage:(0,n.useCallback)(async e=>{await i(),t({text:e,isRemoving:!1});let n=async()=>{t(e=>e?{...e,isRemoving:!0}:null),await rr(()=>{t(null),r.current=null})},o=setTimeout(()=>n(),2e3);r.current={timerId:o,removeFn:n}},[i]),closeMessage:i}};function rn(e){return t=>{let{planId:r,bookSubPath:i}=t,n=tn.DV[r];G.TM.sendEvent(["LITRES_TRACKER"],{eventType:e,params:{monetization_type:"subscription_bookshelf",rate:n,source_internal:(0,u.bu)(i)}})}}let ro={send:{clickBookshelfTakeButton:function(e){let{artData:t,bookSubPath:r}=e;G.TM.sendEvent(["LITRES_TRACKER"],{eventType:"bookshelf_take_button_click",params:(0,u.Eb)({art:t,extra:{source_internal:(0,u.bu)(r)}})})},clickBookshelfTakeButtonInsideModal:function(){G.TM.sendEvent(["LITRES_TRACKER"],{eventType:"saleblock_purchase_button_click",params:{main_offer:"bookshelf"}})},successTakeBook:rn("book_take_success"),failTakeBook:rn("book_take_error"),closeTakeBook:rn("book_take_close")}};var ra=r(65567),rs=r.n(ra);let rl=function(e){let t=t=>{let{message:r,addMessage:n,closeMessage:o}=ri();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e,{addMessage:n,closeMessage:o,...t}),s.Ym&&null!==r?(0,t7.createPortal)((0,i.jsx)(rt,{message:r}),document.body):null]})};return t.displayName="ComponentWithMessage",t}(e=>{let{userSubscriptionId:t,renewAt:r,maxPrice:s,addMessage:l,closeMessage:c}=e,{art:_,bookSubPath:m}=(0,d.G)(),{t:p,i18n:h}=(0,o.$G)(),b=(0,a.CG)(e=>e.foundationUser),v=(0,a.TL)(),[f,k]=(0,n.useState)(!1),[g,j]=(0,n.useState)(!1),y=(0,u.dV)({art:_,user:b}),B=null==r?void 0:r.toLocaleDateString(h.language,{month:"long",day:"numeric"}),S=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!g&&(t&&ro.send.closeTakeBook({planId:e.planId,bookSubPath:m}),k(!1),c&&c())},C=()=>{ro.send.successTakeBook({planId:e.planId,bookSubPath:m}),v(a.UY.util.invalidateTags([{type:"Art",id:_.id}])),S()},N=()=>{j(!1),ro.send.failTakeBook({planId:e.planId,bookSubPath:m}),l&&l(p("Техническая ошибка"))},T=()=>{j(!0),ro.send.clickBookshelfTakeButtonInsideModal(),v(a.hi.foundationUser.getPresentBook_CSRF({artId:_.id,subId:t,onSuccess:C,onError:N}))};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x.z,{className:rs().saleBlockButton,mode:y?"secondary":"primary",icon:(0,i.jsx)(rc,{}),text:p("Получить навсегда"),size:"large",fullWidth:!0,onClick:()=>{ro.send.clickBookshelfTakeButton({artData:_,bookSubPath:m}),k(!0)}}),(0,i.jsx)(Z.u_,{title:p("Получить книгу навсегда?"),isOpen:f,onClose:()=>{S(!0)},primaryButton:{label:p("Получить"),loading:g,onClick:()=>{T()}},children:(0,i.jsxs)("p",{children:[p("Ваш тариф подписки позволяет получить навсегда одну книгу до {price} раз в месяц.",{price:s.toStringWithCurrency()}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),!!B&&p("{date} вы можете получить следующую.",{date:B})]})})]})}),rc=e=>(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,fill:"none",...e,children:(0,i.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeWidth:2,d:"M3 17V4.097C3 4.042 3.046 4 3.101 4c4.827.026 7.77 1.918 8.828 2.931.04.038.102.038.142 0 1.058-1.013 4-2.905 8.828-2.93A.1.1 0 0 1 21 4.1V17M17 17c-1.954.488-3.908 1.931-4.93 2.93a.1.1 0 0 1-.14 0C10.907 18.932 8.953 17.488 7 17M12 11v8"})}),rd=()=>{let{data:e}=(0,eO.Z)(),{availableArts:t}=e;return null==t||null==e.plan?null:(0,i.jsx)("div",{className:P().block,children:(0,i.jsx)(rl,{userSubscriptionId:e.id||0,planId:e.plan,renewAt:t.renewAt,maxPrice:t.maxPrice})})},r_=()=>{let{art:e,isDesktop:t,bookSubPath:r}=(0,d.G)(),n=new tB.J(e),{t:p}=(0,o.$G)(),h=(0,l.useRouter)(),b=(0,a.CG)(e=>e.foundationUser),v=(0,a.CG)(e=>!!e.foundationUser.id),f=(0,a.CG)(e=>e.browser.headers["client-host"]||"www.litres.ru"),[k]=(0,_.q)(e),{hasLibraryBlock:x,hasReferralBlock:g,hasSaleBlockForPreorder:j,hasNotificationSubscriptionBlock:y}=k,B=(0,u.Lx)(e),S=(0,u.DK)(e),C=(0,u.Lr)(e),N=(0,u.T4)(e),T=(0,u.eU)(e,j),w=(0,u.jL)(e),I=(0,u.Kg)(e),G=(0,u.uV)(e)&&x&&b.library_info.is_library_user,E=!t&&!(0,s.vo)(f)&&!(0,s.Ov)(f)&&!(0,s.p6)(f)&&!(0,s.qT)(f),L=Number((0,c.rb)("show_bundles"))||"1"===h.query.showBundles,D=a.qL.useGetArtBundleQuery({artIdOrSlug:e.id},{skip:!v||!(0,s.Ok)(f)||(0,u.Yg)(e)||!L}).data,M=(0,m.h)(!!D);if(B)return(0,i.jsx)(t8,{});if(I)return(0,i.jsx)(A,{});if(G)return(0,i.jsx)(R,{});if(N)return(0,i.jsx)(W,{title:p("Не доступна"),description:p("В вашей стране эта книга не продаётся. Если у вас включён VPN, отключите его")});if(C)return(0,i.jsx)(W,{title:p("Скоро в продаже")});if(T)return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(W,{title:p("Нет в продаже")}),(0,i.jsx)(A,{})]});if(S)return(0,i.jsx)(W,{title:p("Предзаказ оформлен")});if(!j)return(0,i.jsx)(i.Fragment,{});let F=!(0,u.eL)(b)&&(0,u.Yg)(e)||w;return(0,i.jsxs)(i.Fragment,{children:[F?(0,i.jsx)(ru,{}):(0,i.jsx)(rm,{}),y&&(0,i.jsx)(A,{}),E&&(0,i.jsx)(X,{isDesktop:t,art:e,isListenable:(0,u.F0)(e),withBottomMargin:k.hasMegafonePpdBlock}),k.hasMegafonePpdBlock&&(0,i.jsx)(tz.YZ,{}),D&&(0,i.jsx)(t0,{offeredBundle:new tM.i(D,n),cameToPaymentFromSourceData:M}),(0,i.jsx)("div",{className:P().saleBlockBonuses,children:(0,i.jsx)(tO.g,{canEarnBonusesAmount:n.canEarnedBonusesAmountAfterSignUpLoyalty})}),!r&&g&&(0,i.jsx)(en,{})]})},ru=()=>{let{art:e}=(0,d.G)(),[t]=(0,_.q)(e),r=(0,u.jL)(e),{t:n}=(0,o.$G)();return(0,i.jsxs)("div",{className:P().block,children:[(0,i.jsx)(ea,{isReceived:!!r}),t.hasListenBlock&&(0,i.jsx)(eQ,{text:n("Слушать")}),t.hasReadingBlock&&(0,i.jsx)(tL.X,{text:n("Читать"),mode:"primary",size:"large",fullWidth:!0}),t.hasDownloadBlock&&(0,i.jsx)(ep,{}),t.hasAddMaterialsDownloadBlock&&(0,i.jsx)(tQ,{})]})},rm=()=>{let{art:e}=(0,d.G)(),[t,r]=(0,_.q)(e),o=(0,m.h)(),a="primary",s=tD.Y.useExperimentGroupName({art:e,saleBlockParams:t});"control"!==s&&(t.hasAbonementBlock||t.hasSubscriptionBlock)&&(a="secondary");let l=(0,n.useMemo)(()=>new Map([["hasGiftBlock",(0,i.jsx)(ev,{},"hasGiftBlock")],["hasAbonementBlock",(0,i.jsx)(eD,{saleBlockExperimentGroupName:s,cameToPaymentFromSourceData:o},"hasAbonementBlock")],["hasSubscriptionBlock",(0,i.jsx)(tp,{saleBlockExperimentGroupName:s,cameToPaymentFromSourceData:o},"hasSubscriptionBlock")],["hasSaleBlockSubscriptionTokenUsageBlock",(0,i.jsx)(rd,{},"hasSaleBlockSubscriptionTokenUsageBlock")],["hasLibraryBlock",(0,i.jsx)(R,{},"hasLibraryBlock")],["shouldShowGracePeriodBlock",(0,i.jsx)(tb,{},"shouldShowGracePeriodBlock")],["hasPPDBlock",(0,i.jsx)(tA,{saleBlockExperimentGroupName:s,cameToPaymentFromSourceData:o,ppdModelPriority:a},"hasPPDBlock")],["hasPaperPPDBlock",(0,i.jsx)(tF,{},"hasPaperPPDBlock")]]),[o,a,s]);return(0,i.jsx)(i.Fragment,{children:r.map(e=>t[e]&&l.get(e))})}},15160:function(e,t,r){"use strict";r.d(t,{IM:function(){return s},Ne:function(){return d},bp:function(){return c},kP:function(){return l}});var i=r(70608),n=r(97439);let o=(e,t)=>t&&t>0?e("{bookNumber} книга в серии",{bookNumber:(()=>{switch(t){case 1:return e("Первая");case 2:return e("Вторая");case 3:return e("Третья");case 4:return e("Четвёртая");case 5:return e("Пятая");case 6:return e("Шестая");case 7:return e("Седьмая");case 8:return e("Восьмая");case 9:return e("Девятая");default:return String(t)}})()}):e("Входит в серию"),a=(e,t)=>t&&t>0?e("{count} выпуск в подкасте",{count:t}):e("Входит в подкаст"),s=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r?a(e,t):o(e,t)},l=e=>(0,i.Gs)(e)?1:(0,i.F0)(e)?2:(0,i.kk)(e)?10:(0,i.P7)(e)?11:0,c=e=>{switch((0,i.HX)(e)){case"book":return n.DI.TEXT;case"audiobook":return n.DI.AUDIO;case"podcast":return n.DI.PODCAST}},d=(e,t)=>e.length>t?" ".concat(e.slice(0,t),"..."):"".concat(e)},24807:function(e,t,r){"use strict";r.d(t,{r:function(){return B}});var i=r(31549),n=r(44194),o=r(94123),a=r(12649),s=r(55714),l=r(20239),c=r(48592),d=r(24810),_=r(70608),u=r(23050),m=r.n(u);let p=e=>{let{link:t}=e,{t:r}=(0,c.$G)();return(0,i.jsx)("div",{className:m().seriesSlide,"data-testid":"book__series--allArts",children:(0,i.jsx)(s.Fg,{href:t,children:r("Смотреть все книги серии")})})};var h=r(61794),b=r(15160);let v=e=>{let{t}=(0,c.$G)(),r=(0,_.P7)(e);if(r){let{data:i,isFetching:n}=h.qL.useGetPodcastEpisodesQuery({podcastId:e.parent_podcast_id||0,limit:100,with_episode_id:e.id});return{series:null==i?void 0:i.payload.data,isLoading:n,isEpisodePodcast:r,artSeriesUrl:e.parent_podcast_url?"/".concat(e.parent_podcast_url):"",artSeriesTitle:(0,b.IM)(t,e.podcast_serial_number,!0),artSeriesName:e.parent_podcast_name,artSeriesId:e.parent_podcast_id||0}}{var i,n;let o=null!==(n=null===(i=e.series)||void 0===i?void 0:i[0])&&void 0!==n?n:void 0,{data:a,isFetching:s}=h.oc.useGetSeriesArtsByArtIdQuery({artId:e.id,art_groups:[(0,b.kP)(e)],limit:100,o:"order_in_series_desc"},{skip:!o});return o?{series:a?a.data.filter(t=>t.art_type===e.art_type):[],isLoading:s,isEpisodePodcast:r,artSeriesUrl:String(null==o?void 0:o.url)+String((0,b.bp)(e)),artSeriesTitle:(0,b.IM)(t,null==o?void 0:o.art_order),artSeriesName:(0,b.Ne)((null==o?void 0:o.name)||"",80),artSeriesCount:null==o?void 0:o.arts_count,artSeriesOrder:null==o?void 0:o.art_order,artSeriesId:null==o?void 0:o.id}:{isLoading:!1,isEpisodePodcast:r}}};var f=r(73758),k=r(51865),x=r.n(k),g=r(28637),j=r(58655);let y=e=>{var t;let{episode:r,serialNumber:n,isHighlighted:o}=e;return(0,i.jsxs)("div",{className:x()(m().cover,{[m().highlighted]:o}),children:[(0,i.jsx)(j.uq,{artId:r.id,alt:r.title,coverSizes:{desktopNormal:140,desktopHighDensity:190,mobileNormal:140,mobileHighDensity:190,byHeight:!0},height:104,width:104*(r.cover_ratio&&r.cover_ratio<=1?r.cover_ratio:1),wrapperClassName:m().img,decoding:"async",loading:"lazy"}),n&&n>0&&(0,i.jsx)("div",{className:m().serialNumber,"data-testid":"book-series__serialNumber","aria-hidden":"true",role:"presentation",children:(0,i.jsx)("div",{className:m().innerSerialNumber,children:n})}),!r.is_draft_full_free&&(null===(t=r.prices)||void 0===t?void 0:t.discount_percent)&&(0,i.jsx)("div",{className:m().discount,"aria-hidden":"true",role:"presentation",children:(0,i.jsx)(g.y,{size:"xs",text:String(r.prices.discount_percent)+"%",hasBorder:!0})})]})},B=e=>{var t;let{updateStatusLoading:r}=e,{art:u,isDesktop:h,bookSubPath:b}=(0,d.G)(),{t:k}=(0,c.$G)(),{isLoading:x,series:g,isEpisodePodcast:j,artSeriesUrl:B,artSeriesTitle:S,artSeriesName:C,artSeriesCount:N,artSeriesOrder:T,artSeriesId:w}=v(u),P=j?k("Все выпуски"):k("Все книги серии"),A=(0,_.s$)(b),I=e=>{var t;if(j)return e.podcast_serial_number;let r=null===(t=e.series)||void 0===t?void 0:t.find(e=>e.id===w);return r&&T&&T<=(null!=N?N:0)?r.art_order:void 0},G=(e,t,r)=>{let i=r||0;e>8&&e-i<8&&(i=e-8);let n=i+8;return e>n&&t>n?G(e,t,n+1):[i,n]},R=(0,n.useMemo)(()=>{if(Array.isArray(g)){let e=[...g].sort((e,t)=>(I(e)||0)-(I(t)||0)),t=e.findIndex(e=>(null==e?void 0:e.id)===u.id)||0,[r,i]=G(e.length,t>0?t:0);return{array:e.slice(r,i),activeIndex:t-r}}return{array:[],activeIndex:0}},[g,u.id]);return((0,n.useEffect)(()=>{x||null==r||r("isSeriesLoaded")},[x]),!x&&(null==g?void 0:g.length))?(0,i.jsx)("div",{className:m().seriesWrapper__secondaryInfo,"data-testid":"book-series__wrapper",children:(0,i.jsxs)("div",{className:m().seriesWrapper__secondaryInfo__block,children:[(0,i.jsxs)("div",{className:m().seriesWrapper__title,"data-testid":"book__seriesSlider--title",children:[(0,i.jsx)(a.k,{maxHeight:75,mode:h?"www":"pda",separator:"...",isKeepWords:!1,isCheckDocumentHeight:!0,children:(0,i.jsx)("span",{children:"".concat(S,' "').concat(C,'"')})}),(0,i.jsx)(s.Fg,{onClick:()=>{A&&f.TM.sendEvent(["LITRES_TRACKER"],{eventType:"series_page_view",params:(0,_.Eb)({art:u,extra:{source_internal:"book_card_read_online_view"}})}),f.TM.sendEvent(["LITRES_TRACKER"],{eventType:"series_slider_click",params:(0,_.Eb)({art:u,extra:{source_internal:"book_card",item_type:"series",id:w}})})},href:B,e2eId:"book-series__all__editions--button",children:P})]}),(0,i.jsx)("div",{className:m().seriesWrapper,children:(0,i.jsxs)(o.i,{className:m().seriesWrapper__slider,hasArrows:"grayMode",verticalAlignArrow:"0%",scrollToActive:R.activeIndex,children:[null===(t=R.array)||void 0===t?void 0:t.map(e=>{var t,r;let n=I(e);return(0,i.jsxs)(l.I,{href:e.url||"",className:m().seriesWrapper__slide,"aria-label":"".concat(!e.is_draft_full_free&&(null===(t=e.prices)||void 0===t?void 0:t.discount_percent)?k("Скидка –{discount}%",{discount:null===(r=e.prices)||void 0===r?void 0:r.discount_percent})+". ":"").concat(e.title).concat(n&&n>0?". "+k("{art_order} книга в серии \xab{name}\xbb",{art_order:n,name:C}):""),children:[(0,i.jsx)(y,{episode:e,serialNumber:n,isHighlighted:e.id===u.id}),(0,i.jsx)("div",{className:m().seriesWrapper__description,"data-testid":"book__seriesArtTitle","aria-hidden":"true",children:(0,i.jsx)(a.k,{maxHeight:50,mode:h?"www":"pda",separator:"...",isKeepWords:!1,isCheckDocumentHeight:!0,children:(0,i.jsx)("div",{children:e.title})})})]},e.id)}),g.length>8&&N&&(0,i.jsx)(p,{link:B})]})})]})}):(0,i.jsx)(i.Fragment,{})}},34955:function(e,t,r){"use strict";r.d(t,{T:function(){return C}});var i=r(31549),n=r(44194),o=r(64009),a=r(34257),s=r(4438),l=r(48376),c=r(89798),d=r(48592),_=r(62094),u=r(78246),m=r.n(u),p=r(61794),h=r(80930),b=r(70608);let v=e=>{let t={title:"",chapters:[]};for(let r=0;r<e.length;r++){let i=e[r];if(0===Number(i.attr.deep)){t.title=i.text;continue}t.chapters.push({text:i.text,deep:Number(i.attr.deep)})}return t},f=e=>{let{t}=(0,d.$G)(),r=(0,b.F0)(e)&&!(0,b.c4)(e)&&!(0,b.P7)(e),i=(0,b.Lx)(e),o="".concat(h._n,"/").concat(e.contents_url),{data:a=""}=p.qL.useGetArtTableContentQuery({url:o},{skip:!e.contents_url||i||r}),{data:s}=p.qL.useGetArtFilesQuery({artId:e.id},{skip:!r}),{data:l}=p.qL.useGetWebtoonArtTableContentQuery({artIdOrSlug:e.id,limit:100},{skip:!i});return(0,n.useMemo)(()=>{if(r){if(!s)return;return{title:e.title,chapters:s.filter(b.NO).map((e,r)=>({text:t("Глава {num}",{num:r+1}),deep:1}))}}if(i){if(!l)return;return{title:e.title,chapters:l.map(e=>({text:e.title,deep:1}))}}if(a)try{let e=JSON.parse(m().xml2json(a,{compact:!0,textKey:"text",attributesKey:"attr"}));return v(e.toc["toc-item"])}catch(e){return}},[a,i,e,l,s,t])};var k=r(24810),x=r(73758),g=r(51865),j=r.n(g),y=r(24553),B=r.n(y);let S=e=>{let{tableContent:t,style:r}=e;return(0,i.jsxs)("div",{className:B().bookTableContent,style:r,role:"list",tabIndex:0,children:[(0,i.jsx)("div",{role:"heading","aria-level":4,children:null==t?void 0:t.title}),null==t?void 0:t.chapters.map((e,t)=>(0,i.jsx)("div",{className:j()(B().chapter,{[B().chapter_firstDeep]:1===e.deep,[B().chapter_secondDeep]:2===e.deep}),role:"listitem","data-testid":"book__tableContent--chapter",children:e.text},t))]})},C=n.memo(e=>{var t;let{isMobile:r,onClose:u}=e,{art:m}=(0,k.G)(),p=(0,_.Gc)("breakpoint-700"),{t:h}=(0,d.$G)(),{height:v}=(0,o.iP)(),g=()=>{x.TM.sendEvent(["LITRES_TRACKER"],{eventType:"show_content_click",params:(0,b.Eb)({art:m,extra:{source_internal:"book_card",item_type:"art"}})})},j=f(m),[y,C]=(0,n.useState)(!1),N=()=>{C(!0)};return((0,b.Lx)(m)||m.contents_url)&&((null==j?void 0:j.title)||(null==j?void 0:null===(t=j.chapters)||void 0===t?void 0:t.length))?(0,i.jsxs)(i.Fragment,{children:[r?(0,i.jsx)(c.L,{size:"medium",className:B().button,onClick:()=>{N(),g()},children:(0,i.jsxs)("div",{className:B().buttonTableContentWrapper,"data-testid":"book-table-content-component__wrapper",children:[(0,i.jsx)("div",{className:B().button__icon,children:(0,i.jsx)(s.uQ,{name:"tableOfContent",size:16})}),(0,i.jsx)("div",{children:h("Смотреть оглавление")})]})}):(0,i.jsx)(a.J,{trigger:"click",placement:"bottom",padding:16,contentClassName:B().popoverTableContent,content:(0,i.jsx)(S,{tableContent:null!=j?j:null,style:{maxHeight:Math.min((v-140)/2,520)}}),customCloseTriggers:["lostIntersect"],closeOnClick:!0,children:(0,i.jsx)(c.L,{size:"medium",onClick:g,className:p?B().button:B().grayButton,"aria-haspopup":"dialog",children:(0,i.jsxs)("div",{className:B().buttonTableContentWrapper,"data-testid":"book-table-content-component__wrapper",children:[(0,i.jsx)("div",{className:B().button__icon,children:(0,i.jsx)(s.uQ,{name:"tableOfContent",size:16})}),(0,i.jsx)("div",{className:B().button__text,children:h("Смотреть оглавление")})]})})}),(0,i.jsx)(l.R,{className:B().modalContainer,isOpen:y,onClose:()=>{C(!1),u&&u()},title:h("Оглавление"),testId:"book__tableContentModal",children:(0,i.jsx)(S,{tableContent:null!=j?j:null})})]}):null})},52523:function(e,t,r){"use strict";r.d(t,{l:function(){return d},s:function(){return c}});var i=r(31549);r(44194);var n=r(55714),o=r(51865),a=r.n(o),s=r(31530),l=r.n(s);let c=e=>{let{title:t,value:r,url:o,itemProp:a,className:s}=e;return(0,i.jsx)(d,{className:s,title:t,renderValue:()=>o?(0,i.jsx)(n.Fg,{itemProp:a,href:"/".concat(o),children:r}):(0,i.jsx)("span",{itemProp:a,children:r})})},d=e=>{let{title:t,renderValue:r,e2eId:n,className:o}=e;return(0,i.jsxs)("div",{className:a()(l().characteristic,o),"data-testid":n,children:[(0,i.jsx)("div",{className:l().characteristic__title,children:(0,i.jsxs)("span",{children:[t,": "]})}),r()]})}},30863:function(e,t,r){"use strict";r.d(t,{o:function(){return h}});var i=r(31549),n=r(44194),o=r(48592),a=r(59838),s=r(61794),l=r(55714),c=r(24810),d=r(22348),_=r(70608),u=r(52523),m=r(31530),p=r.n(m);let h=()=>{var e;let{art:t}=(0,c.G)(),{openFilesModal:r,fullFiles:m}=(0,d.J)(),{t:h}=(0,o.$G)(),b=(0,s.CG)(e=>e.foundationUser),v=(0,_.F0)(t),{data:f}=s.qL.useGetArtFilesQuery({artId:t.id},{skip:(0,_.Lx)(t)}),k=()=>{r()},x=Object.keys(a.SY).filter(e=>"agent"!==e&&"author"!==e).map(e=>{var r;return{role:a.SY[e],persons:null===(r=t.persons)||void 0===r?void 0:r.filter(t=>t.role===e)}}).filter(e=>e.persons&&e.persons.length>0),g=e=>{var t;let r=(null===(t=e.find(e=>"pdf_book"===e.encoding_type))||void 0===t?void 0:t.size)||void 0;return r?(0,_.qb)(r):null},j=(0,_.s2)(null!=f?f:[]),y=(0,_.jL)(t),B=!t.is_drm&&!!j.length&&!y&&!(0,_.eL)(b),S=(0,n.useMemo)(()=>{var e;return Array.from((null!==(e=null==t?void 0:t.rightholders)&&void 0!==e?e:[]).reduce((e,t)=>(t.name&&!e.has(t.name)&&e.set(t.name,t),e),new Map),e=>{let[,t]=e;return t})},[t]);return(0,i.jsxs)("div",{"data-testid":"book-characteristics__wrapper","data-analytics-id":"book-characteristics",className:p().characteristics,children:[null!==t.min_age&&(0,i.jsx)(u.s,{title:h("Возрастное ограничение"),value:String(t.min_age)+"+"}),(0,_.c4)(t)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.s,{title:h("Доступно"),value:h("{count} выпуск",{count:null!==(e=t.podcast_episodes_count)&&void 0!==e?e:0})}),t.date_written_at&&(0,i.jsx)(u.s,{title:h("Дата записи:").replace(":",""),value:new Date(t.date_written_at).toLocaleDateString("ru-RU",{day:"2-digit",month:"long",year:"numeric"}).replace(/\sг\./,"").replace((0,_.jT)(t.date_written_at),h((0,_.jT)(t.date_written_at)))})]}),t.first_time_sale_at&&!(0,_.R4)(t)&&(0,i.jsx)(u.s,{title:h("Дата выхода на Литрес"),value:new Date(t.first_time_sale_at).toLocaleDateString("ru-RU",{day:"2-digit",month:"long",year:"numeric"}).replace(/\sг\./,"").replace((0,_.jT)(t.first_time_sale_at),h((0,_.jT)(t.first_time_sale_at)))}),t.additional_info.translated_at&&!(0,_.R4)(t)&&(0,i.jsx)(u.s,{title:h("Дата перевода:").replace(":",""),value:new Date(t.additional_info.translated_at).toLocaleDateString("ru-RU",{year:"numeric"}).replace(/\sг\./,"")}),t.date_written_at&&!(0,_.R4)(t)&&(0,i.jsx)(u.s,{title:h("Дата написания:").replace(":",""),value:new Date(t.date_written_at).toLocaleDateString("ru-RU",(0,_.P7)(t)?{day:"2-digit",month:"long",year:"numeric"}:{year:"numeric"}).replace(/\sг\./,"").replace((0,_.jT)(t.date_written_at),h((0,_.jT)(t.date_written_at)))}),(0,_.g9)(t)&&!(0,_.R4)(t)&&!(0,_.c4)(t)&&(0,i.jsx)(u.s,{title:(0,_.F0)(t)?h("Длительность"):h("Объем:").replace(":",""),value:"".concat((0,_.g9)(t,!0,h)," ").concat((0,_.F0)(t)?"":h("стр.")," ").concat(t.images_count?"".concat(h("{count} иллюстрация",{count:t.images_count})):"")}),t.isbn&&(0,i.jsx)(u.s,{itemProp:v?void 0:"isbn",title:"ISBN",value:t.isbn}),(0,_.cn)(t)&&f&&g(f)&&(0,i.jsx)(u.s,{title:h("Общий размер"),value:g(f)}),(0,_.g9)(t)&&(0,_.cn)(t)&&!(0,_.R4)(t)&&(0,i.jsx)(u.s,{itemProp:"numberOfPages",title:h("Общее кол-во страниц"),value:"".concat((0,_.g9)(t))}),x.map(e=>e.role&&e.persons&&(0,i.jsxs)("div",{className:p().characteristic,"data-testid":"book__characteristics__person",children:[(0,i.jsx)("div",{className:p().characteristic__title,children:(0,i.jsxs)("span",{children:[h(e.role,{count:e.persons.length}),":"," "]})}),(0,i.jsx)("div",{className:p().characteristic__values,children:e.persons.map((e,t,r)=>e.url?(0,i.jsxs)(l.Fg,{href:e.url,children:[e.full_name,t<r.length-1?", ":""]},e.id):(0,i.jsxs)("div",{children:[e.full_name,t<r.length-1?", ":""]},e.id))})]},e.role)),S.length>0&&(0,i.jsx)(u.l,{title:1===S.length?h("Правообладатель"):h("Правообладатели"),renderValue:()=>S.map((e,t,r)=>{let{url:o,name:a}=e;return(0,i.jsxs)(n.Fragment,{children:[o?(0,i.jsx)(l.Fg,{href:"/".concat(o),children:a}):(0,i.jsx)("span",{children:a}),r.length-1>t&&(0,i.jsx)("span",{className:p().separator,children:", "})]},"".concat(a,"-").concat(t))}),e2eId:"book__characteristicsCopyrightHolder"}),B&&(0,i.jsxs)("div",{className:p().characteristic,"data-testid":"bookCard__characteristicsFileFormat--wrapper",children:[(0,i.jsx)("div",{className:p().characteristic__title,children:(0,i.jsxs)("span",{role:"heading","aria-level":5,children:[h("Формат скачивания"),":"," "]})}),(0,i.jsx)("div",{role:"list",children:j.map((e,t,r)=>(0,i.jsxs)("span",{className:p().fileFormat,role:"listitem",children:[m.length?(0,i.jsx)(l.Fg,{className:p().fileFormat__link,onClick:k,children:e}):e,r.length-1>t&&", "]},e))})]})]})}},80411:function(e,t,r){"use strict";r.d(t,{i:function(){return f}});var i=r(31549),n=r(44194),o=r(4438),a=r(89798),s=r(61794),l=r(91270),c=r(48592),d=r(51865),_=r.n(d),u=r(62094),m=r(24810),p=r(70608),h=r(73758),b=r(87203),v=r.n(b);let f=n.memo(e=>{let{className:t}=e,r=(0,l.useDispatch)(),{art:n,isFinished:d,setIsFinished:b}=(0,m.G)(),f=(0,u.Gc)("breakpoint-700"),{t:k}=(0,c.$G)(),{id:x}=(0,l.useSelector)(e=>e.foundationUser),[g,{isLoading:j}]=s.oq.useSetArtFinishedMutation(),[y,{isLoading:B}]=s.oq.useUnsetArtFinishedMutation(),S=0===x,C=(0,p.F0)(n),N=()=>{r(s.hi.global.interfaceRequests.setLoginPopupError({isOpen:!0,errorText:C?k("Чтобы отметить книгу как прослушанную, зарегистрируйтесь или войдите"):k("Чтобы отметить книгу как прочитанную, зарегистрируйтесь или войдите")}))};return(0,i.jsxs)(a.L,{size:"medium",onClick:()=>{if(S){N();return}b&&(d?(b(!1),y({artId:n.id,userId:x}).unwrap()):(b(!0),g({artId:n.id,userId:x}).unwrap(),h.TM.sendEvent(["LITRES_TRACKER"],{eventType:"mark_as_read_click",params:(0,p.Eb)({art:n,extra:{source_internal:"book_card",item_type:"art"}})})))},disabled:j||B,analyticsId:"finish-button",className:_()(t,v().button,{[v().finishButton]:!f,[v().finishButton__mark]:!f&&d,[v().finishButton__unmark]:!f&&!d}),children:[(0,i.jsx)("div",{className:v().button__icon,children:d?(0,i.jsx)(o.uQ,{name:f?"check":"finishFilled",size:16,className:_()(v().icon,f?v().button__icon_accent:v().button__icon_green)}):(0,i.jsx)(o.uQ,{name:f?"check":"finish",size:16,className:v().icon})}),(0,i.jsxs)("div",{"data-testid":d?"modal__finishButton--finished":"modal__finishButton",children:[!d&&(0,i.jsx)(i.Fragment,{children:C?k("Отметить прослушанной"):k("Отметить прочитанной")}),d&&(0,i.jsx)(i.Fragment,{children:C?k("Прослушана"):k("Прочитана")})]})]})})},52135:function(e,t,r){"use strict";r.d(t,{Z:function(){return j}});var i=r(31549),n=r(44194),o=r(58931),a=r(4438),s=r(89798),l=r(62094),c=r(91270),d=r(48592),_=r(26249),u=r(51865),m=r.n(u),p=r(48376),h=r(9524),b=r(80930),v=r(24810),f=r(73758),k=r(70608),x=r(87203),g=r.n(x);let j=n.memo(e=>{let{shouldHideTextOnPDA:t=!1,className:r,onClose:u,isMobile:x,share_url:j}=e,{art:y}=(0,v.G)(),{t:B}=(0,d.$G)(),{asPath:S}=(0,_.useRouter)(),{href:C}=(0,l.TH)(),N=j||C||"".concat(b._n).concat(S),T=(0,c.useSelector)(e=>e.face.language),[w,P]=(0,n.useState)(!1),A=()=>{P(!1),u&&u()},I=()=>{f.TM.sendEvent(["LITRES_TRACKER"],{eventType:"share_item_click",params:(0,k.Eb)({art:y,extra:{source_internal:"book_card",item_type:"art"}})})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.L,{size:"medium",onClick:e=>{e.preventDefault(),P(!0),I()},className:m()(g().button,r),href:j,"aria-label":B("Поделиться"),e2eId:"sharingButton--icon",children:[(0,i.jsx)("div",{className:g().share__icon,children:(0,i.jsx)(a.uQ,{name:"share",size:16})}),(0,i.jsx)("span",{className:m()({[g().hideOnPDA]:t},g().button__text_showOnlyPDA),"data-testid":"modal__sharingButton--text",children:B("Поделиться")})]}),x?(0,i.jsx)(p.R,{className:g().modalContainer,isOpen:w,onClose:A,title:B("Поделиться"),testId:"modal__sharing--wrapper",children:(0,i.jsxs)("div",{className:g().share,children:[(0,i.jsxs)("div",{className:g().share__text,"data-testid":"modal__sharingText",children:[B("Выберите способ")," "]}),(0,i.jsx)("div",{className:g().share__block,"data-testid":"modal__sharingMethods",children:(0,i.jsx)(o.gj,{title:y.title,url:N,lang:T||"ru",onItemClick:I})})]})}):(0,i.jsx)(h.u_,{isOpen:w,onClose:A,title:B("Поделиться"),closeOnClickOutside:!0,e2eId:"modal__sharing--wrapper",children:(0,i.jsxs)("div",{className:g().share,children:[(0,i.jsxs)("div",{className:g().share__text,"data-testid":"modal__sharingText",children:[B("Выберите способ")," "]}),(0,i.jsx)("div",{className:g().share__block,"data-testid":"modal__sharingMethods",children:(0,i.jsx)(o.gj,{title:y.title,url:N,lang:T||"ru",onItemClick:I})})]})})]})})},82264:function(e,t,r){"use strict";r.d(t,{s:function(){return k}});var i=r(31549),n=r(44194),o=r(51865),a=r.n(o),s=r(4438),l=r(89798),c=r(61794),d=r(62094),_=r(59838),u=r(48592),m=r(24810),p=r(73758),h=r(70608),b=r(93644),v=r(87203),f=r.n(v);let k=n.memo(()=>{let{art:e,bookSubPath:t}=(0,m.G)(),{t:r}=(0,u.$G)(),o=(0,c.CG)(e=>!e.foundationUser.id),v=(0,c.CG)(e=>e.foundationUser.LKS),k=(0,c.CG)(e=>e.foundationUser.is_tester),x=(0,c.CG)(e=>e.browser.headers),g=(0,n.useMemo)(()=>o?v.includes(String(e.id)):e.is_liked,[v,o,e]),j=(0,d.Gc)("breakpoint-700"),[y,{isLoading:B}]=c.YE.useAddToWishlistMutation(),[S,{isLoading:C}]=c.YE.useRemoveFromWishlistMutation(),N=()=>{var t,r;_.BK.sendEcommerceEventWithArts({event:_.uK.ADD_TO_WISHLIST,payload:{currency:x["ui-currency"]||"RUB",value:null!==(r=null===(t=e.prices)||void 0===t?void 0:t.final_price)&&void 0!==r?r:0,arts:[e]}},k)};return(0,i.jsxs)(l.L,{size:"medium",className:a()(f().button,f().button_adaptive,{[f().button_bookPages]:!!t}),onClick:()=>{g?(p.TM.sendEvent(["LITRES_TRACKER"],{eventType:"favorites_remove_item",params:(0,h.Eb)({art:e,extra:{source_internal:(0,h.bu)(t),item_type:"art",art_label:(0,p.wn)(e)}})}),S({artId:e.id}).unwrap().then(N).catch(t=>{(0,b.L)("BackendInteractionError","Art unlike rejected(".concat((0,c.ff)(t)?t.code:"",")")).emit({artId:e.id})})):(p.TM.sendEvent(["LITRES_TRACKER"],{eventType:"favorites_add_item",params:(0,h.Eb)({art:e,extra:{source_internal:(0,h.bu)(t),item_type:"art",art_label:(0,p.wn)(e)}})}),y({artId:e.id}).unwrap().then(N).catch(t=>{(0,b.L)("BackendInteractionError","Art like rejected(".concat((0,c.ff)(t)?t.code:"",")")).emit({artId:e.id})}))},disabled:B||C,children:[(0,i.jsx)("div",{className:a()(f().button__icon,f().button__icon_big),"data-testid":"wishlist__button",children:(0,i.jsx)(s.uQ,{name:g?"favoritesFilled":"favorites",size:j?24:16,className:g?f().button__icon_accent:void 0})}),!j&&!t&&(0,i.jsx)("div",{className:f().button__text,children:r("Отложить")})]})})},31852:function(e,t,r){"use strict";r.d(t,{z:function(){return S}});var i=r(31549),n=r(44194),o=r(51865),a=r.n(o),s=r(24810),l=r(10687),c=r(70608),d=r(23950),_=r(67384),u=r(70145),m=r(89798),p=r(4438),h=r(66450),b=r(34955),v=r(80411),f=r(52135),k=r(82264),x=r(43510),g=r.n(x),j=()=>{let[e,t]=(0,n.useState)(!1),{art:r}=(0,s.G)(),o=(0,c.kk)(r),l=(0,c.c4)(r),d=()=>{t(!1)};return(0,i.jsxs)("ul",{className:a()(g().actionBar,g().actionBar__mobile),"data-testid":"book-functional-block__wrapper",children:[!o&&!r.my_art_status&&(0,i.jsx)("li",{children:(0,i.jsx)(k.s,{})}),(0,i.jsxs)("li",{children:[(0,i.jsx)(m.L,{size:"medium",className:a()(g().actionBar__subMenu),onClick:()=>{t(!0)},e2eId:"book--actionsMenu--button",children:(0,i.jsx)("div",{className:a()(g().actionBar__subMenu__button__icon),children:(0,i.jsx)(p.uQ,{name:"dots",size:24})})}),(0,i.jsx)(h.R,{open:e,onClose:d,containerClassName:g().actionBar__modalContainer,children:(0,i.jsxs)("div",{className:g().actionBar__bottomSheet,children:[!o&&(0,i.jsx)(b.T,{isMobile:!0,onClose:d}),!l&&(0,i.jsx)(v.i,{className:g().actionBar__bottomSheet__item}),(0,i.jsx)(f.Z,{isMobile:!0,onClose:d})]})})]})]})},y=r(87203),B=r.n(y);let S=e=>{let{path:t}=e,{art:r,bookSubPath:n}=(0,s.G)(),o=(0,l.X)(r,t),m=n?B().breadcrumbsBookPages:"";return(0,i.jsxs)("div",{className:a()(B().container,{[B().container_bookPages]:!!n}),children:[(0,i.jsxs)("div",{className:B().breadcrumbs,children:[(0,i.jsx)(d.Oo,{breadcrumbs:o,className:m}),(0,i.jsx)(_.T,{text:r.id,title:"книга",url:"https://hub.litres.ru/pages/edit_object/?art=".concat(r.id),className:B().hubLink})]}),(0,c.w0)(r)&&(0,i.jsx)("div",{className:a()(B().banner,{[B().banner_bookPages]:!!n}),"data-testid":"book-banner__wrapper",children:(0,i.jsx)(u.o,{art:r,bookSubPath:n})}),!n&&(0,i.jsx)("div",{className:B().disabledDesktop,children:(0,i.jsx)(j,{})})]})}},35087:function(e,t,r){"use strict";r.d(t,{YZ:function(){return y},bZ:function(){return C}});var i=r(31549),n=r(11139),o=r(39319),a=r(44194),s=r(48592),l=r(51865),c=r.n(l),d=r(34270),_=r(61794),u=r(55714),m=r(45269),p=r(44731),h=r(26249),b=r(24810),v=r(58117),f=r.p+"static/media/megafon.c76b00d9.svg",k=r(15159),x=r.n(k);let g="success-megafon-payment",j="fail-megafon-payment",y=()=>{let{art:e}=(0,b.G)(),t=(0,_.TL)(),{t:r}=(0,s.$G)(),l=(0,a.useRef)(""),[p,h]=(0,a.useState)(!1),[v,k]=(0,a.useState)(!1);(0,m.Z)(()=>{l.current=(0,n.Z)(),S.onSaleBlockShown(l.current)});let y=e=>{var t,r;let{response:i}=e;if(null==i?void 0:null===(t=i.actions_output)||void 0===t?void 0:t.url){S.onRedirectToProviderSide(l.current);let e=null===(r=i.actions_output)||void 0===r?void 0:r.url;setTimeout(()=>{window.location.href=e},500)}else S.onSuccessPayment(l.current)},B=()=>{k(!1),h(!0),S.onFailPayment(l.current)},C=e=>{var r,i;let{response:n}=e;if((null==n?void 0:n.status)!=="error"&&(null==n?void 0:null===(r=n.custom_set)||void 0===r?void 0:r.id)){S.onSuccessCustomSetCreation(l.current);let e=new URL(window.location.href);e.searchParams.set(j,l.current);let r=new URL(window.location.href);r.searchParams.set(g,l.current),t(_.hi.foundationUser.proceedPayment({customSet:null===(i=n.custom_set)||void 0===i?void 0:i.id,csrf:n.csrf,onSuccess:y,onError:B,failRedirectUrl:e.toString(),successRedirectUrl:r.toString()}))}else B()},N=()=>{S.onSaleBlockClick(l.current),k(!0),t(_.hi.payment.createCustomSet({arts:[e.id],onSuccess:C,onError:B}))};return(0,i.jsxs)("div",{className:c()(x().block,x().block__megafonPPD),children:[(0,i.jsx)(o.z,{text:r("Купить в один клик"),size:"large",mode:"secondary",icon:(0,i.jsx)("img",{src:f}),fullWidth:!0,onClick:N,loading:v}),(0,i.jsx)(u.Fg,{href:"/pages/litres_oferta",children:r("Условия обслуживания")}),(0,i.jsx)(d.P,{isOpen:p,isMobile:!0,mode:"error",title:"",message:r("Что-то пошло не так. Попробуйте повторить"),onClose:()=>{h(!1)},alignElRef:void 0,isFullWidth:!0,verticalAlign:"bottom",button:{label:r("Повторить"),onClick:N}})]})},B={payment_method_type:"paybyclick",payment_system:"megafone_paybyclick",integration:91,monetization_type:"ppd"},S={onSaleBlockShown:e=>{p.TM.sendEvent(["LITRES_TRACKER"],{eventType:"megafon_one_click_view",params:{purchase_trace_id:e,...B}})},onSaleBlockClick:e=>{p.TM.sendEvent(["LITRES_TRACKER"],{eventType:"payment_start",params:{purchase_trace_id:e,...B}})},onSuccessCustomSetCreation:e=>{p.TM.sendEvent(["LITRES_TRACKER"],{eventType:"click_payment_continue",params:{purchase_trace_id:e,...B}})},onSuccessPayment:e=>{p.TM.sendEvent(["LITRES_TRACKER"],{eventType:"payment_success",params:{purchase_trace_id:e,...B}})},onFailPayment:e=>{p.TM.sendEvent(["LITRES_TRACKER"],{eventType:"payment_failed",params:{purchase_trace_id:e,...B}})},onRedirectToProviderSide:e=>{p.TM.sendEvent(["LITRES_TRACKER"],{eventType:"megafon_one_click_redirect_to_provider",params:{purchase_trace_id:e,...B}})}},C=()=>{let e=(0,h.useRouter)();(0,m.Z)(()=>{let{query:t}=e;t[g]?(S.onSuccessPayment(t[g]),(0,v.Ow)(e,[g])):t[j]&&(S.onFailPayment(t[j]),(0,v.Ow)(e,[j]))})}},45002:function(e,t,r){"use strict";r.d(t,{x:function(){return f}});var i=r(31549);r(44194);var n=r(48592),o=r(39319),a=r(61794),s=r(91270),l=r(65032),c=r(31290),d=r(47668),_=r(24810),u=r(70608),m=r(73758),p=r(51738),h=r(87187),b=r(15202),v=r.n(b);let f=e=>{let{text:t}=e,{t:r}=(0,n.$G)(),b=r("Слушать фрагмент"),{art:f,bookSubPath:k}=(0,_.G)(),{scheduleEvent:x}=(0,p.G)(f),g=(0,a.CG)(e=>e.foundationUser.id),j=(0,s.useSelector)(e=>e.player.data.currentTime),y=(0,h.W)(f.id);return(0,i.jsx)(l.J,{children:e=>{let{togglePlay:r,isPlaying:n,smallIcon:a}=e;return(0,i.jsx)(o.z,{mode:"secondary",size:"small",analyticsId:n?void 0:"listen-fragment-button",onClick:e=>{e.preventDefault(),e.stopPropagation(),n||(m.TM.sendEvent(["LITRES_TRACKER"],{eventType:"listen_fragment_click",params:(0,u.Eb)({art:f})}),x({source_internal:(0,u.bu)(k)})),r(),g&&!n&&0===j&&y()},e2eId:"book-player-button__wrapper",icon:a,fullWidth:!0,text:n?(0,i.jsxs)("span",{className:v().button__text,children:[(0,i.jsx)(c.V,{})," / ",(0,i.jsx)(d.u,{})]}):(0,i.jsx)("span",{className:v().button__text,children:t||b})})}})}},61647:function(e,t,r){"use strict";r.d(t,{X:function(){return k}});var i=r(31549),n=r(44194),o=r(48592),a=r(39319),s=r(91270),l=r(61794),c=r(24810),d=r(70608),_=r(59838),u=r(18370),m=r(97439),p=r(91979);let h=()=>{var e,t;let{art:r}=(0,c.G)(),{webtoonChapterId:i,webtoonChapterFileId:a}=(0,p.a)(r),s=(0,l.CG)(e=>e.foundationUser),d=(0,l.CG)(e=>e.browser.headers["client-host"]),h=(0,l.CG)(e=>e.face.language||"ru"),{t:b}=(0,o.$G)(),v=(null===(e=r.url)||void 0===e?void 0:e.endsWith("/"))?r.url:"".concat(null!==(t=r.url)&&void 0!==t?t:"","/"),f="ru"===h?m.mW.readOnlineRu:m.mW.readOnlineGlobal;return{hrefToReadOnline:(0,n.useMemo)(()=>r.is_art_online_readable&&r.art_type===u.lG.text?"".concat(v).concat(f,"/"):void 0,[r,v,f]),hrefToRead:(0,n.useMemo)(()=>(0,_.qZ)({art:r,user:s,isLibrary:(0,_.Af)(d||""),isBookCard:!0,translator:b,lang:h,webtoonChapterId:i,webtoonChapterFileId:a}),[r,d,s,b,h,i,a])}};var b=r(73758),v=r(58749),f=r(87187);let k=e=>{let{icon:t,text:r,mode:n,size:_,isFragment:u}=e,{art:m,bookSubPath:p}=(0,c.G)(),k=(0,d.Lx)(m),{t:x}=(0,o.$G)(),g=(0,s.useDispatch)(),j=(0,l.CG)(e=>e.foundationUser.id),y=(0,f.W)(m.id),B=x(k?"Для чтения вебтуна \xab{bookName}\xbb зарегистрируйтесь или войдите":"Для чтения книги \xab{bookName}\xbb зарегистрируйтесь или войдите",{bookName:m.title}),{hrefToReadOnline:S,hrefToRead:C}=h(),N=async()=>{u?(b.TM.sendEvent(["LITRES_TRACKER"],{eventType:"read_fragment_click",params:(0,d.Eb)({art:m,extra:{source_internal:(0,d.bu)(p),art_type:(0,v.L)(m.art_type,m.is_draft),trial_flag:!0}})}),j&&await y()):b.TM.sendEvent(["LITRES_TRACKER"],{eventType:"read_click",params:(0,d.Eb)({art:m,extra:{source_internal:(0,d.bu)(p),art_type:(0,v.L)(m.art_type,m.is_draft),trial_flag:!1}})})},T=()=>{g(l.hi.global.interfaceRequests.setLoginPopupError({isOpen:!0,errorText:B}))},w=async e=>{e.preventDefault(),await N(),j||u?window.location.href=C:T()};return(0,i.jsx)("div",{children:(0,i.jsx)(a.z,{icon:t,text:r,size:_,mode:n,href:S,fullWidth:!0,onClick:w,analyticsId:m.is_free?"read-free-fragment-button":"read-fragment-button",e2eId:u?"book__fragmentReadListen--button":"saleBlock__readListen--button"})})}},99824:function(e,t,r){"use strict";r.d(t,{U:function(){return s}});var i=r(31549);r(44194);var n=r(38112),o=r(78814),a=r.n(o);let s=e=>{let{qr:t,size:r=120}=e;return t?(0,i.jsx)("img",{src:e.qr,className:a().modal__qr,alt:"qr code",loading:"lazy"}):(0,i.jsx)(n.qM,{width:r,height:r})}},31645:function(e,t,r){"use strict";r.d(t,{E:function(){return a},N:function(){return o}});var i=r(47658),n=r(93644);let o=e=>"https://click.litres.ru/1566260005?af_xp=custom&pid=Web_to_app_card&af_dp=litresread://content/b/".concat(e,"&af_click_lookback=30d&c=Card_new&is_retargeting=true&af_reengagement_window=30d"),a=async(e,t)=>{try{return await i.toDataURL(e,{errorCorrectionLevel:"M",margin:4,width:120,...t})}catch(e){return(0,n.L)("FrontendLogicError","Error generating QR code for webtoon",e).emit(),""}}},10687:function(e,t,r){"use strict";r.d(t,{X:function(){return d}});var i=r(44194),n=r(26249),o=r(59838),a=r(48592),s=r(97439),l=r(70608);let c=[{where:[s.XL.book,s.XL.podcast,s.XL.audiobook],name:"Книги",url:"/"},{where:[s.XL.podcast],name:"Подкасты",url:"/podcasts/"},{where:[s.XL.audiobook],name:"Аудиокниги",url:"/audiobooks/"}],d=(e,t,r)=>{let{t:d}=(0,a.$G)(),_=(0,n.useRouter)(),u=(0,i.useMemo)(()=>(0,l.uU)(_.asPath),[_.asPath]),m=u.subpage,p=!!m&&(0,l.s$)(m),h=!!m&&(0,l.$K)(m),b=!!m&&(0,l.D)(m),v=!!m&&(0,l.kR)(m),f=(0,l.kk)(e),k=()=>{var t;if(null===(t=e.genres)||void 0===t?void 0:t.length){let t=(0,o.xd)(e.genres[0].url);if(f){let e=s.DI.PODCAST;return t.includes("?")&&(e=e.replace("?","&")),"".concat(t).concat(e)}return t}};return(0,i.useMemo)(()=>{var i;let n=(0,l.xF)(e.persons),o=[...c.filter(e=>e.where.includes(t)).map(e=>({...e,name:d(e.name),url:e.url})),...(null===(i=e.genres)||void 0===i?void 0:i.length)?[{name:e.genres[0].name,url:k()}]:[],...n?[{name:n.full_name,url:n.url}]:[],{prefix:"\uD83D\uDCDA ",name:e.title,url:e.url}];if(p){let t=e.is_free||e.is_draft_full_free,r=u.subpageParams.page;o.push({name:"".concat(t?d("Читать онлайн бесплатно"):d("Читать онлайн")),url:"".concat(e.url).concat(u.subpage,"/")}),r>1&&o.push({name:d("Страница {page}",{page:r})})}if(h){let t=u.subpageParams.page;o.push({name:d("Отзывы"),url:"".concat(e.url).concat(u.subpage,"/")}),t>1&&o.push({name:d("Страница {page}",{page:t})})}if(b){let t=u.subpageParams.page;o.push({name:d("Цитаты"),...t>1&&{url:"".concat(e.url).concat(u.subpage,"/")}}),t>1&&o.push({name:d("Страница {page}",{page:t})})}return v&&(o.push({name:d("Все цитаты из книги"),url:"".concat(e.url).concat(s.mW.quoteList)}),o.push({name:d("Цитата")})),o.length>0&&!r&&(o[o.length-1].url=void 0),o},[e,t,u])}},71956:function(e,t,r){"use strict";r.d(t,{h:function(){return s}});var i=r(26249),n=r(44194),o=r(24810),a=r(70608);let s=e=>{let{bookSubPath:t}=(0,o.G)(),r=(0,i.useRouter)(),s=(0,a.nf)(t),l=(0,n.useMemo)(()=>({bookCardPayload:r.query.author&&r.query.bookSlug?{artType:r.pathname.split("/")[1],author:r.query.author,bookSlug:r.query.bookSlug,...t&&{subPage:a.wp.find(e=>e===t)},...r.query.quoteUuid&&{subPageUUID:r.query.quoteUuid},isBundlePurchase:e}:void 0}),[t,r.pathname,r.query.author,r.query.bookSlug,r.query.quoteUuid,e]);return(0,n.useMemo)(()=>({cameFromSource:s,cameFromSourcePayload:l}),[s,l])}},91979:function(e,t,r){"use strict";r.d(t,{a:function(){return o}});var i=r(61794),n=r(70608);let o=e=>{var t,r,o,a;let s=(0,n.Lx)(e),{data:l}=i.qL.useGetWebtoonArtTableContentQuery({artIdOrSlug:e.id,limit:100},{skip:!s}),c=null!==(a=null==l?void 0:null===(t=l[0])||void 0===t?void 0:t.is_free)&&void 0!==a&&a,d=null==l?void 0:null===(r=l[0])||void 0===r?void 0:r.id,{data:_=[]}=i.qL.useGetArtFilesQuery({artId:null!=d?d:0},{skip:!c||!d});return{isWebtoonArt:s,hasFreeChapter:c,webtoonChapterId:d,webtoonChapterFileId:null==_?void 0:null===(o=_.find(e=>{var t;return null===(t=e.encoding_type)||void 0===t?void 0:t.includes("zip")}))||void 0===o?void 0:o.id}}},17051:function(e,t,r){"use strict";r.d(t,{q:function(){return h}});var i=r(61794),n=r(59838),o=r(76791),a=r(26249),s=r(70608),l=r(88302),c=r(52805);class d{checkIfAllowedForCurrentDomain(e){return e.some(e=>e===this.currentDomain)}checkIfPartnerDomain(e){return"www.litres.ru"!==e&&((0,n._r)(e)||(0,n.f0)(e))}constructor(e){this.currentDomain=e.slice(-2),this.isPartnerDomain=this.checkIfPartnerDomain(e)}}class _{checkIfSchoolUserOrDomain(e){return!!(e.library_info.is_school_user||e.library_info.is_school_domain)}constructor(e){this.isSchoolUserOrDomain=this.checkIfSchoolUserOrDomain(e)}}class u{constructor(e){this.isMy=(0,s.Yg)(e),this.isSlonoGift=(0,s.O3)(e),this.isFourArtGift=(0,s.Bw)(e),this.isGift=(0,s.O3)(e)||(0,s.Bw)(e),this.isAutoSpeechGift=e.is_auto_speech_gift}}class m{constructor(e){this.domain=new d(e.clientHost),this.user=new _(e.user),this.art=new u(e.art)}}class p extends m{checkIfShouldShow(){return!this.isNotCorrectDomainEnvironment&&!this.isNotCorrectArtEnvironment&&!this.isNotCorrectUserEnvironment&&this.isSubscriptionTokenArt&&this.isAvailableWithSubscriptionToken&&this.isActiveSubscription}constructor(e){super(e),this.allowedDomains=["ru"];let{art:t,user:r}=e;this.isSubscriptionTokenArt=t.is_subscription_token_art,this.isAvailableWithSubscriptionToken=t.is_available_with_subscription_token,this.isActiveSubscription=!!r.subscription.is_active,this.isNotCorrectDomainEnvironment=!this.domain.checkIfAllowedForCurrentDomain(this.allowedDomains)||this.domain.isPartnerDomain,this.isNotCorrectArtEnvironment=this.art.isMy||this.art.isGift||this.art.isAutoSpeechGift,this.isNotCorrectUserEnvironment=this.user.isSchoolUserOrDomain}}let h=e=>{var t,r;let d=(0,a.useRouter)(),_=!(0,i.CG)(e=>e.browser.pda),u=(0,i.CG)(e=>e.browser.headers["client-host"]||"www.litres.ru"),m=["1","2"].includes((0,o.rb)("paper_books")),h=["1","2"].includes((null===(t=d.query.paper_books)||void 0===t?void 0:t.toString())||""),b=(0,i.CG)(e=>e.foundationUser),v=(0,n.a7)(u),{data:f}=i.qL.useGetMegafonByClickQuery({artId:e.id},{skip:!v}),k=0===b.id,x=(0,l.f)(),g=u.slice(-2),j=(0,s.i$)(g),y=(0,s.AH)(g),B=(0,s.GN)(e),S=(0,s.uT)(e),C=!k&&x&&!e.availability_with_partner_subscriptions.length,N=j&&(0,s.yo)({art:e,user:b})&&!(k&&x)&&!C,T=!(0,s.Kx)({art:e,user:b}),{hasAddMaterials:w}=i.qL.endpoints.getArtFiles.useQueryState({artId:e.id},{selectFromResult:e=>{var t,r;return{hasAddMaterials:null!==(r=null===(t=e.data)||void 0===t?void 0:t.some(e=>{let{is_additional:t}=e;return t}))&&void 0!==r&&r}}}),P=!(0,s.Th)({art:e,user:b})&&w,A=(0,s.O3)(e)||(0,s.Bw)(e),I=y&&(0,s.c_)({art:e,user:b})&&!x,G=new p({clientHost:u,art:e,user:b}).checkIfShouldShow(),R=!!(0,s.Kh)({art:e,user:b}),E=(null==f?void 0:f.payload.data.buy_available)||!1,W=0===e.my_art_status&&E&&!_&&v&&!e.is_exclusive_abonement,L=!!(0,s.P$)({art:e,user:b}),D=(0,s.N$)(e),M=!(0,n.nf)(u)&&(0,s.Rb)(e);return[{hasPPDBlock:R,hasAbonementBlock:I,hasGiftBlock:A,hasListenBlock:B,hasReadingBlock:S,hasSubscriptionBlock:N,hasSaleBlockSubscriptionTokenUsageBlock:G,hasLibraryBlock:L,hasSaleBlockForPreorder:D,hasDownloadBlock:T,hasAddMaterialsDownloadBlock:P,hasReferralBlock:M,shouldShowGracePeriodBlock:(0,s.ZI)({art:e,user:b}),hasNotificationSubscriptionBlock:(0,s.v8)(e),hasMegafonePpdBlock:W,hasPaperPPDBlock:(m||h)&&(0,c.Qp)(u)&&!!(null===(r=e.paper_book)||void 0===r?void 0:r.referral_link)},["hasGiftBlock","hasAbonementBlock","hasSubscriptionBlock","hasSaleBlockSubscriptionTokenUsageBlock","shouldShowGracePeriodBlock","hasLibraryBlock","hasPPDBlock","hasMegafonePpdBlock","hasPaperPPDBlock"]]}},87187:function(e,t,r){"use strict";r.d(t,{W:function(){return n}});var i=r(61794);let n=e=>{let t=(0,i.CG)(e=>e.browser.headers);return new i.cf.Foundation({url:"/api/arts/".concat(e,"/track-trial-fragment-read"),provider:{id:"track-trial"},headers:{...t,"app-id":"115"},request:{method:"PUT"}}).fetch}},93644:function(e,t,r){"use strict";r.d(t,{L:function(){return i}});let i=r(25868).mz.feature("BookCard")},36278:function(e,t,r){"use strict";r.d(t,{C:function(){return l}});var i=r(31549),n=r(51865),o=r.n(n),a=r(3015),s=r.n(a);let l=e=>{let{className:t,text:r,size:n="medium",type:a="primary"}=e;return(0,i.jsx)("div",{className:o()(t,s().badge,{[s().secondary]:"secondary"===a,[s().small]:"small"===n}),children:r})}},73385:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var i=r(61794),n=r(44194),o=r(15381),a=r(42982),s=r(34390);function l(){let e=(0,o.t)(),t=function(){let{data:e=[]}=i.Bh.useGetSubscriptionPricesQuery({subscriptionType:14});return(0,n.useMemo)(()=>new s.S(e),[e])}(),r=i.Bh.useGetUserSubscriptionsInfoQuery(null,{skip:!e}),l=(0,n.useMemo)(()=>r.data&&Object.keys(r.data).length?r.data:null,[r.data]),c=(0,n.useMemo)(()=>new a.M(l,t),[l,t]);return{...r,data:c}}},12169:function(e,t,r){"use strict";r.d(t,{Y:function(){return c}});var i=r(61794),n=r(76791),o=r(13920),a=r.n(o),s=r(26249);let l=["control","buttons-short-info","widgets-detailed-info-collapsible","widgets-detailed-info"],c={useExperimentGroupName:function(e){let{query:t}=(0,s.useRouter)(),r=(0,i.CG)(e=>e.foundationUser),o=(0,i.CG)(e=>e.face.language),c=(0,i.CG)(e=>e.browser.pda),d=(0,n.rb)("bookcard_saleblock"),_=Number(t["bookcard-saleblock"])||Number(d);if(a()(_)||(_=0),!function(e){let{bookCardSaleBlockParams:t,foundationUser:r,art:i,faceLanguage:n,isPDA:o}=e;return"ru"===n&&!o&&!1!==function(e){let{subscription:t,abonement:r,library_info:i}=e,n=(null==i?void 0:i.is_library_user)||(null==i?void 0:i.is_school_user);return!t.is_active&&!r.is_active&&!n}(r)&&!t.hasGiftBlock&&!t.hasListenBlock&&!t.hasReadingBlock&&!t.hasLibraryBlock&&!t.hasDownloadBlock&&!t.hasMegafonePpdBlock&&!i.is_free&&!i.is_draft&&!i.is_exclusive_abonement&&1===i.availability}({bookCardSaleBlockParams:e.saleBlockParams,art:e.art,faceLanguage:o,foundationUser:r,isPDA:c}))return l["0"];let u=l[_],m=e.saleBlockParams.hasPPDBlock&&!e.saleBlockParams.hasAbonementBlock&&!e.saleBlockParams.hasSubscriptionBlock&&!e.saleBlockParams.hasPaperPPDBlock;return"widgets-detailed-info-collapsible"===u&&m&&(u="widgets-detailed-info"),u}}},39169:function(e,t,r){"use strict";r.d(t,{S:function(){return o}});var i=r(44194);class n{static get allAvailablePlanIds(){return Array.from(new Set([...this.spectrumPlanIds,...this.bookshelfPlanIds]))}static isSpectrumPlan(e){return this.spectrumPlanIds.includes(e)}static isBookshelfPlan(e){return this.bookshelfPlanIds.includes(e)}static isSubscriptionPlanId(e){return this.allAvailablePlanIds.includes(e)}static filterPlanIdsByActiveExperiment(e,t){let{isSpectrum:r,isBookshelf:i}=t;return r?e.filter(e=>n.isSpectrumPlan(e)):i?e.filter(e=>n.isBookshelfPlan(e)):[]}static sortPlanIdsByActiveExperimentOrder(e,t){let r=[],i=n.spectrumPlanIds;for(let o of(t.isBookshelf&&(i=n.bookshelfPlanIds),i))e.includes(o)&&r.push(o);return r}static filterAndSortPlansByExperiment(e,t){let r=this.filterPlanIdsByActiveExperiment(e,t.experiments);return t.areNeedSortByActiveExperimentOrder?this.sortPlanIdsByActiveExperimentOrder(e,t.experiments):r}}function o(e,t){let{experiments:r,anySubscriptionPlanIds:o,areNeedCheckPlanIds:a=!0,areNeedSortByActiveExperimentOrder:s=!1}=t,l=(0,i.useMemo)(()=>a?n.filterAndSortPlansByExperiment(o,{experiments:r,areNeedSortByActiveExperimentOrder:s}):o,[o,r,a,s]);return e.excludePlansByIds(l),l}n.optimalPlanId=24,n.spectrumPlanIds=[300,n.optimalPlanId,301],n.bookshelfPlanIds=[302,n.optimalPlanId,303]},52613:function(e,t,r){"use strict";r.d(t,{N6:function(){return d},TN:function(){return _}});var i=r(44194),n=r(26249),o=r(61794);let a="basic_maximum_plans",s="easy_bookshelf_plans";class l{setActiveExperiment(e){this.experiments.set(e,!0)}getActiveExperiments(){return Object.fromEntries(this.experiments.entries())}checkIfLeastOneActive(){return Array.from(this.experiments.values()).some(Boolean)}checkIfOnlyOneActive(){return 1===Array.from(this.experiments.values()).filter(e=>e).length}constructor(){this.experiments=new Map,this.experiments.set("isSpectrum",!1).set("isBookshelf",!1)}}var c=r(39169);function d(e,t){e.setSpecificTariffGroupStrategy(t.experiments);let r=(0,c.S)(e,{experiments:t.experiments,anySubscriptionPlanIds:t.planIds,areNeedCheckPlanIds:!1});return{experiments:t.experiments,planIds:r}}function _(e){return function(e){let t=function(){let e=(0,i.useRef)(new l),t=(0,n.useRouter)(),r=(0,i.useRef)(!!t.query[a]),c=(0,i.useRef)(!!t.query[s]),d=(0,o.CG)(e=>e.foundationUser.varioqubTests.flags);return("true"===d[a]||r.current)&&e.current.setActiveExperiment("isSpectrum"),("true"===d[s]||c.current)&&e.current.setActiveExperiment("isBookshelf"),e}();return e.setSpecificTariffGroupStrategy(t.current.getActiveExperiments()),{isShowingSubscriptionPlans:t.current.checkIfLeastOneActive(),experiments:t.current.getActiveExperiments()}}(e)}},88396:function(e,t,r){"use strict";r.d(t,{MJ:function(){return o},Vl:function(){return a},WB:function(){return i},wN:function(){return n}});let i="800 000",n="".concat(i,"+"),o="".concat(n," аудиокниг, книг и подкастов из каталога Литрес"),a=[{iconName:"star",title:o},{iconName:"discount",title:"Скидка до 30% на бумажные книги в сети магазинов ”Читай город” и на Литрес из платного каталога"},{iconName:"sync",title:"Переключайтесь с текста на аудио в любой момент"},{iconName:"noInternet",title:"Читайте и слушайте без интернета"}]},88302:function(e,t,r){"use strict";r.d(t,{f:function(){return o}});var i=r(59838),n=r(61794);let o=()=>{let e=(0,n.CG)(e=>e.browser.headers["client-host"]);return"www.litres.ru"!==e&&((0,i._r)(e)||(0,i.f0)(e))}},31290:function(e,t,r){"use strict";r.d(t,{V:function(){return a}});var i=r(31549);r(44194);var n=r(91270),o=r(6492);let a=()=>{let e=(0,n.useSelector)(e=>e.player.data.currentTime);return(0,i.jsx)(i.Fragment,{children:(0,o.Fw)(e)})}},47668:function(e,t,r){"use strict";r.d(t,{u:function(){return a}});var i=r(31549);r(44194);var n=r(91270),o=r(6492);let a=()=>{let e=(0,n.useSelector)(e=>{var t;return(null===(t=e.player.data.playerData)||void 0===t?void 0:t.duration)||0});return(0,i.jsx)(i.Fragment,{children:(0,o.Fw)(e)})}},65032:function(e,t,r){"use strict";r.d(t,{J:function(){return l}});var i=r(31549),n=r(91270),o=r(44194),a=r(4438),s=r(97108);let l=e=>{let{children:t}=e,r=(0,s.C)(),{isPlaying:l=!1,url:c=""}=(0,n.useSelector)(e=>e.player.data.playerSettings),d=(0,o.useMemo)(()=>(0,i.jsx)(a.uQ,{name:l?"pause":"play",size:16}),[l]),_=(0,o.useMemo)(()=>(0,i.jsx)(a.uQ,{name:l?"pause":"play",size:24}),[l]);return t({...r,url:c,isPlaying:l,smallIcon:d,icon:_})}},97108:function(e,t,r){"use strict";r.d(t,{a:function(){return h},C:function(){return p}});var i=r(31549),n=r(44194),o=r(59838),a=r(91270),s=r(61794),l=r(62094),c=r(11033),d=r(6492);let _=e=>{let{playbackRate:t}=(0,s.CG)(e=>e.player.data.playerSettings),r=(0,s.TL)(),i=(0,s.CG)(e=>e.foundationUser),o=(0,n.useRef)(!1),[a]=(0,l._)(d.S_,null),c=i.id?null==a?void 0:a.playbackRate:null,{data:_,isError:u}=s.K.useGetSettingsQuery(e,{skip:!i.id||!!c}),[m]=s.K.useSetSettingsMutation();return(0,n.useEffect)(()=>{if(!o.current){if(null==_?void 0:_.art_playback_speed.length){let e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.TC,r=t[0],i=Math.abs(e-r.value);for(let n=1;n<t.length;n++){let o=Math.abs(e-t[n].value);if(o<i)r=t[n],i=o;else break}return r.value}(_.art_playback_speed[0].speed);r(s.hi.player.data.setPlaybackRate(e))}c&&r(s.hi.player.data.setPlaybackRate(c)),u&&r(s.hi.player.data.setPlaybackRate(1))}},[_,r,u]),{playbackRate:t,setPlaybackRate:t=>{r(s.hi.player.data.setPlaybackRate(t)),o.current=!0,i.id&&m({artId:e,speed:t})},savedRate:c}},u={play:o.ZT,pause:o.ZT,togglePlay:o.ZT,updatePlayerUrl:o.ZT,updateContents:o.ZT,toggleContents:o.ZT,closeContents:o.ZT,toggleMute:o.ZT,updateVolume:o.ZT,updateRate:o.ZT},m=(0,n.createContext)(u),p=()=>(0,n.useContext)(m),h=e=>{let{children:t,artId:r}=e,o=(0,a.useDispatch)(),{checkCanPlayStatus:u}=(0,c.j)(),{volume:p,muted:h,isContentsOpen:b,readOnly:v,isAnon:f}=(0,a.useSelector)(e=>e.player.data.playerSettings),{setPlaybackRate:k}=_(r),x=(0,a.useSelector)(e=>{var t;return null===(t=e.player.data.playerData)||void 0===t?void 0:t.isHalf}),[,g]=(0,l._)(d.rx,!1),j=(0,n.useCallback)(()=>{u(!!v,!!x,!!f)&&o(s.hi.player.data.setPlaying(!0)),f&&g(!0)},[u,o,f,x,v,g]),y=(0,n.useCallback)(()=>{o(s.hi.player.data.setPlaying(!1)),f&&g(!1)},[o,f,g]),B=(0,a.useStore)(),S=(0,n.useCallback)(()=>{B.getState().player.data.playerSettings.isPlaying?y():j()},[y,j,B]);return(0,i.jsx)(m.Provider,{value:{play:j,pause:y,togglePlay:S,updatePlayerUrl:e=>{o(s.hi.player.data.setUrl(e)),j()},updateContents:e=>{o(s.hi.player.data.setContentsData(e))},toggleMute:()=>{h?(0===Number(p)&&o(s.hi.player.data.setVolume(.5)),o(s.hi.player.data.setMuted(!1))):o(s.hi.player.data.setMuted(!0))},updateVolume:e=>{let t=e;e<=0?(t=0,o(s.hi.player.data.setMuted(!0))):o(s.hi.player.data.setMuted(!1)),e>=1&&(t=1),o(s.hi.player.data.setVolume(t))},closeContents:()=>{o(s.hi.player.data.setContentsOpen(!1))},toggleContents:()=>{o(s.hi.player.data.setContentsOpen(!b))},updateRate:e=>{k(e)}},children:t})}},11033:function(e,t,r){"use strict";r.d(t,{j:function(){return d},o:function(){return _}});var i=r(31549),n=r(44194),o=r(59838),a=r(61794),s=r(6492);let l={onDownloadClickEv:o.ZT,onPlayingEndedEv:o.ZT,onChapterSelectEv:o.ZT,onUpdateStateEv:o.ZT,onUpdateNotes:o.ZT,checkCanPlayStatus:()=>!1},c=(0,n.createContext)(l),d=()=>(0,n.useContext)(c),_=e=>{let{children:t,playerCallbacks:{onDownloadClickEv:r=o.ZT,onPlayingEndedEv:l=o.ZT,showAnonError:d=o.ZT,onHalfFragmentEv:_=o.ZT,onChapterSelectEv:u=o.ZT,onUpdateStateEv:m,onPlayButtonClick:p,onPaused:h}}=e,b=(0,a.TL)(),v=(0,n.useRef)(0),{url:f="",contentsData:k=[],isAnon:x,readOnly:g}=(0,a.CG)(e=>e.player.data.playerSettings),j=(0,n.useCallback)(()=>{b(a.hi.player.notes.lockAudioNotes(null))},[b]),y=(0,n.useCallback)((e,t,r)=>{if(r){if(e&&t)return _(),b(a.hi.player.data.setPlaying(!1)),b(a.hi.player.data.setContentsOpen(!1)),!1;if(!e)return d(),b(a.hi.player.data.setPlaying(!1)),b(a.hi.player.data.setContentsOpen(!1)),!1}return!r||e},[b,_,d]),B=(0,n.useCallback)(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];y(!!g,!1,!!x)&&!g&&(u(...t),j())},[y,x,u,j,g]);return(0,i.jsx)(c.Provider,{value:{onChapterSelectEv:B,onDownloadClickEv:r,onPlayingEndedEv:l,onPlayButtonClick:p,onPaused:h,onUpdateNotes:()=>{b(a.hi.player.notes.lockAudioNotes(null))},onUpdateStateEv:(e,t)=>{if(m){let{currentIndex:r}=(0,s.tL)(k,f),i=Number(k.reduce((e,t,i)=>Number(e)+t.duration*Number((null!=r?r:0)>i),0))+t,n=0;(e>0&&e<10||e-v.current>=10)&&(n=10*Math.ceil((e-v.current)/10),v.current+=n),n&&m(i,n),b(a.hi.player.data.setPlayerStats({hits:n,secondsListened:i}))}b(a.hi.player.notes.lockAudioNotes(null))},checkCanPlayStatus:y},children:t})}},6492:function(e,t,r){"use strict";r.d(t,{Fw:function(){return d},Iv:function(){return o},S_:function(){return a},TC:function(){return n},TT:function(){return m},VJ:function(){return v},jX:function(){return _},rq:function(){return i},rx:function(){return l},tL:function(){return p},vL:function(){return u},vV:function(){return s},xk:function(){return b}});let i=15,n=[{value:.75,label:"0,75x"},{value:1,label:"1x"},{value:1.25,label:"1,25x"},{value:1.5,label:"1,5x"},{value:1.75,label:"1,75x"},{value:2,label:"2x"},{value:2.25,label:"2,25x"},{value:2.5,label:"2,5x"}],o=e=>{var t;return(null===(t=n.find(t=>t.value===e))||void 0===t?void 0:t.label)||""},a="player-settings-cache",s="player-time-cache",l="player-playing-cache",c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=24*Math.floor(e/86400)+Math.floor(e/3600%24),r=Math.floor(e/60%60),i=Math.floor(e%60);return{hours:t<10?"0".concat(t):"".concat(t),minutes:r<10?"0".concat(r):"".concat(r),seconds:i<10?"0".concat(i):"".concat(i)}},d=e=>{let{hours:t,minutes:r,seconds:i}=c(e),n=Number(t);return 0===n?"".concat(r,":").concat(i):"".concat(n,":").concat(r,":").concat(i)},_=e=>{let{hours:t,minutes:r,seconds:i}=c(e);return"".concat(t,":").concat(r,":").concat(i)},u=(e,t)=>{let r=String(e).split("");return r.length>t&&r.splice(t),r.length<t&&(r=Array.from({length:t-r.length}).fill("0").concat(r)),r.join("")},m=e=>{let t=e.match(/^(?:https?:\/\/[^/]+)?\/[^/]+\/([^/]+)/);return t?Number(t[1]):0},p=(e,t)=>{for(let r=0;r<e.length;r++){let i=e[r];if(t===i.url||m(t)===i.fileId)return{current:i,next:e[r+1],prev:e[r-1],currentIndex:r}}return{currentIndex:-1}},h=[200,330,415],b=e=>{let t=[];for(let r of h)t.push({src:"https://cdn.litres.ru/pub/c/cover_".concat(r,"/").concat(e.id,".webp"),type:"image/webp",sizes:"".concat(r,"x").concat(r)},{src:"https://cdn.litres.ru/pub/c/cover_".concat(r,"/").concat(e.id,".jpg"),type:"image/jpeg",sizes:"".concat(r,"x").concat(r)});return t},v=e=>{var t;return(null===(t=e.persons)||void 0===t?void 0:t.map(e=>e.full_name).join(", "))||""}},17385:function(e,t,r){"use strict";r.d(t,{D:function(){return o},J:function(){return n}});var i=r(7956);let n="Почта должна быть формата ivan.ivanovich@mail.ru",o=e=>!!e&&(0,i.Z_)().email().isValidSync(e)},57628:function(e,t,r){"use strict";r.d(t,{U:function(){return _}});var i=r(31549),n=r(44194),o=r(51865),a=r.n(o),s=r(4438),l=r(99442),c=r.n(l);let d=e=>{let{children:t}=e;return(0,i.jsx)("div",{className:c().accordion,children:n.Children.map(t,e=>n.isValidElement(e)?n.cloneElement(e,{}):e)})};d.Item=e=>{let{title:t,children:r,classes:o={},manualToggleSettings:l,isOpenedByDefault:d=!1,chevronPosition:_="right",withCollapsingLogic:u=!0}=e,[m,p]=(0,n.useState)(d),h=()=>{p(!m)},b=l?l.isActive:m;return(0,i.jsxs)("div",{className:a()(c().accordion__item,null==o?void 0:o.root,{[c().notCollapsible]:!u}),onClick:function(e){u&&(l?l.onClick(e):h())},children:[(0,i.jsxs)("div",{className:a()(c().accordion__item__Header,{[c().accordion__item__Header_reverseOrder]:"left"===_}),children:[(0,i.jsx)("div",{className:a()(c().accordion__item__Title,o.title),"data-testid":"accordionItem__title",children:t}),(0,i.jsx)(s.uQ,{name:b?"chevronUp":"chevronDown",className:a()(c().chevronIcon,o.chevronIcon),size:16})]}),b&&(0,i.jsx)("div",{className:a()(c().accordion__item__Content,o.content),"data-testid":"accordionItem__content",children:r})]})};var _=d},81173:function(e){e.exports={policy:"AdultModal-module__ZDN05q__policy",description:"AdultModal-module__ZDN05q__description",adult:"AdultModal-module__ZDN05q__adult",head:"AdultModal-module__ZDN05q__head",img:"AdultModal-module__ZDN05q__img",title:"AdultModal-module__ZDN05q__title",buttons:"AdultModal-module__ZDN05q__buttons"}},77507:function(e){e.exports={link:"HubLink-module__9uWSwq__link",title:"HubLink-module__9uWSwq__title",wrapper:"HubLink-module__9uWSwq__wrapper",text:"HubLink-module__9uWSwq__text"}},28673:function(e){e.exports={tag:"Tag-module__NnkeEa__tag"}},97237:function(e){e.exports={materials:"AddMaterialsDownloadButton-module__wrm5eq__materials",materials__line:"AddMaterialsDownloadButton-module__wrm5eq__materials__line"}},17090:function(e){e.exports={author__subscribers__icon:"BookAuthor-module__BNjfGG__author__subscribers__icon",author__subscribeAction:"BookAuthor-module__BNjfGG__author__subscribeAction",author:"BookAuthor-module__BNjfGG__author",author__name:"BookAuthor-module__BNjfGG__author__name",author__number:"BookAuthor-module__BNjfGG__author__number",author__avatar:"BookAuthor-module__BNjfGG__author__avatar",text_capitalize:"BookAuthor-module__BNjfGG__text_capitalize",authors:"BookAuthor-module__BNjfGG__authors",author__info:"BookAuthor-module__BNjfGG__author__info",author__subscribers:"BookAuthor-module__BNjfGG__author__subscribers"}},19586:function(e){e.exports={banner_bookPages:"BookBanner-module__02ZJZW__banner_bookPages",banner__icon:"BookBanner-module__02ZJZW__banner__icon",banner:"BookBanner-module__02ZJZW__banner",banner_type_orange:"BookBanner-module__02ZJZW__banner_type_orange",banner__title:"BookBanner-module__02ZJZW__banner__title",banner_type_blue:"BookBanner-module__02ZJZW__banner_type_blue",banner__text:"BookBanner-module__02ZJZW__banner__text",banner_type_red:"BookBanner-module__02ZJZW__banner_type_red"}},62725:function(e){e.exports={reviews:"BookFactoids-module__y0n0IG__reviews",quotations:"BookFactoids-module__y0n0IG__quotations",rating:"BookFactoids-module__y0n0IG__rating",secondary:"BookFactoids-module__y0n0IG__secondary",factoids__item:"BookFactoids-module__y0n0IG__factoids__item",section:"BookFactoids-module__y0n0IG__section",block_bookPages:"BookFactoids-module__y0n0IG__block_bookPages",grey:"BookFactoids-module__y0n0IG__grey",block:"BookFactoids-module__y0n0IG__block",green:"BookFactoids-module__y0n0IG__green",primary:"BookFactoids-module__y0n0IG__primary",icon:"BookFactoids-module__y0n0IG__icon"}},22589:function(e){e.exports={count_value:"RatingLiveLibPopup-module__m1A8iW__count_value",header:"RatingLiveLibPopup-module__m1A8iW__header",filled:"RatingLiveLibPopup-module__m1A8iW__filled",rating:"RatingLiveLibPopup-module__m1A8iW__rating",inside_arrow:"RatingLiveLibPopup-module__m1A8iW__inside_arrow",star_small:"RatingLiveLibPopup-module__m1A8iW__star_small",count:"RatingLiveLibPopup-module__m1A8iW__count",stars_row:"RatingLiveLibPopup-module__m1A8iW__stars_row",filling:"RatingLiveLibPopup-module__m1A8iW__filling",count_text:"RatingLiveLibPopup-module__m1A8iW__count_text",stars_block:"RatingLiveLibPopup-module__m1A8iW__stars_block",footer:"RatingLiveLibPopup-module__m1A8iW__footer",total:"RatingLiveLibPopup-module__m1A8iW__total",title:"RatingLiveLibPopup-module__m1A8iW__title",wrapper:"RatingLiveLibPopup-module__m1A8iW__wrapper",inside:"RatingLiveLibPopup-module__m1A8iW__inside"}},19327:function(e){e.exports={title:"BookGenresAndTags-module___lt2qq__title",genresList:"BookGenresAndTags-module___lt2qq__genresList",genresList__item:"BookGenresAndTags-module___lt2qq__genresList__item",genresList__tags:"BookGenresAndTags-module___lt2qq__genresList__tags",genresList__button:"BookGenresAndTags-module___lt2qq__genresList__button"}},31643:function(e){e.exports={innerFunctionalBlock__item:"BookInnerFunctionalBlock-module__lyHu1a__innerFunctionalBlock__item",innerFunctionalBlock:"BookInnerFunctionalBlock-module__lyHu1a__innerFunctionalBlock"}},5665:function(e){e.exports={button__cover:"BookOtherVersions-module__AkWn8q__button__cover",button__title:"BookOtherVersions-module__AkWn8q__button__title",button__cover__img:"BookOtherVersions-module__AkWn8q__button__cover__img",button:"BookOtherVersions-module__AkWn8q__button",button__side:"BookOtherVersions-module__AkWn8q__button__side",button__subtitle:"BookOtherVersions-module__AkWn8q__button__subtitle",button__cover__wrapper:"BookOtherVersions-module__AkWn8q__button__cover__wrapper",target:"BookOtherVersions-module__AkWn8q__target"}},74369:function(e){e.exports={linkedArt__reader:"BookOtherVersionsModal-module__6__37q__linkedArt__reader",linkedArt__price__label:"BookOtherVersionsModal-module__6__37q__linkedArt__price__label",linkedArt__price_final:"BookOtherVersionsModal-module__6__37q__linkedArt__price_final",container:"BookOtherVersionsModal-module__6__37q__container",linkedArt__cover__wrapper:"BookOtherVersionsModal-module__6__37q__linkedArt__cover__wrapper",linkedArt:"BookOtherVersionsModal-module__6__37q__linkedArt",version:"BookOtherVersionsModal-module__6__37q__version",linkedArt__info:"BookOtherVersionsModal-module__6__37q__linkedArt__info",linkedArt__label:"BookOtherVersionsModal-module__6__37q__linkedArt__label",syncBlock__title:"BookOtherVersionsModal-module__6__37q__syncBlock__title",syncBlock__text:"BookOtherVersionsModal-module__6__37q__syncBlock__text",syncBlock__icon:"BookOtherVersionsModal-module__6__37q__syncBlock__icon",syncBlock__title__wrapper:"BookOtherVersionsModal-module__6__37q__syncBlock__title__wrapper",linkedArt__title:"BookOtherVersionsModal-module__6__37q__linkedArt__title",syncBlock:"BookOtherVersionsModal-module__6__37q__syncBlock",linkedArt__price:"BookOtherVersionsModal-module__6__37q__linkedArt__price",version__title:"BookOtherVersionsModal-module__6__37q__version__title",linkedArt__cover:"BookOtherVersionsModal-module__6__37q__linkedArt__cover",linkedArt__price_full:"BookOtherVersionsModal-module__6__37q__linkedArt__price_full"}},71351:function(e){e.exports={bookReadOnline:"BookReadOnline-module__Ez3-2G__bookReadOnline"}},96007:function(e){e.exports={seeAllBlock:"BookRecommendations-module__0WXuyW__seeAllBlock",seeAllBlock_mobile:"BookRecommendations-module__0WXuyW__seeAllBlock_mobile",title:"BookRecommendations-module__0WXuyW__title",art:"BookRecommendations-module__0WXuyW__art",firstArt:"BookRecommendations-module__0WXuyW__firstArt",margLeft:"BookRecommendations-module__0WXuyW__margLeft",wrapper:"BookRecommendations-module__0WXuyW__wrapper"}},23050:function(e){e.exports={seriesWrapper__secondaryInfo:"BookSeries-module__oV63CG__seriesWrapper__secondaryInfo",seriesWrapper__description:"BookSeries-module__oV63CG__seriesWrapper__description",cover:"BookSeries-module__oV63CG__cover",discount:"BookSeries-module__oV63CG__discount",seriesSlide:"BookSeries-module__oV63CG__seriesSlide",img:"BookSeries-module__oV63CG__img",serialNumber:"BookSeries-module__oV63CG__serialNumber",seriesCaption:"BookSeries-module__oV63CG__seriesCaption",seriesWrapper__secondaryInfo__block:"BookSeries-module__oV63CG__seriesWrapper__secondaryInfo__block",seriesWrapper__slider:"BookSeries-module__oV63CG__seriesWrapper__slider",innerSerialNumber:"BookSeries-module__oV63CG__innerSerialNumber",highlighted:"BookSeries-module__oV63CG__highlighted",seriesWrapper__title:"BookSeries-module__oV63CG__seriesWrapper__title",seriesWrapper__slide:"BookSeries-module__oV63CG__seriesWrapper__slide",seriesWrapper:"BookSeries-module__oV63CG__seriesWrapper"}},24553:function(e){e.exports={bookTableContent:"BookTableContent-module__4zmRYG__bookTableContent",chapter_secondDeep:"BookTableContent-module__4zmRYG__chapter_secondDeep",grayButton:"BookTableContent-module__4zmRYG__grayButton",popoverTableContent:"BookTableContent-module__4zmRYG__popoverTableContent",chapter_firstDeep:"BookTableContent-module__4zmRYG__chapter_firstDeep",button__icon:"BookTableContent-module__4zmRYG__button__icon",modalContainer:"BookTableContent-module__4zmRYG__modalContainer",button:"BookTableContent-module__4zmRYG__button",buttonTableContentWrapper:"BookTableContent-module__4zmRYG__buttonTableContentWrapper",button__icon_accent:"BookTableContent-module__4zmRYG__button__icon_accent"}},43764:function(e){e.exports={subText:"BoughtBookLine-module__lDqAcG__subText",icon:"BoughtBookLine-module__lDqAcG__icon",textBlock:"BoughtBookLine-module__lDqAcG__textBlock",boughtBookLine:"BoughtBookLine-module__lDqAcG__boughtBookLine"}},31530:function(e){e.exports={characteristic:"CharacteristicsBlock-module__6QUqXW__characteristic",characteristic__title:"CharacteristicsBlock-module__6QUqXW__characteristic__title",wrapper:"CharacteristicsBlock-module__6QUqXW__wrapper",fileFormat__link:"CharacteristicsBlock-module__6QUqXW__fileFormat__link",characteristic__link:"CharacteristicsBlock-module__6QUqXW__characteristic__link",characteristic__files:"CharacteristicsBlock-module__6QUqXW__characteristic__files",separator:"CharacteristicsBlock-module__6QUqXW__separator",fileFormat:"CharacteristicsBlock-module__6QUqXW__fileFormat",characteristics:"CharacteristicsBlock-module__6QUqXW__characteristics"}},92244:function(e){e.exports={buttonWrapper_withBottomMargin:"DeepLinkToAppButton-module__arK42W__buttonWrapper_withBottomMargin",buttonWrapper:"DeepLinkToAppButton-module__arK42W__buttonWrapper"}},96881:function(e){e.exports={downloadButton:"DownloadButton-module__f_hGpq__downloadButton",downloadButton__link:"DownloadButton-module__f_hGpq__downloadButton__link"}},43510:function(e){e.exports={actionBar__bottomSheet__item:"ActionBar-module__G8CmEG__actionBar__bottomSheet__item",actionBar__subMenu__icon:"ActionBar-module__G8CmEG__actionBar__subMenu__icon",actionBar__modalContainer:"ActionBar-module__G8CmEG__actionBar__modalContainer",actionBar__bottomSheet:"ActionBar-module__G8CmEG__actionBar__bottomSheet",actionBar__subMenu:"ActionBar-module__G8CmEG__actionBar__subMenu",actionBar:"ActionBar-module__G8CmEG__actionBar",actionBar__mobile:"ActionBar-module__G8CmEG__actionBar__mobile"}},87203:function(e){e.exports={modalContainer:"FunctionalBlock-module__-TV2SW__modalContainer",share:"FunctionalBlock-module__-TV2SW__share",disabledPda:"FunctionalBlock-module__-TV2SW__disabledPda",buttonTableContentWrapper:"FunctionalBlock-module__-TV2SW__buttonTableContentWrapper",button__icon:"FunctionalBlock-module__-TV2SW__button__icon",finishButton__mark:"FunctionalBlock-module__-TV2SW__finishButton__mark",container_bookPages:"FunctionalBlock-module__-TV2SW__container_bookPages",breadcrumbs:"FunctionalBlock-module__-TV2SW__breadcrumbs",hubLink:"FunctionalBlock-module__-TV2SW__hubLink",icon:"FunctionalBlock-module__-TV2SW__icon",button__icon_accent:"FunctionalBlock-module__-TV2SW__button__icon_accent",container:"FunctionalBlock-module__-TV2SW__container",button:"FunctionalBlock-module__-TV2SW__button",finishButton__unmark:"FunctionalBlock-module__-TV2SW__finishButton__unmark",finishButton:"FunctionalBlock-module__-TV2SW__finishButton",finishButton_gray:"FunctionalBlock-module__-TV2SW__finishButton_gray",button__icon_green:"FunctionalBlock-module__-TV2SW__button__icon_green",hideOnPDA:"FunctionalBlock-module__-TV2SW__hideOnPDA",button_adaptive:"FunctionalBlock-module__-TV2SW__button_adaptive",breadcrumbsBookPages:"FunctionalBlock-module__-TV2SW__breadcrumbsBookPages",button_bookPages:"FunctionalBlock-module__-TV2SW__button_bookPages",share__text:"FunctionalBlock-module__-TV2SW__share__text",button__icon_big:"FunctionalBlock-module__-TV2SW__button__icon_big",popoverTableContent:"FunctionalBlock-module__-TV2SW__popoverTableContent",banner_bookPages:"FunctionalBlock-module__-TV2SW__banner_bookPages",disabledDesktop:"FunctionalBlock-module__-TV2SW__disabledDesktop",actionBarDesktopWrap:"FunctionalBlock-module__-TV2SW__actionBarDesktopWrap",banner:"FunctionalBlock-module__-TV2SW__banner",button__text_showOnlyPDA:"FunctionalBlock-module__-TV2SW__button__text_showOnlyPDA"}},79988:function(e){e.exports={notificationSubscription__subscribe:"NotificationSubscription-module__KNycMW__notificationSubscription__subscribe",description:"NotificationSubscription-module__KNycMW__description",notificationSubscription__unsubscribe:"NotificationSubscription-module__KNycMW__notificationSubscription__unsubscribe",error:"NotificationSubscription-module__KNycMW__error",notificationSubscription__wrapper_isAnon:"NotificationSubscription-module__KNycMW__notificationSubscription__wrapper_isAnon",title:"NotificationSubscription-module__KNycMW__title",email:"NotificationSubscription-module__KNycMW__email",button:"NotificationSubscription-module__KNycMW__button"}},15159:function(e){e.exports={block__price__discount__label:"SaleBlock-module__DK06XW__block__price__discount__label",referralBlock__info:"SaleBlock-module__DK06XW__referralBlock__info",block__partnerSubscriptions:"SaleBlock-module__DK06XW__block__partnerSubscriptions",icon:"SaleBlock-module__DK06XW__icon",alert:"SaleBlock-module__DK06XW__alert",saleBlockPartnerSubGracePeriod:"SaleBlock-module__DK06XW__saleBlockPartnerSubGracePeriod",title:"SaleBlock-module__DK06XW__title",referralBlock__content:"SaleBlock-module__DK06XW__referralBlock__content",fourArtsGift__countdown:"SaleBlock-module__DK06XW__fourArtsGift__countdown",detailedReceipt__row:"SaleBlock-module__DK06XW__detailedReceipt__row",bundleBlock__title:"SaleBlock-module__DK06XW__bundleBlock__title",bundleBlock__priceWrapper:"SaleBlock-module__DK06XW__bundleBlock__priceWrapper",withDetailedInfoWidget:"SaleBlock-module__DK06XW__withDetailedInfoWidget",button:"SaleBlock-module__DK06XW__button",block__price:"SaleBlock-module__DK06XW__block__price",exclusiveAbonement__icon:"SaleBlock-module__DK06XW__exclusiveAbonement__icon",price__caption:"SaleBlock-module__DK06XW__price__caption",bundleBlock:"SaleBlock-module__DK06XW__bundleBlock",bundleBlock__newPrice:"SaleBlock-module__DK06XW__bundleBlock__newPrice",referralBlock__title:"SaleBlock-module__DK06XW__referralBlock__title",block__price__inner:"SaleBlock-module__DK06XW__block__price__inner",ppdButton:"SaleBlock-module__DK06XW__ppdButton",experimental:"SaleBlock-module__DK06XW__experimental",saleBlockInfo:"SaleBlock-module__DK06XW__saleBlockInfo",block:"SaleBlock-module__DK06XW__block",giftModal__title:"SaleBlock-module__DK06XW__giftModal__title",block__price__default:"SaleBlock-module__DK06XW__block__price__default",saleBlockPartnerSubGracePeriod__partner:"SaleBlock-module__DK06XW__saleBlockPartnerSubGracePeriod__partner",block__price__with_bonus:"SaleBlock-module__DK06XW__block__price__with_bonus",block_caption:"SaleBlock-module__DK06XW__block_caption",logo:"SaleBlock-module__DK06XW__logo",cost:"SaleBlock-module__DK06XW__cost",saleBlockNotificationSubscription:"SaleBlock-module__DK06XW__saleBlockNotificationSubscription",saleBlockPartnerSubGracePeriod__description:"SaleBlock-module__DK06XW__saleBlockPartnerSubGracePeriod__description",paperPrice:"SaleBlock-module__DK06XW__paperPrice",referralBlock__icon:"SaleBlock-module__DK06XW__referralBlock__icon",saleBlockBonuses:"SaleBlock-module__DK06XW__saleBlockBonuses",referralBlock:"SaleBlock-module__DK06XW__referralBlock",block__download:"SaleBlock-module__DK06XW__block__download",saleBlockPartnerSubGracePeriod__title:"SaleBlock-module__DK06XW__saleBlockPartnerSubGracePeriod__title",partnerName:"SaleBlock-module__DK06XW__partnerName",saleBlockPartnerSubGracePeriod__button:"SaleBlock-module__DK06XW__saleBlockPartnerSubGracePeriod__button",bundleBlock__oldPrice:"SaleBlock-module__DK06XW__bundleBlock__oldPrice",bundleBlock__iconWrapper:"SaleBlock-module__DK06XW__bundleBlock__iconWrapper",block__price__full:"SaleBlock-module__DK06XW__block__price__full",referralBlock__btn:"SaleBlock-module__DK06XW__referralBlock__btn",exclusiveAbonement:"SaleBlock-module__DK06XW__exclusiveAbonement",block__price__discount:"SaleBlock-module__DK06XW__block__price__discount",fourArtsGift__banner:"SaleBlock-module__DK06XW__fourArtsGift__banner",saleBlockInfo__icon:"SaleBlock-module__DK06XW__saleBlockInfo__icon",giftModal:"SaleBlock-module__DK06XW__giftModal",detailedReceipt__discount:"SaleBlock-module__DK06XW__detailedReceipt__discount",block__price__final:"SaleBlock-module__DK06XW__block__price__final",block__info:"SaleBlock-module__DK06XW__block__info",block__addMaterialsDownload:"SaleBlock-module__DK06XW__block__addMaterialsDownload",block__megafonPPD:"SaleBlock-module__DK06XW__block__megafonPPD",saleBlockInfo_isLibrary:"SaleBlock-module__DK06XW__saleBlockInfo_isLibrary",profits_description:"SaleBlock-module__DK06XW__profits_description",block_gift:"SaleBlock-module__DK06XW__block_gift",detailedReceipt:"SaleBlock-module__DK06XW__detailedReceipt",giftModal__text:"SaleBlock-module__DK06XW__giftModal__text",bundleBlock__caption:"SaleBlock-module__DK06XW__bundleBlock__caption",block__libraryInfo:"SaleBlock-module__DK06XW__block__libraryInfo",block__caption:"SaleBlock-module__DK06XW__block__caption",saleBlockInfo__title:"SaleBlock-module__DK06XW__saleBlockInfo__title",block__infoTitle:"SaleBlock-module__DK06XW__block__infoTitle",saleBlockInfo__description:"SaleBlock-module__DK06XW__saleBlockInfo__description"}},76878:function(e){e.exports={profits_list:"BuyAbonementAction-module__CYnznW__profits_list",profitIcon_discount:"BuyAbonementAction-module__CYnznW__profitIcon_discount",abonementWidget:"BuyAbonementAction-module__CYnznW__abonementWidget",profitIcon_book:"BuyAbonementAction-module__CYnznW__profitIcon_book"}},81220:function(e){e.exports={profits_description:"SaleBlockPpd-module__KzrTIa__profits_description",ppdWidget:"SaleBlockPpd-module__KzrTIa__ppdWidget",actions_cartButton:"SaleBlockPpd-module__KzrTIa__actions_cartButton",shortInfoButtonContainer:"SaleBlockPpd-module__KzrTIa__shortInfoButtonContainer",shortInfoButton__discountLabel:"SaleBlockPpd-module__KzrTIa__shortInfoButton__discountLabel",fullPrice:"SaleBlockPpd-module__KzrTIa__fullPrice"}},11659:function(e){e.exports={profits_list:"BuySubscriptionAction-module__CkcYWW__profits_list",profitIcon_discount:"BuySubscriptionAction-module__CkcYWW__profitIcon_discount",nextPriceText:"BuySubscriptionAction-module__CkcYWW__nextPriceText",subscriptionWidget:"BuySubscriptionAction-module__CkcYWW__subscriptionWidget",profitIcon_book:"BuySubscriptionAction-module__CkcYWW__profitIcon_book"}},35474:function(e){e.exports={plans:"BuySubscriptionPlansAction-module__27NHaa__plans",root:"BuySubscriptionPlansAction-module__27NHaa__root",description:"BuySubscriptionPlansAction-module__27NHaa__description",link:"BuySubscriptionPlansAction-module__27NHaa__link"}},36123:function(e){e.exports={container:"Message-module___AfLka__container",message:"Message-module___AfLka__message",fadeIn:"Message-module___AfLka__fadeIn",fadeOut:"Message-module___AfLka__fadeOut"}},65567:function(e){e.exports={saleBlockButton:"SaleBlockSubscriptionTokenUsage-module__4-FkJG__saleBlockButton"}},15202:function(e){e.exports={button:"ListenFragmentButton-module__eXhBGW__button"}},78814:function(e){e.exports={modal__qr:"WebtoonDeepLinkToAppButton-module__yObj-G__modal__qr",modal__content:"WebtoonDeepLinkToAppButton-module__yObj-G__modal__content"}},3015:function(e){e.exports={last:"Badge-module__gkZt5G__last",middle:"Badge-module__gkZt5G__middle",small:"Badge-module__gkZt5G__small",secondary:"Badge-module__gkZt5G__secondary",badge:"Badge-module__gkZt5G__badge",first:"Badge-module__gkZt5G__first"}},95232:function(e){e.exports={buyAction:"SaleBlockDetailedInfoWidget-module__JN72IG__buyAction",title_discountLabel:"SaleBlockDetailedInfoWidget-module__JN72IG__title_discountLabel",widget:"SaleBlockDetailedInfoWidget-module__JN72IG__widget",actions:"SaleBlockDetailedInfoWidget-module__JN72IG__actions",notExpanded:"SaleBlockDetailedInfoWidget-module__JN72IG__notExpanded",discount:"SaleBlockDetailedInfoWidget-module__JN72IG__discount",secondary:"SaleBlockDetailedInfoWidget-module__JN72IG__secondary",action:"SaleBlockDetailedInfoWidget-module__JN72IG__action",title:"SaleBlockDetailedInfoWidget-module__JN72IG__title",title__chevronIcon:"SaleBlockDetailedInfoWidget-module__JN72IG__title__chevronIcon"}},48689:function(e){e.exports={star_large:"RatingPopup-module__ubXj0W__star_large",no_raiting:"RatingPopup-module__ubXj0W__no_raiting",filling:"RatingPopup-module__ubXj0W__filling",user_review_stars:"RatingPopup-module__ubXj0W__user_review_stars",stars_block:"RatingPopup-module__ubXj0W__stars_block",loader:"RatingPopup-module__ubXj0W__loader",inside_arrow:"RatingPopup-module__ubXj0W__inside_arrow",link:"RatingPopup-module__ubXj0W__link",no_rating:"RatingPopup-module__ubXj0W__no_rating",filled:"RatingPopup-module__ubXj0W__filled",star_wrapper:"RatingPopup-module__ubXj0W__star_wrapper",rating:"RatingPopup-module__ubXj0W__rating",inline:"RatingPopup-module__ubXj0W__inline",text_wrapper_flex:"RatingPopup-module__ubXj0W__text_wrapper_flex",user_review:"RatingPopup-module__ubXj0W__user_review",popup_from_source:"RatingPopup-module__ubXj0W__popup_from_source",count_text:"RatingPopup-module__ubXj0W__count_text",star_small:"RatingPopup-module__ubXj0W__star_small",user_review_text:"RatingPopup-module__ubXj0W__user_review_text",source_litres:"RatingPopup-module__ubXj0W__source_litres",stars_row:"RatingPopup-module__ubXj0W__stars_row",review_btn:"RatingPopup-module__ubXj0W__review_btn",hidden:"RatingPopup-module__ubXj0W__hidden",header:"RatingPopup-module__ubXj0W__header",count_value:"RatingPopup-module__ubXj0W__count_value",source_livelib:"RatingPopup-module__ubXj0W__source_livelib",init:"RatingPopup-module__ubXj0W__init",user_review_center:"RatingPopup-module__ubXj0W__user_review_center",total:"RatingPopup-module__ubXj0W__total",votes_count:"RatingPopup-module__ubXj0W__votes_count",popup_wrapper:"RatingPopup-module__ubXj0W__popup_wrapper",source_icon:"RatingPopup-module__ubXj0W__source_icon",non_chosen_rating:"RatingPopup-module__ubXj0W__non_chosen_rating",rating_number:"RatingPopup-module__ubXj0W__rating_number",inside:"RatingPopup-module__ubXj0W__inside",svg_g:"RatingPopup-module__ubXj0W__svg_g",text_wrapper:"RatingPopup-module__ubXj0W__text_wrapper",is_rated:"RatingPopup-module__ubXj0W__is_rated",count:"RatingPopup-module__ubXj0W__count"}},99442:function(e){e.exports={chevronIcon:"Accordion-module__vZhvEG__chevronIcon",accordion__item__Title:"Accordion-module__vZhvEG__accordion__item__Title",accordion__item__Header:"Accordion-module__vZhvEG__accordion__item__Header",accordion__item__Header_reverseOrder:"Accordion-module__vZhvEG__accordion__item__Header_reverseOrder",accordion__item__Content:"Accordion-module__vZhvEG__accordion__item__Content",accordion__item:"Accordion-module__vZhvEG__accordion__item",notCollapsible:"Accordion-module__vZhvEG__notCollapsible",accordion:"Accordion-module__vZhvEG__accordion"}},91249:function(e,t,r){"use strict";e.exports=r.p+"static/media/checkFilled12.6465f805.svg"}}]);
//# sourceMappingURL=4239-cf66cc1665a040b8.js.map